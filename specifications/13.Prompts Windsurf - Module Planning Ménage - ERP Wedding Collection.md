# Prompts Windsurf - Module Planning M√©nage - ERP Wedding Collection

## Vue d'Ensemble du Module

Le module Planning M√©nage repr√©sente le pilier op√©rationnel de la gestion des √©quipes de nettoyage et d'entretien dans l'ERP Wedding Collection, orchestrant l'ensemble du cycle de vie des t√¢ches de maintenance depuis leur planification automatique jusqu'√† leur validation qualit√©. Ce module sophistiqu√© illustre l'application avanc√©e de notre m√©thodologie de g√©n√©ration de prompts Windsurf, transformant un cahier des charges technique exhaustif en instructions ex√©cutables optimis√©es pour l'agent de d√©veloppement.

La complexit√© de ce module r√©side dans sa capacit√© √† g√©rer simultan√©ment les aspects op√©rationnels (planification des √©quipes, assignation des t√¢ches, suivi temps r√©el), logistiques (gestion des fournitures, √©quipements, espaces), qualit√© (checklists, validation, contr√¥le), et analytiques (reporting, optimisation, pr√©diction). Cette multidimensionnalit√© n√©cessite une approche architecturale rigoureuse qui garantit l'efficacit√© op√©rationnelle, la tra√ßabilit√© compl√®te, et l'int√©gration harmonieuse avec l'√©cosyst√®me existant de l'ERP.

L'architecture du module s'appuie sur un sch√©ma `cleaning` d√©di√© pour isoler les donn√©es op√©rationnelles de nettoyage, utilisant une approche de s√©paration des responsabilit√©s avec des services sp√©cialis√©s pour chaque domaine fonctionnel. Cette strat√©gie garantit la performance des op√©rations de terrain, facilite la maintenance des √©quipements, et pr√©pare l'√©volution vers des fonctionnalit√©s avanc√©es comme l'optimisation IA et l'IoT.

La transformation de ce cahier des charges en prompts Windsurf suit notre m√©thodologie √©prouv√©e, structurant le d√©veloppement en quatre phases logiques qui optimisent l'efficacit√© de l'agent tout en maintenant la qualit√© et la robustesse du code g√©n√©r√©. Chaque prompt int√®gre les sp√©cificit√©s op√©rationnelles identifi√©es dans l'analyse documentaire, les bonnes pratiques Windsurf, et les contraintes d'int√©gration inter-modules critiques pour un module de gestion op√©rationnelle.

L'int√©gration avec les modules Lieux et √âv√©nements constitue un √©l√©ment central de l'architecture, n√©cessitant une synchronisation sophistiqu√©e des plannings, une coordination temps r√©el des ressources, et une robustesse face aux changements de derni√®re minute. Cette int√©gration illustre parfaitement l'approche Windsurf d'orchestration de donn√©es complexes avec une logique m√©tier op√©rationnelle coh√©rente.

---

## Section 1 : Initialisation

### Prompt 1.1 : Cr√©ation du Sch√©ma Op√©rationnel de Nettoyage Complet

üéØ **But** : Cr√©er le sch√©ma complet de base de donn√©es pour le module Planning M√©nage avec toutes les tables, relations, contraintes op√©rationnelles, politiques RLS optimis√©es, triggers de planification automatique, et int√©gration avec les modules existants

üß† **Contexte** : Module op√©rationnel critique du sch√©ma `cleaning` avec isolation compl√®te des donn√©es de nettoyage dans l'ERP Wedding Collection. Respecter imp√©rativement les conventions d√©finies dans `Conventions_Supabase_WeddingCollection_AgentIA.md` avec performance optimis√©e, gestion temps r√©el, et int√©gration avec modules Lieux, √âv√©nements, Calendrier, et Comptabilit√©.

üõ†Ô∏è **Fichiers** :
- `supabase/migrations/20241203_040_create_cleaning_schema.sql`
- `supabase/migrations/20241203_041_create_cleaning_tasks_schema.sql`
- `supabase/migrations/20241203_042_create_cleaning_teams_schema.sql`
- `supabase/migrations/20241203_043_create_cleaning_templates_schema.sql`
- `supabase/migrations/20241203_044_create_cleaning_checklists_schema.sql`
- `supabase/migrations/20241203_045_create_cleaning_policies.sql`
- `supabase/migrations/20241203_046_create_cleaning_triggers.sql`
- `supabase/migrations/20241203_047_create_cleaning_views.sql`

üîÑ **Comportement** :
Cr√©er le sch√©ma `cleaning` avec isolation compl√®te des donn√©es op√©rationnelles de nettoyage.

Cr√©er la table centrale `cleaning.cleaning_tasks` avec les champs : task_title (VARCHAR NOT NULL), task_description (TEXT), task_type (VARCHAR avec ENUM task_type), priority (VARCHAR avec ENUM task_priority), status (VARCHAR avec ENUM task_status), venue_id (UUID FK vers shared.venues), space_id (UUID FK vers shared.spaces), event_id (UUID FK nullable vers shared.events), template_id (UUID FK nullable vers cleaning.cleaning_templates), assigned_team_id (UUID FK nullable vers cleaning.cleaning_teams), assigned_user_id (UUID FK nullable vers shared.user_profiles), scheduled_start (TIMESTAMPTZ NOT NULL), scheduled_end (TIMESTAMPTZ NOT NULL), actual_start (TIMESTAMPTZ), actual_end (TIMESTAMPTZ), estimated_duration (INTERVAL), actual_duration (INTERVAL), is_recurring (BOOLEAN DEFAULT false), recurrence_pattern (JSONB), parent_task_id (UUID FK nullable vers cleaning.cleaning_tasks), organization_id (UUID FK vers shared.organizations), created_by (UUID FK vers shared.user_profiles), plus les champs standard (id, created_at, updated_at).

Cr√©er les ENUMs : `task_type` (pre_event_cleaning, post_event_cleaning, maintenance, deep_cleaning, inspection, emergency), `task_priority` (low, medium, high, urgent, critical), `task_status` (planned, assigned, in_progress, paused, completed, validated, cancelled, failed), `team_status` (available, busy, unavailable, on_break), `checklist_item_status` (pending, completed, skipped, failed).

Cr√©er la table `cleaning.cleaning_teams` avec : team_name (VARCHAR NOT NULL), team_description (TEXT), team_leader_id (UUID FK vers shared.user_profiles), team_members (JSONB NOT NULL), specializations (JSONB), max_concurrent_tasks (INTEGER DEFAULT 1), current_status (VARCHAR avec ENUM team_status), current_location (VARCHAR), equipment_assigned (JSONB), contact_phone (VARCHAR), contact_email (VARCHAR), working_hours (JSONB), organization_id (UUID FK), plus champs standard.

Cr√©er la table `cleaning.cleaning_templates` avec : template_name (VARCHAR NOT NULL), template_description (TEXT), template_type (VARCHAR avec ENUM task_type), venue_types (JSONB), space_types (JSONB), estimated_duration (INTERVAL NOT NULL), required_team_size (INTEGER DEFAULT 1), required_specializations (JSONB), required_equipment (JSONB), required_supplies (JSONB), checklist_items (JSONB NOT NULL), instructions (TEXT), is_active (BOOLEAN DEFAULT true), organization_id (UUID FK), created_by (UUID FK), plus champs standard.

Cr√©er la table `cleaning.checklist_items` avec : task_id (UUID FK vers cleaning.cleaning_tasks), item_order (INTEGER NOT NULL), item_title (VARCHAR NOT NULL), item_description (TEXT), is_mandatory (BOOLEAN DEFAULT true), status (VARCHAR avec ENUM checklist_item_status), completed_by (UUID FK nullable vers shared.user_profiles), completed_at (TIMESTAMPTZ), notes (TEXT), photo_before_url (VARCHAR), photo_after_url (VARCHAR), validation_required (BOOLEAN DEFAULT false), validated_by (UUID FK nullable vers shared.user_profiles), validated_at (TIMESTAMPTZ), plus champs standard.

Cr√©er la table `cleaning.task_issues` avec : task_id (UUID FK vers cleaning.cleaning_tasks), issue_type (VARCHAR avec ENUM issue_type), issue_title (VARCHAR NOT NULL), issue_description (TEXT NOT NULL), severity (VARCHAR avec ENUM issue_severity), status (VARCHAR avec ENUM issue_status), reported_by (UUID FK vers shared.user_profiles), reported_at (TIMESTAMPTZ NOT NULL), assigned_to (UUID FK nullable vers shared.user_profiles), resolved_by (UUID FK nullable vers shared.user_profiles), resolved_at (TIMESTAMPTZ), resolution_notes (TEXT), photo_urls (JSONB), estimated_cost (DECIMAL(10,2)), actual_cost (DECIMAL(10,2)), plus champs standard.

Cr√©er les ENUMs additionnels : `issue_type` (equipment_failure, supply_shortage, access_problem, quality_issue, safety_concern, damage_found, other), `issue_severity` (low, medium, high, critical), `issue_status` (open, in_progress, resolved, closed, escalated).

Cr√©er la table `cleaning.cleaning_supplies` avec : supply_name (VARCHAR NOT NULL), supply_category (VARCHAR), current_stock (INTEGER DEFAULT 0), minimum_stock (INTEGER DEFAULT 0), unit_cost (DECIMAL(10,2)), supplier_info (JSONB), storage_location (VARCHAR), expiry_date (DATE), safety_notes (TEXT), organization_id (UUID FK), plus champs standard.

Cr√©er la table `cleaning.task_supplies_usage` avec : task_id (UUID FK vers cleaning.cleaning_tasks), supply_id (UUID FK vers cleaning.cleaning_supplies), quantity_used (INTEGER NOT NULL), cost_per_unit (DECIMAL(10,2)), total_cost (DECIMAL(10,2)), used_by (UUID FK vers shared.user_profiles), used_at (TIMESTAMPTZ), plus champs standard.

Cr√©er la table `cleaning.cleaning_equipment` avec : equipment_name (VARCHAR NOT NULL), equipment_type (VARCHAR), equipment_model (VARCHAR), serial_number (VARCHAR), purchase_date (DATE), warranty_expiry (DATE), maintenance_schedule (JSONB), current_status (VARCHAR avec ENUM equipment_status), assigned_to_team (UUID FK nullable vers cleaning.cleaning_teams), location (VARCHAR), maintenance_cost (DECIMAL(10,2)), organization_id (UUID FK), plus champs standard.

Cr√©er l'ENUM `equipment_status` (available, in_use, maintenance, broken, retired).

Activer RLS sur toutes les tables avec politiques optimis√©es pour : r√¥les admin_cleaning (acc√®s complet), operations_manager (lecture/√©criture t√¢ches et √©quipes), team_leader (lecture/√©criture t√¢ches assign√©es), cleaner (lecture/√©criture t√¢ches personnelles), venue_manager (lecture t√¢ches de ses lieux).

Cr√©er les index optimis√©s : `idx_cleaning_tasks_venue_space`, `idx_cleaning_tasks_event`, `idx_cleaning_tasks_team`, `idx_cleaning_tasks_status_date`, `idx_cleaning_tasks_scheduled_times`, `idx_checklist_items_task_order`, `idx_task_issues_task_severity`, `idx_cleaning_teams_status`, `idx_cleaning_supplies_stock_levels`.

Cr√©er les triggers critiques pour : g√©n√©ration automatique des t√¢ches r√©currentes selon les patterns d√©finis, planification automatique des t√¢ches bas√©e sur les √©v√©nements, mise √† jour automatique des statuts d'√©quipes selon les assignations, calcul automatique des dur√©es et co√ªts, notifications automatiques pour les alertes de stock et maintenance.

Cr√©er les vues mat√©rialis√©es pour optimisation : `vw_cleaning_tasks_extended` (t√¢ches avec d√©tails √©quipe, lieu, √©v√©nement), `vw_team_workload` (charge de travail par √©quipe), `vw_cleaning_statistics` (m√©triques par organisation), `vw_supply_alerts` (alertes de stock et maintenance).

‚öôÔ∏è **Interactions** :
- **Consomme** : Tables shared.venues, shared.spaces, shared.events, shared.organizations, shared.user_profiles
- **Expose** : Structure de nettoyage pour modules Calendrier, Comptabilit√©, Suivi des Mariages
- **Partage** : Types `CleaningTask`, `CleaningTeam`, `CleaningTemplate` avec packages/types
- **Optimise** : Performance avec index sp√©cialis√©s et vues mat√©rialis√©es

üí° **Tips Windsurf** :
- Utiliser Cascade Write Mode pour g√©n√©ration automatique des migrations complexes
- Activer MCP Supabase pour cr√©ation directe et validation des contraintes op√©rationnelles
- R√©f√©rencer m√©moire "Conventions Supabase Wedding Collection"
- Utiliser Claude 3.5 pour logique complexe des triggers de planification automatique
- Optimiser les requ√™tes avec index composites pour les filtres fr√©quents

### Prompt 1.2 : G√©n√©ration des Types TypeScript Op√©rationnels Complets

üéØ **But** : G√©n√©rer les types TypeScript complets et optimis√©s pour le module Planning M√©nage avec interfaces op√©rationnelles, enums de statuts, types utilitaires de planification, sch√©mas de validation Zod pour assurer la type-safety et la performance

üß† **Contexte** : Types op√©rationnels partag√©s dans `packages/types` utilis√©s par toutes les applications du monorepo avec validation stricte des contraintes op√©rationnelles. Synchronisation automatique avec le sch√©ma Supabase cleaning et extension des types existants Lieux et √âv√©nements.

üõ†Ô∏è **Fichiers** :
- `packages/types/src/cleaning.ts`
- `packages/types/src/cleaning-tasks.ts`
- `packages/types/src/cleaning-teams.ts`
- `packages/types/src/cleaning-templates.ts`
- `packages/types/src/cleaning-checklists.ts`
- `packages/types/src/cleaning-supplies.ts`
- `packages/types/src/cleaning-validations.ts`
- `packages/types/src/database.ts` (mise √† jour)
- `packages/types/src/index.ts` (export)

üîÑ **Comportement** :
G√©n√©rer l'interface `CleaningTask` correspondant exactement √† la table `cleaning.cleaning_tasks` avec tous les champs typ√©s selon les contraintes op√©rationnelles. Inclure les relations : `venue?: Venue`, `space?: Space`, `event?: Event`, `template?: CleaningTemplate`, `assignedTeam?: CleaningTeam`, `assignedUser?: UserProfile`, `checklistItems?: ChecklistItem[]`, `issues?: TaskIssue[]`, `suppliesUsage?: TaskSupplyUsage[]`.

Cr√©er les enums TypeScript correspondant aux enums SQL avec validation stricte : `TaskType`, `TaskPriority`, `TaskStatus`, `TeamStatus`, `ChecklistItemStatus`, `IssueType`, `IssueSeverity`, `IssueStatus`, `EquipmentStatus`.

G√©n√©rer les interfaces pour toutes les entit√©s op√©rationnelles : `CleaningTeam`, `CleaningTemplate`, `ChecklistItem`, `TaskIssue`, `CleaningSupply`, `TaskSupplyUsage`, `CleaningEquipment`.

Cr√©er les types utilitaires op√©rationnels : `CleaningTaskCreate` (Omit<CleaningTask, 'id' | 'created_at' | 'updated_at'>), `CleaningTaskUpdate` (Partial<CleaningTaskCreate>), `CleaningTaskWithDetails` (avec toutes les relations charg√©es), `CleaningTaskListItem` (version all√©g√©e pour les listes), `CleaningTaskSummary` (m√©triques et statuts).

Cr√©er les types de planification : `TaskSchedule` (donn√©es de planification), `RecurrencePattern` (pattern de r√©currence), `TeamAssignment` (assignation d'√©quipe), `WorkloadDistribution` (r√©partition de charge), `ScheduleConflict` (conflit de planning).

G√©n√©rer les types de templates et checklists : `CleaningTemplateData` (structure du template), `ChecklistItemTemplate` (item de checklist template), `TaskInstructions` (instructions de t√¢che), `QualityValidation` (validation qualit√©), `TemplateApplication` (application de template).

Cr√©er les types de recherche et filtrage : `CleaningTaskFilters` (status?, team_id?, venue_id?, date_range?, priority?, type?), `TeamFilters`, `SupplyFilters`, `CleaningTaskSearchResult`, `CleaningTaskListOptions`.

Cr√©er les types pour les formulaires : `CleaningTaskFormData`, `CleaningTeamFormData`, `CleaningTemplateFormData`, `ChecklistItemFormData`, `TaskIssueFormData`.

Cr√©er les sch√©mas de validation Zod avec contraintes op√©rationnelles : `CleaningTaskSchema` (validation horaires, dur√©es, assignations), `CleaningTeamSchema` (validation membres, sp√©cialisations), `CleaningTemplateSchema` (validation checklist, √©quipements), `ChecklistItemSchema` (validation ordre, statuts).

Ajouter les types pour les APIs : `CleaningTaskApiResponse`, `CleaningTaskListResponse`, `CleaningStatsResponse`, `TaskPlanningRequest`, `TeamAssignmentResponse`, `SupplyUsageRequest`.

Cr√©er les types de performance et analytics : `CleaningMetrics` (m√©triques de performance), `TeamProductivity` (productivit√© d'√©quipe), `TaskEfficiency` (efficacit√© des t√¢ches), `CostAnalysis` (analyse des co√ªts), `QualityMetrics` (m√©triques qualit√©).

Cr√©er les types temps r√©el : `TaskStatusUpdate` (mise √† jour de statut), `TeamLocationUpdate` (mise √† jour de localisation), `ChecklistProgress` (progression checklist), `RealTimeNotification` (notification temps r√©el).

‚öôÔ∏è **Interactions** :
- **Consomme** : Types Venue, Space, Event, UserProfile du sch√©ma Supabase
- **Expose** : Types op√©rationnels vers toutes les applications du monorepo
- **Partage** : Types communs avec modules Calendrier, Comptabilit√©, Suivi des Mariages
- **Valide** : Contraintes op√©rationnelles avec TypeScript strict

üí° **Tips Windsurf** :
- Utiliser Supercomplete pour coh√©rence avec patterns TypeScript op√©rationnels
- Activer g√©n√©ration automatique depuis sch√©ma Supabase cleaning
- Valider types avec compilation TypeScript stricte et contraintes op√©rationnelles
- Synchroniser avec m√©moire "Types Wedding Collection"
- Utiliser Claude 3.5 pour logique complexe des types de planification

### Prompt 1.3 : Architecture des Services Op√©rationnels et Edge Functions

üéØ **But** : Cr√©er l'architecture compl√®te des services op√©rationnels pour le module Planning M√©nage avec Edge Functions Supabase, services de planification automatique, optimisation des ressources, gestion temps r√©el, et couches service/repository avec validation op√©rationnelle

üß† **Contexte** : Services op√©rationnels dans `apps/backoffice/src/lib/services` utilisant Supabase client, Edge Functions pour planification automatique et optimisation, validation Zod renforc√©e, et gestion d'erreurs sp√©cialis√©e pour op√©rations de terrain.

üõ†Ô∏è **Fichiers** :
- `supabase/functions/auto-schedule-cleaning-tasks/index.ts`
- `supabase/functions/optimize-team-assignments/index.ts`
- `supabase/functions/generate-recurring-tasks/index.ts`
- `supabase/functions/calculate-cleaning-costs/index.ts`
- `supabase/functions/supply-stock-alerts/index.ts`
- `apps/backoffice/src/lib/services/cleaning-tasks-service.ts`
- `apps/backoffice/src/lib/services/cleaning-teams-service.ts`
- `apps/backoffice/src/lib/services/cleaning-templates-service.ts`
- `apps/backoffice/src/lib/services/cleaning-planning-service.ts`
- `apps/backoffice/src/lib/repositories/cleaning-repository.ts`
- `apps/backoffice/src/lib/validators/cleaning-validators.ts`
- `apps/backoffice/src/lib/errors/cleaning-errors.ts`

üîÑ **Comportement** :
Cr√©er les Edge Functions Supabase critiques : `auto-schedule-cleaning-tasks` pour planification automatique bas√©e sur les √©v√©nements avec optimisation des ressources, `optimize-team-assignments` pour assignation intelligente des √©quipes selon disponibilit√©s et comp√©tences, `generate-recurring-tasks` pour g√©n√©ration automatique des t√¢ches r√©currentes selon patterns, `calculate-cleaning-costs` pour calcul automatique des co√ªts selon ressources utilis√©es, `supply-stock-alerts` pour alertes automatiques de stock et maintenance.

Cr√©er `CleaningRepository` avec m√©thodes optimis√©es : `findTasks(filters?, pagination?)`, `findTaskById(id)`, `findTasksByVenue(venueId)`, `findTasksByTeam(teamId)`, `findTasksByDateRange(start, end)`, `createTask(data)`, `updateTask(id, data)`, `deleteTask(id)`, `assignTaskToTeam(taskId, teamId)`, `updateTaskStatus(taskId, status)`. Impl√©menter la logique de requ√™tes Supabase avec gestion des relations complexes et filtres op√©rationnels.

Cr√©er `CleaningTasksService` avec logique m√©tier : `createTaskFromTemplate(templateId, venueId, eventId?, customData)`, `scheduleAutomaticTasks(eventId)`, `assignTaskToTeam(taskId, teamId)`, `updateTaskProgress(taskId, progress)`, `validateTaskCompletion(taskId)`, `generateTaskReport(taskId)`, `calculateTaskCost(taskId)`. Int√©grer validation business et gestion des workflows op√©rationnels.

Cr√©er `CleaningTeamsService` avec : `createTeam(teamData)`, `updateTeam(teamId, data)`, `assignMemberToTeam(teamId, userId)`, `removeMemberFromTeam(teamId, userId)`, `getTeamAvailability(teamId, dateRange)`, `optimizeTeamAssignments(tasks)`, `updateTeamLocation(teamId, location)`, `getTeamWorkload(teamId)`. G√©rer les disponibilit√©s et optimisation des assignations.

Cr√©er `CleaningTemplatesService` avec : `createTemplate(templateData)`, `updateTemplate(templateId, data)`, `duplicateTemplate(templateId)`, `applyTemplateToTask(templateId, taskData)`, `validateTemplate(template)`, `getTemplatesByType(type)`, `activateTemplate(templateId)`, `deactivateTemplate(templateId)`. G√©rer les mod√®les et leur application.

Cr√©er `CleaningPlanningService` avec : `generateWeeklySchedule(venueId, week)`, `optimizeSchedule(tasks, teams)`, `detectScheduleConflicts(schedule)`, `resolveConflicts(conflicts)`, `generateRecurringTasks(pattern)`, `updateScheduleForEvent(eventId, changes)`, `calculateOptimalTeamSize(taskType, venue)`. G√©rer la planification intelligente et l'optimisation.

Cr√©er les validateurs Zod avec contraintes op√©rationnelles : `createTaskSchema` (validation horaires, dur√©es, assignations), `updateTaskSchema`, `teamAssignmentSchema` (validation disponibilit√©s, comp√©tences), `templateApplicationSchema` (validation application template), `scheduleOptimizationSchema` (validation optimisation planning).

Impl√©menter la gestion d'erreurs sp√©cialis√©e : `TaskNotFoundError`, `TeamUnavailableError`, `ScheduleConflictError`, `TemplateValidationError`, `ResourceOptimizationError`, `SupplyShortageError` avec codes d'erreur standardis√©s et messages op√©rationnels.

Cr√©er les services de performance : `CleaningMetricsService` pour calcul des m√©triques de performance, `QualityControlService` pour validation qualit√©, `CostAnalysisService` pour analyse des co√ªts, `SupplyManagementService` pour gestion des fournitures.

‚öôÔ∏è **Interactions** :
- **Consomme** : Types packages/types, client Supabase, donn√©es Lieux et √âv√©nements
- **Expose** : Services op√©rationnels vers controllers API et composants frontend
- **√âmet** : √âv√©nements task_created, task_completed, team_assigned, schedule_optimized
- **Int√®gre** : Modules Lieux, √âv√©nements, Calendrier, calculs de co√ªts

üí° **Tips Windsurf** :
- Utiliser Cascade Chat Mode pour logique op√©rationnelle complexe des Edge Functions
- R√©f√©rencer patterns de services op√©rationnels existants
- Int√©grer validation Zod avec contraintes op√©rationnelles strictes
- Utiliser MCP Supabase pour d√©ploiement direct des Edge Functions
- Tester logique de planification avec sc√©narios r√©alistes

### Prompt 1.4 : Configuration des Hooks et Contextes Op√©rationnels

üéØ **But** : D√©velopper l'architecture compl√®te des hooks personnalis√©s et contextes React pour le module Planning M√©nage avec gestion d'√©tat op√©rationnel optimis√©e, cache intelligent, synchronisation temps r√©el, et support hors ligne pour √©quipes terrain

üß† **Contexte** : Hooks et contextes op√©rationnels dans `apps/backoffice/src/hooks` et `apps/backoffice/src/contexts` utilisant React Query pour le cache, Supabase Realtime pour synchronisation, et patterns de gestion d'√©tat optimis√©s pour les donn√©es op√©rationnelles temps r√©el.

üõ†Ô∏è **Fichiers** :
- `apps/backoffice/src/contexts/CleaningContext.tsx`
- `apps/backoffice/src/hooks/useCleaningTasks.ts`
- `apps/backoffice/src/hooks/useCleaningTeams.ts`
- `apps/backoffice/src/hooks/useCleaningTemplates.ts`
- `apps/backoffice/src/hooks/useTaskPlanning.ts`
- `apps/backoffice/src/hooks/useTeamAssignment.ts`
- `apps/backoffice/src/hooks/useCleaningMetrics.ts`
- `apps/backoffice/src/hooks/useOfflineSync.ts`
- `apps/backoffice/src/hooks/useRealTimeUpdates.ts`

üîÑ **Comportement** :
Cr√©er `CleaningContext` avec √©tat global op√©rationnel : t√¢ches actives, √©quipes disponibles, filtres appliqu√©s, pr√©f√©rences utilisateur, cache des templates fr√©quents, param√®tres de synchronisation. Fournir actions : selectTask, updateFilters, refreshTaskData, syncOfflineData, optimizeSchedule.

D√©velopper `useCleaningTasks` avec : `data` (liste des t√¢ches), `isLoading`, `error`, `refetch`, `hasNextPage`, `fetchNextPage` pour pagination infinie. Int√©grer filtrage avanc√© (statut, √©quipe, lieu, date, priorit√©), tri multiple, recherche textuelle. Impl√©menter cache intelligent avec invalidation bas√©e sur les √©v√©nements op√©rationnels.

Cr√©er `useCleaningTeams(organizationId)` avec : `teams` (√©quipes disponibles), `createTeam`, `updateTeam`, `assignMember`, `removeMember`, `getAvailability`, `updateLocation`. G√©rer les mises √† jour temps r√©el des statuts d'√©quipes et optimistic updates s√©curis√©es.

Impl√©menter `useCleaningTemplates(type?)` avec : `templates`, `createTemplate`, `updateTemplate`, `duplicateTemplate`, `applyTemplate`, `validateTemplate`. Optimiser les mises √† jour avec validation temps r√©el et cache des templates fr√©quents.

D√©velopper `useTaskPlanning(venueId?, dateRange?)` avec : `schedule`, `generateSchedule`, `optimizeAssignments`, `detectConflicts`, `resolveConflicts`, `updateSchedule`. Int√©grer planification automatique et gestion des conflits temps r√©el.

Cr√©er `useTeamAssignment(taskId?)` avec : `availableTeams`, `assignTeam`, `unassignTeam`, `checkAvailability`, `optimizeAssignment`, `getWorkload`. G√©rer assignations intelligentes et validation des disponibilit√©s.

Impl√©menter `useCleaningMetrics(period?, filters?)` avec : `metrics`, `productivity`, `costs`, `quality`, `trends`, `generateReport`. Optimiser les calculs avec memoization et cache des m√©triques.

D√©velopper `useOfflineSync` avec : `isOnline`, `pendingChanges`, `syncData`, `queueChange`, `resolveSyncConflicts`, `getOfflineCapabilities`. G√©rer le mode hors ligne pour √©quipes terrain avec synchronisation intelligente.

Cr√©er `useRealTimeUpdates(taskIds?)` avec : `subscribe`, `unsubscribe`, `handleUpdate`, `broadcastUpdate`, `getConnectionStatus`. Int√©grer Supabase Realtime pour mises √† jour instantan√©es.

Impl√©menter patterns d'optimisation op√©rationnelle : memoization des calculs de planning, lazy loading des donn√©es non critiques, prefetching des t√¢ches du jour, cleanup automatique des donn√©es obsol√®tes, validation de coh√©rence continue.

‚öôÔ∏è **Interactions** :
- **Consomme** : Services op√©rationnels, types TypeScript, client Supabase temps r√©el
- **Expose** : Hooks op√©rationnels vers composants React, √©tat global via contexte
- **Int√®gre** : React Query pour cache, Supabase Realtime, mode hors ligne
- **Optimise** : Performance avec memoization et gestion m√©moire intelligente

üí° **Tips Windsurf** :
- Utiliser Supercomplete pour patterns React hooks op√©rationnels
- Activer m√©moire "React Patterns Wedding Collection"
- R√©f√©rencer hooks existants avec /Reference Open Editors
- Optimiser performance avec React DevTools Profiler pour donn√©es temps r√©el
- Tester hooks avec React Testing Library et sc√©narios hors ligne

---

## Section 2 : Fonctionnalit√©s Principales



### Prompt 2.1 : Interface de Gestion des T√¢ches de Nettoyage

üéØ **But** : D√©velopper l'interface compl√®te de gestion des t√¢ches de nettoyage avec planification visuelle, assignation d'√©quipes, suivi temps r√©el, et validation qualit√© utilisant ShadCN UI

üß† **Contexte** : Interface principale dans `apps/backoffice/app/cleaning/tasks` utilisant Next.js 14 App Router, ShadCN UI, Tailwind CSS, React Hook Form avec validation Zod, et composants temps r√©el pour gestion op√©rationnelle. Point d'entr√©e pour la cr√©ation et gestion des t√¢ches de nettoyage.

üõ†Ô∏è **Fichiers** :
- `apps/backoffice/app/cleaning/tasks/page.tsx` (liste t√¢ches)
- `apps/backoffice/app/cleaning/tasks/nouveau/page.tsx` (cr√©ation)
- `apps/backoffice/app/cleaning/tasks/[id]/page.tsx` (d√©tail)
- `apps/backoffice/app/cleaning/tasks/[id]/checklist/page.tsx` (checklist)
- `components/cleaning/TasksTable.tsx`
- `components/cleaning/TaskEditor.tsx`
- `components/cleaning/TaskScheduler.tsx`
- `components/cleaning/TeamAssignment.tsx`
- `components/cleaning/TaskProgress.tsx`
- `components/cleaning/QualityControl.tsx`
- `components/cleaning/TaskFilters.tsx`

üîÑ **Comportement** :
Cr√©er la liste des t√¢ches avec DataTable ShadCN affichant : titre de la t√¢che (lien vers d√©tail), type (badge color√©), priorit√© (indicateur visuel), statut (badge avec progression), lieu/espace, √©quipe assign√©e, horaires planifi√©s vs r√©els, progression checklist, actions (√©diter, assigner, valider). Int√©grer tri multi-colonnes, filtres par statut/type/√©quipe/lieu, recherche en temps r√©el, pagination c√¥t√© serveur.

D√©velopper l'√©diteur de t√¢ches avec : informations g√©n√©rales (titre, description, type, priorit√©), s√©lection lieu/espace avec autocomplete, s√©lection √©v√©nement optionnel, planification horaire avec calendrier visuel, assignation d'√©quipe avec v√©rification disponibilit√©, s√©lection template avec application automatique, configuration r√©currence pour t√¢ches r√©p√©titives.

Impl√©menter le planificateur de t√¢ches avec : vue calendrier hebdomadaire/mensuelle, drag & drop pour reprogrammation, d√©tection automatique des conflits, suggestions d'optimisation, visualisation charge de travail par √©quipe, int√©gration avec √©v√©nements du calendrier global.

Cr√©er l'assignation d'√©quipes avec : liste des √©quipes disponibles avec statuts temps r√©el, v√©rification des comp√©tences requises, calcul de la charge de travail, estimation de dur√©e bas√©e sur historique, notification automatique des √©quipes assign√©es, gestion des remplacements d'urgence.

D√©velopper le suivi de progression avec : timeline des √©tapes de la t√¢che, mise √† jour temps r√©el des statuts, progression de la checklist avec pourcentages, photos avant/pendant/apr√®s, notes et commentaires, alertes pour retards ou probl√®mes.

Impl√©menter le contr√¥le qualit√© avec : validation par √©tapes de la checklist, capture de photos obligatoires, notation qualit√©, signalement de probl√®mes avec photos, validation finale par superviseur, g√©n√©ration automatique de rapports qualit√©.

Cr√©er les filtres avanc√©s avec : filtres par statut avec compteurs, filtres par type et priorit√©, filtres par √©quipe et lieu, filtres temporels (aujourd'hui, cette semaine, ce mois), filtres par progression, sauvegarde des filtres favoris.

G√©rer les notifications temps r√©el avec : alertes pour nouvelles assignations, notifications de changement de statut, alertes de retard ou probl√®me, notifications de validation requise, mise √† jour automatique des vues.

‚öôÔ∏è **Interactions** :
- **Consomme** : API /api/cleaning/tasks, hooks useCleaningTasks, composants shared-ui
- **Expose** : Interface de gestion des t√¢ches pour √©quipes op√©rationnelles
- **Int√®gre** : Modules Lieux et √âv√©nements, calendrier global, notifications
- **Synchronise** : Donn√©es temps r√©el avec Supabase Realtime

üí° **Tips Windsurf** :
- Utiliser Supercomplete pour patterns ShadCN UI DataTable op√©rationnels
- Activer m√©moire "Design System Wedding Collection"
- R√©f√©rencer composants op√©rationnels existants avec /Reference Open Editors
- Optimiser performance avec virtualisation pour grandes listes de t√¢ches
- Tester synchronisation temps r√©el avec multiples utilisateurs

### Prompt 2.2 : Syst√®me de Planification Automatique et Optimisation

üéØ **But** : Cr√©er le syst√®me complet de planification automatique avec g√©n√©ration intelligente des t√¢ches, optimisation des ressources, d√©tection de conflits, et algorithmes d'assignation optimale

üß† **Contexte** : Syst√®me de planification dans l'onglet Planning du module, permettant la g√©n√©ration automatique de t√¢ches bas√©e sur les √©v√©nements, l'optimisation des assignations d'√©quipes, et la r√©solution intelligente des conflits de planning.

üõ†Ô∏è **Fichiers** :
- `components/cleaning/planning/PlanningDashboard.tsx`
- `components/cleaning/planning/AutoScheduler.tsx`
- `components/cleaning/planning/ResourceOptimizer.tsx`
- `components/cleaning/planning/ConflictResolver.tsx`
- `components/cleaning/planning/ScheduleCalendar.tsx`
- `components/cleaning/planning/WorkloadAnalyzer.tsx`
- `components/cleaning/planning/PlanningMetrics.tsx`
- `hooks/useTaskPlanning.ts`
- `hooks/useResourceOptimization.ts`

üîÑ **Comportement** :
Cr√©er le dashboard de planification avec : vue d'ensemble des t√¢ches planifi√©es, charge de travail par √©quipe avec graphiques, conflits d√©tect√©s avec priorit√©s, m√©triques de performance du planning, suggestions d'optimisation automatiques, acc√®s rapide aux outils de planification.

D√©velopper le planificateur automatique avec : g√©n√©ration de t√¢ches bas√©e sur les √©v√©nements confirm√©s, application automatique des templates selon types de lieux, calcul des dur√©es bas√© sur l'historique, assignation intelligente selon disponibilit√©s et comp√©tences, g√©n√©ration de t√¢ches r√©currentes selon patterns.

Impl√©menter l'optimisateur de ressources avec : algorithmes d'assignation optimale pour minimiser les d√©placements, √©quilibrage de la charge de travail entre √©quipes, optimisation des horaires pour maximiser l'efficacit√©, suggestions de regroupement de t√¢ches, calcul du co√ªt optimal des op√©rations.

Cr√©er le r√©solveur de conflits avec : d√©tection automatique des conflits de planning (√©quipes, lieux, horaires), analyse de l'impact des conflits, suggestions de r√©solution avec alternatives, r√©solution automatique pour conflits mineurs, escalade pour conflits complexes.

D√©velopper le calendrier de planning avec : vue hebdomadaire/mensuelle avec t√¢ches color√©es par type, drag & drop pour reprogrammation avec validation, visualisation des disponibilit√©s d'√©quipes, int√©gration avec √©v√©nements clients, export vers calendriers externes.

Impl√©menter l'analyseur de charge avec : calcul de la charge de travail par √©quipe et p√©riode, identification des pics et creux d'activit√©, suggestions de redistribution des t√¢ches, pr√©visions bas√©es sur l'historique, alertes pour surcharge ou sous-utilisation.

Cr√©er les m√©triques de planification avec : taux d'utilisation des √©quipes, efficacit√© des assignations, respect des d√©lais planifi√©s, co√ªt moyen par type de t√¢che, satisfaction des √©quipes, qualit√© du planning.

G√©rer l'int√©gration avec les √©v√©nements avec : synchronisation automatique avec le module √âv√©nements, mise √† jour des plannings lors de modifications d'√©v√©nements, g√©n√©ration de t√¢ches pr√©/post √©v√©nement, adaptation aux changements de derni√®re minute.

‚öôÔ∏è **Interactions** :
- **Consomme** : Donn√©es d'√©v√©nements, disponibilit√©s d'√©quipes, templates de t√¢ches
- **Expose** : Planning optimis√© vers √©quipes et gestionnaires
- **Int√®gre** : Modules √âv√©nements et Calendrier, algorithmes d'optimisation
- **Calcule** : Assignations optimales avec contraintes multiples

üí° **Tips Windsurf** :
- Utiliser Cascade Write Mode pour logique d'optimisation complexe
- Impl√©menter algorithmes avec Edge Functions pour performance
- R√©f√©rencer patterns d'optimisation existants
- Optimiser avec cache pour calculs fr√©quents
- Tester algorithmes avec sc√©narios r√©alistes et cas limites

### Prompt 2.3 : Interface de Gestion des √âquipes et Ressources

üéØ **But** : D√©velopper le syst√®me complet de gestion des √©quipes avec cr√©ation d'√©quipes, assignation de membres, suivi des disponibilit√©s, gestion des comp√©tences, et optimisation des ressources humaines

üß† **Contexte** : Syst√®me de gestion d'√©quipes dans l'onglet √âquipes du module cleaning, permettant la cr√©ation et gestion des √©quipes de nettoyage, le suivi des disponibilit√©s, et l'optimisation des assignations selon les comp√©tences.

üõ†Ô∏è **Fichiers** :
- `components/cleaning/teams/TeamsManagement.tsx`
- `components/cleaning/teams/TeamEditor.tsx`
- `components/cleaning/teams/MemberAssignment.tsx`
- `components/cleaning/teams/AvailabilityTracker.tsx`
- `components/cleaning/teams/SkillsManager.tsx`
- `components/cleaning/teams/WorkloadDashboard.tsx`
- `components/cleaning/teams/TeamPerformance.tsx`
- `hooks/useCleaningTeams.ts`
- `hooks/useTeamAvailability.ts`

üîÑ **Comportement** :
Cr√©er la gestion des √©quipes avec : liste des √©quipes avec statuts temps r√©el, cr√©ation d'√©quipes avec configuration des sp√©cialisations, assignation de chef d'√©quipe et membres, gestion des √©quipements assign√©s, configuration des horaires de travail, suivi des performances d'√©quipe.

D√©velopper l'√©diteur d'√©quipes avec : informations g√©n√©rales (nom, description, sp√©cialisations), s√©lection du chef d'√©quipe avec validation des comp√©tences, ajout/suppression de membres avec gestion des conflits, configuration des √©quipements et fournitures, d√©finition des zones d'intervention, param√®tres de contact.

Impl√©menter l'assignation de membres avec : recherche de personnel disponible avec filtres par comp√©tences, v√©rification des disponibilit√©s et conflits, assignation temporaire ou permanente, gestion des remplacements, historique des assignations, notifications automatiques.

Cr√©er le suivi des disponibilit√©s avec : calendrier des disponibilit√©s par membre et √©quipe, gestion des cong√©s et absences, planification des rotations, alertes pour manque de personnel, int√©gration avec planning des t√¢ches, export vers syst√®mes RH.

D√©velopper la gestion des comp√©tences avec : d√©finition des comp√©tences requises par type de t√¢che, √©valuation des comp√©tences des membres, formation et certification, matching automatique comp√©tences/t√¢ches, plans de d√©veloppement des comp√©tences.

Impl√©menter le dashboard de charge avec : visualisation de la charge de travail par √©quipe, r√©partition des t√¢ches en cours et planifi√©es, m√©triques de productivit√©, alertes de surcharge, suggestions de redistribution, historique des performances.

Cr√©er l'analyse de performance avec : m√©triques de qualit√© par √©quipe, temps de r√©alisation vs estimations, taux de satisfaction client, co√ªt par √©quipe, √©volution des performances, benchmarking entre √©quipes.

G√©rer la communication d'√©quipe avec : notifications push pour nouvelles assignations, chat int√©gr√© pour coordination, partage de photos et notes, alertes d'urgence, historique des communications.

‚öôÔ∏è **Interactions** :
- **Consomme** : Donn√©es utilisateurs, comp√©tences, disponibilit√©s
- **Expose** : Informations d'√©quipes vers planification et assignation
- **Int√®gre** : Syst√®me de notifications, gestion des comp√©tences
- **Optimise** : Assignations selon disponibilit√©s et comp√©tences

üí° **Tips Windsurf** :
- Utiliser Cascade Chat Mode pour logique de gestion d'√©quipes complexe
- Impl√©menter cache pour donn√©es de disponibilit√© fr√©quemment consult√©es
- R√©f√©rencer patterns de gestion RH existants
- Optimiser avec requ√™tes batch pour donn√©es d'√©quipes
- Tester gestion des conflits et cas d'urgence

### Prompt 2.4 : Syst√®me de Templates et Checklists Intelligentes

üéØ **But** : Cr√©er le syst√®me complet de gestion des templates de nettoyage avec checklists intelligentes, validation par √©tapes, capture de photos, et standardisation des proc√©dures

üß† **Contexte** : Syst√®me de templates dans l'onglet Templates du module cleaning, permettant la cr√©ation de mod√®les de nettoyage standardis√©s, la gestion de checklists d√©taill√©es, et la validation qualit√© avec photos.

üõ†Ô∏è **Fichiers** :
- `components/cleaning/templates/TemplatesLibrary.tsx`
- `components/cleaning/templates/TemplateEditor.tsx`
- `components/cleaning/templates/ChecklistBuilder.tsx`
- `components/cleaning/templates/ChecklistExecution.tsx`
- `components/cleaning/templates/QualityValidation.tsx`
- `components/cleaning/templates/PhotoCapture.tsx`
- `components/cleaning/templates/TemplateAnalytics.tsx`
- `hooks/useCleaningTemplates.ts`
- `hooks/useChecklistExecution.ts`

üîÑ **Comportement** :
Cr√©er la biblioth√®que de templates avec : catalogue de templates par type de lieu et √©v√©nement, recherche et filtrage par cat√©gories, pr√©visualisation des templates avec dur√©es estim√©es, duplication et personnalisation, gestion des versions, templates favoris et r√©cents.

D√©velopper l'√©diteur de templates avec : informations g√©n√©rales (nom, description, type), configuration des sp√©cialisations requises, d√©finition des √©quipements et fournitures n√©cessaires, estimation de dur√©e et taille d'√©quipe, instructions d√©taill√©es, param√®tres de validation.

Impl√©menter le constructeur de checklists avec : cr√©ation d'items avec ordre et d√©pendances, d√©finition des crit√®res de validation, configuration des photos obligatoires, param√®tres de notation qualit√©, instructions sp√©cifiques par item, conditions d'√©chec et de r√©ussite.

Cr√©er l'ex√©cution de checklists avec : affichage progressif des items selon l'ordre, validation par √©tapes avec photos, notation qualit√© en temps r√©el, signalement de probl√®mes avec d√©tails, sauvegarde automatique de la progression, synchronisation hors ligne.

D√©velopper la validation qualit√© avec : contr√¥le par √©tapes avec crit√®res objectifs, capture de photos avant/pendant/apr√®s obligatoires, notation sur √©chelles d√©finies, commentaires et observations, validation finale par superviseur, g√©n√©ration de rapports qualit√©.

Impl√©menter la capture de photos avec : interface optimis√©e pour mobile, g√©olocalisation automatique, horodatage certifi√©, compression et upload automatique, organisation par √©tapes de checklist, annotations sur photos, stockage s√©curis√©.

Cr√©er l'analytics des templates avec : taux d'utilisation par template, temps de r√©alisation moyen vs estim√©, taux de r√©ussite des validations, probl√®mes fr√©quents identifi√©s, suggestions d'am√©lioration, √©volution des performances.

G√©rer l'application automatique avec : s√©lection automatique selon type de lieu/√©v√©nement, adaptation des dur√©es selon historique, assignation d'√©quipes selon sp√©cialisations, g√©n√©ration de t√¢ches avec templates, mise √† jour des estimations.

‚öôÔ∏è **Interactions** :
- **Consomme** : Donn√©es de lieux, types d'√©v√©nements, historique des t√¢ches
- **Expose** : Templates vers cr√©ation de t√¢ches et planification
- **Int√®gre** : Capture de photos, validation qualit√©, analytics
- **Standardise** : Proc√©dures de nettoyage avec checklists d√©taill√©es

üí° **Tips Windsurf** :
- Utiliser Supercomplete pour patterns de construction de formulaires complexes
- Impl√©menter upload de photos avec Supabase Storage
- R√©f√©rencer patterns de validation qualit√© existants
- Optimiser interface mobile pour utilisation terrain
- Tester workflows complets de validation avec photos

---

## Section 3 : Fonctionnalit√©s Secondaires

### Prompt 3.1 : Tableaux de Bord et Analytics Op√©rationnels

üéØ **But** : D√©velopper un syst√®me complet de tableaux de bord et analytics op√©rationnels avec m√©triques temps r√©el, analyses de performance, rapports personnalisables, et visualisations interactives

üß† **Contexte** : Syst√®me d'analytics dans l'onglet Rapports du module cleaning, utilisant recharts pour visualisations, calculs de m√©triques complexes c√¥t√© serveur, et g√©n√©ration de rapports avec insights op√©rationnels.

üõ†Ô∏è **Fichiers** :
- `components/cleaning/analytics/CleaningAnalytics.tsx`
- `components/cleaning/analytics/PerformanceMetrics.tsx`
- `components/cleaning/analytics/CostAnalysis.tsx`
- `components/cleaning/analytics/QualityReports.tsx`
- `components/cleaning/analytics/ProductivityDashboard.tsx`
- `components/cleaning/analytics/TrendAnalysis.tsx`
- `components/cleaning/analytics/KPICards.tsx`
- `hooks/useCleaningAnalytics.ts`
- `hooks/useCleaningKPIs.ts`

üîÑ **Comportement** :
Cr√©er le dashboard analytics principal avec : KPIs essentiels (taux de r√©alisation, efficacit√© √©quipes, co√ªt moyen), graphiques d'√©volution temporelle, comparaisons avec objectifs, alertes pour d√©viations, acc√®s rapide aux analyses d√©taill√©es.

D√©velopper l'analyse de performance avec : productivit√© par √©quipe et membre, temps de r√©alisation vs estimations, taux de respect des d√©lais, qualit√© des r√©alisations, identification des goulots d'√©tranglement, benchmarking entre √©quipes.

Impl√©menter l'analyse des co√ªts avec : co√ªt par type de t√¢che et lieu, √©volution des co√ªts par p√©riode, r√©partition fournitures/main d'≈ìuvre, analyse de rentabilit√©, pr√©visions budg√©taires, optimisation des co√ªts.

Cr√©er l'analyse qualit√© avec : taux de validation premi√®re fois, probl√®mes r√©currents identifi√©s, satisfaction par type de prestation, √©volution des standards qualit√©, corr√©lation qualit√©/co√ªt, plans d'am√©lioration.

D√©velopper l'analyse de productivit√© avec : charge de travail optimale par √©quipe, temps morts et inefficacit√©s, utilisation des √©quipements, rotation du personnel, formation et comp√©tences, suggestions d'optimisation.

Impl√©menter l'analyse des tendances avec : saisonnalit√© des besoins de nettoyage, √©volution des types de t√¢ches, pr√©dictions bas√©es sur historique, d√©tection d'anomalies, alertes pr√©ventives, planification pr√©visionnelle.

Cr√©er les KPIs personnalisables avec : d√©finition de m√©triques custom, calculs automatiques, seuils d'alerte configurables, tableaux de bord par r√¥le, historique des performances, comparaisons inter-p√©riodes.

G√©rer les rapports automatis√©s avec : g√©n√©ration programm√©e par √©quipe/lieu/p√©riode, personnalisation par destinataire, export multi-formats (PDF, Excel, CSV), envoi automatique, archivage des rapports, templates personnalisables.

‚öôÔ∏è **Interactions** :
- **Consomme** : Toutes les donn√©es op√©rationnelles, historiques, objectifs
- **Expose** : M√©triques et analyses vers direction et √©quipes
- **Int√®gre** : Outils de g√©n√©ration de rapports, services d'email
- **Analyse** : Performance op√©rationnelle et optimisations possibles

üí° **Tips Windsurf** :
- Utiliser recharts pour visualisations performantes et interactives
- Impl√©menter calculs de m√©triques avec vues mat√©rialis√©es
- Optimiser requ√™tes avec agr√©gations c√¥t√© base
- Tester performance avec gros volumes historiques
- Cr√©er templates de rapports r√©utilisables et brand√©s

### Prompt 3.2 : Gestion des Fournitures et √âquipements

üéØ **But** : Cr√©er un syst√®me complet de gestion des fournitures et √©quipements avec suivi des stocks, alertes automatiques, maintenance pr√©ventive, et optimisation des co√ªts

üß† **Contexte** : Syst√®me de gestion des ressources dans l'onglet Ressources du module cleaning, permettant le suivi des stocks de fournitures, la maintenance des √©quipements, et l'optimisation des co√ªts op√©rationnels.

üõ†Ô∏è **Fichiers** :
- `components/cleaning/resources/SuppliesManagement.tsx`
- `components/cleaning/resources/EquipmentTracker.tsx`
- `components/cleaning/resources/StockAlerts.tsx`
- `components/cleaning/resources/MaintenanceScheduler.tsx`
- `components/cleaning/resources/CostOptimizer.tsx`
- `components/cleaning/resources/UsageAnalytics.tsx`
- `components/cleaning/resources/PurchaseManager.tsx`
- `hooks/useSuppliesManagement.ts`
- `hooks/useEquipmentTracking.ts`

üîÑ **Comportement** :
Cr√©er la gestion des fournitures avec : catalogue des produits avec caract√©ristiques et co√ªts, suivi des stocks en temps r√©el, alertes de rupture et r√©approvisionnement, gestion des fournisseurs et commandes, tra√ßabilit√© des consommations par t√¢che.

D√©velopper le suivi des √©quipements avec : inventaire complet avec fiches techniques, planning de maintenance pr√©ventive, suivi des r√©parations et co√ªts, assignation aux √©quipes, g√©olocalisation des √©quipements mobiles, historique d'utilisation.

Impl√©menter les alertes de stock avec : seuils personnalisables par produit, notifications automatiques multi-canaux, suggestions de commandes bas√©es sur consommation, pr√©visions de besoins, int√©gration avec syst√®mes fournisseurs.

Cr√©er le planificateur de maintenance avec : calendrier de maintenance pr√©ventive, g√©n√©ration automatique des t√¢ches de maintenance, suivi des interventions, gestion des garanties, planification des remplacements, co√ªts de maintenance.

D√©velopper l'optimisateur de co√ªts avec : analyse des consommations par type de t√¢che, identification des gaspillages, suggestions d'√©conomies, n√©gociation avec fournisseurs, optimisation des achats group√©s, ROI des √©quipements.

Impl√©menter l'analytics d'utilisation avec : consommation par √©quipe et p√©riode, efficacit√© d'utilisation des √©quipements, co√ªt par t√¢che r√©alis√©e, tendances de consommation, pr√©visions budg√©taires, benchmarking.

Cr√©er la gestion des achats avec : processus de commande int√©gr√©, validation des budgets, suivi des livraisons, contr√¥le qualit√© des r√©ceptions, gestion des retours, facturation et comptabilisation.

G√©rer l'int√©gration comptable avec : valorisation des stocks, calcul des co√ªts par centre, amortissement des √©quipements, provisions pour maintenance, reporting financier, export vers comptabilit√©.

‚öôÔ∏è **Interactions** :
- **Consomme** : Donn√©es de consommation des t√¢ches, co√ªts fournisseurs
- **Expose** : Disponibilit√© des ressources vers planification
- **Int√®gre** : Module Comptabilit√©, syst√®mes fournisseurs
- **Optimise** : Co√ªts et utilisation des ressources

üí° **Tips Windsurf** :
- Utiliser Edge Functions pour calculs d'optimisation complexes
- Impl√©menter cache pour donn√©es de stock fr√©quemment consult√©es
- R√©f√©rencer patterns de gestion d'inventaire existants
- Optimiser avec requ√™tes batch pour mises √† jour de stock
- Tester alertes et workflows de r√©approvisionnement

### Prompt 3.3 : Interface Mobile et Mode Hors Ligne

üéØ **But** : D√©velopper une interface mobile compl√®te avec mode hors ligne, synchronisation intelligente, capture de photos, g√©olocalisation, et optimisation pour utilisation terrain

üß† **Contexte** : Application mobile responsive dans le module cleaning, optimis√©e pour les √©quipes terrain avec fonctionnalit√©s hors ligne, synchronisation automatique, et interface tactile adapt√©e aux conditions de travail.

üõ†Ô∏è **Fichiers** :
- `components/cleaning/mobile/MobileTaskView.tsx`
- `components/cleaning/mobile/OfflineChecklistExecution.tsx`
- `components/cleaning/mobile/PhotoCaptureOptimized.tsx`
- `components/cleaning/mobile/LocationTracker.tsx`
- `components/cleaning/mobile/SyncManager.tsx`
- `components/cleaning/mobile/MobileNavigation.tsx`
- `components/cleaning/mobile/TouchOptimizedControls.tsx`
- `hooks/useOfflineMode.ts`
- `hooks/useMobileOptimization.ts`

üîÑ **Comportement** :
Cr√©er la vue mobile des t√¢ches avec : interface simplifi√©e et tactile, affichage prioritaire des informations essentielles, navigation intuitive par gestes, boutons larges pour utilisation avec gants, mode sombre pour √©conomie batterie.

D√©velopper l'ex√©cution de checklist hors ligne avec : stockage local des donn√©es de t√¢ches, progression sauvegard√©e automatiquement, capture de photos en local, synchronisation diff√©r√©e, r√©solution de conflits intelligente.

Impl√©menter la capture de photos optimis√©e avec : interface cam√©ra native optimis√©e, compression automatique pour √©conomie d'espace, g√©olocalisation et horodatage automatiques, upload en arri√®re-plan, retry automatique en cas d'√©chec.

Cr√©er le suivi de localisation avec : g√©olocalisation automatique lors des check-in/out, tra√ßabilit√© des d√©placements d'√©quipes, optimisation des trajets, alertes de zone, respect de la vie priv√©e.

D√©velopper le gestionnaire de synchronisation avec : d√©tection automatique de connectivit√©, synchronisation intelligente par priorit√©, r√©solution de conflits avec interface utilisateur, indicateurs de statut de sync, mode √©conomie de donn√©es.

Impl√©menter la navigation mobile avec : menu hamburger optimis√©, navigation par onglets, raccourcis vers actions fr√©quentes, recherche rapide, favoris personnalisables, navigation vocale.

Cr√©er les contr√¥les tactiles avec : boutons adapt√©s aux doigts et gants, gestes de navigation intuitifs, feedback haptique, validation par double-tap pour actions critiques, interface adaptative selon contexte.

G√©rer l'optimisation mobile avec : lazy loading pour performance, cache intelligent des donn√©es fr√©quentes, compression des images, √©conomie de batterie, adaptation √† la qualit√© r√©seau.

‚öôÔ∏è **Interactions** :
- **Synchronise** : Donn√©es avec serveur selon connectivit√©
- **Capture** : Photos et donn√©es de localisation
- **Optimise** : Performance et consommation batterie
- **Adapte** : Interface selon conditions d'utilisation

üí° **Tips Windsurf** :
- Utiliser PWA pour installation native et mode hors ligne
- Impl√©menter Service Workers pour cache et synchronisation
- Optimiser images avec compression et formats modernes
- Tester sur vrais appareils mobiles et conditions terrain
- Cr√©er interface adapt√©e aux environnements difficiles

---

## Section 4 : √âvolutions Futures

### Prompt 4.1 : Intelligence Artificielle et Optimisation Avanc√©e

üéØ **But** : Int√©grer des capacit√©s d'intelligence artificielle pour l'optimisation automatique des plannings, la pr√©diction des besoins, l'analyse pr√©dictive des pannes, et l'assistance intelligente

üß† **Contexte** : Module IA op√©rationnel utilisant Supabase Edge Functions, int√©gration OpenAI API, mod√®les de ML sp√©cialis√©s en optimisation, et automatisation intelligente des processus de nettoyage.

üõ†Ô∏è **Fichiers** :
- `supabase/functions/ai-schedule-optimization/index.ts`
- `supabase/functions/ai-predictive-maintenance/index.ts`
- `supabase/functions/ai-demand-forecasting/index.ts`
- `components/cleaning/ai/AIOptimizationAssistant.tsx`
- `components/cleaning/ai/PredictiveAnalytics.tsx`
- `components/cleaning/ai/SmartScheduler.tsx`
- `services/ai-cleaning-service.ts`
- `hooks/useAIOptimization.ts`

üîÑ **Comportement** :
Cr√©er l'assistant IA d'optimisation avec : analyse automatique des plannings existants, suggestions d'am√©lioration bas√©es sur historique, optimisation multi-crit√®res (co√ªt, temps, qualit√©), apprentissage continu des pr√©f√©rences, recommandations personnalis√©es.

D√©velopper l'optimisation intelligente des plannings avec : algorithmes g√©n√©tiques pour assignation optimale, machine learning pour pr√©diction des dur√©es, optimisation des trajets d'√©quipes, √©quilibrage automatique des charges, adaptation aux contraintes temps r√©el.

Impl√©menter l'analyse pr√©dictive avec : pr√©diction des pannes d'√©quipements bas√©e sur usage, anticipation des besoins en fournitures, pr√©vision de la charge de travail, d√©tection d'anomalies dans les performances, alertes pr√©ventives.

Cr√©er la pr√©vision de demande avec : analyse des tendances saisonni√®res, pr√©diction bas√©e sur √©v√©nements planifi√©s, mod√©lisation des besoins par type de lieu, optimisation des stocks pr√©visionnelle, planification des ressources humaines.

D√©velopper l'assistance intelligente avec : chatbot pour support √©quipes terrain, reconnaissance d'images pour validation qualit√©, suggestions automatiques de r√©solution de probl√®mes, formation adaptative bas√©e sur performance.

Impl√©menter l'optimisation continue avec : apprentissage automatique des patterns d'efficacit√©, adaptation des templates bas√©e sur r√©sultats, optimisation des co√ªts par IA, am√©lioration continue des processus.

Cr√©er l'analyse comportementale avec : analyse des patterns de travail des √©quipes, identification des meilleures pratiques, d√©tection des inefficacit√©s, recommandations de formation personnalis√©es.

G√©rer l'int√©gration IoT avec : capteurs pour suivi automatique des √©quipements, monitoring environnemental des espaces, automatisation bas√©e sur donn√©es capteurs, maintenance pr√©dictive avanc√©e.

‚öôÔ∏è **Interactions** :
- **Consomme** : Toutes les donn√©es historiques, APIs IA externes
- **Expose** : Optimisations et pr√©dictions vers utilisateurs
- **Int√®gre** : OpenAI API, mod√®les de ML, Edge Functions
- **Apprend** : Continuellement des donn√©es et feedback

üí° **Tips Windsurf** :
- Utiliser Edge Functions pour traitement IA c√¥t√© serveur
- Impl√©menter cache intelligent pour pr√©dictions fr√©quentes
- Tester avec donn√©es historiques pour validation mod√®les
- Cr√©er interfaces explicables pour d√©cisions IA
- Monitorer performance et biais des mod√®les

### Prompt 4.2 : IoT et Automatisation Avanc√©e

üéØ **But** : D√©velopper un syst√®me d'int√©gration IoT pour le monitoring automatique des √©quipements, la surveillance environnementale, l'automatisation des processus, et la maintenance pr√©dictive

üß† **Contexte** : Int√©gration IoT pour automatiser le suivi des √©quipements, utilisant des capteurs connect√©s, des syst√®mes de monitoring temps r√©el, et des automatisations bas√©es sur donn√©es environnementales.

üõ†Ô∏è **Fichiers** :
- `supabase/functions/iot-data-processor/index.ts`
- `supabase/functions/automated-maintenance-alerts/index.ts`
- `components/cleaning/iot/IoTDashboard.tsx`
- `components/cleaning/iot/SensorMonitoring.tsx`
- `components/cleaning/iot/AutomatedAlerts.tsx`
- `services/iot-integration-service.ts`
- `hooks/useIoTMonitoring.ts`

üîÑ **Comportement** :
Cr√©er l'int√©gration IoT avec : connexion avec capteurs d'√©quipements, monitoring temps r√©el des performances, collecte automatique de donn√©es d'usage, d√©tection automatique des anomalies, alertes pr√©ventives bas√©es sur seuils.

D√©velopper le monitoring environnemental avec : capteurs de qualit√© d'air et propret√©, surveillance automatique des espaces, alertes de nettoyage bas√©es sur occupation, optimisation des cycles de nettoyage, reporting environnemental.

Impl√©menter l'automatisation des processus avec : d√©clenchement automatique de t√¢ches bas√© sur capteurs, ajustement dynamique des plannings, optimisation √©nerg√©tique des √©quipements, automatisation des commandes de fournitures.

Cr√©er la maintenance pr√©dictive avec : analyse des vibrations et temp√©ratures d'√©quipements, pr√©diction des pannes bas√©e sur patterns, planification automatique de maintenance, optimisation des cycles de remplacement.

D√©velopper le dashboard IoT avec : visualisation temps r√©el des donn√©es capteurs, alertes et notifications automatiques, historique des donn√©es avec tendances, configuration des seuils et r√®gles, export des donn√©es.

Impl√©menter la gestion des capteurs avec : configuration et calibration automatique, diagnostic de sant√© des capteurs, mise √† jour firmware √† distance, gestion des batteries et alimentation, remplacement pr√©ventif.

Cr√©er l'automatisation intelligente avec : r√®gles m√©tier bas√©es sur donn√©es IoT, workflows automatis√©s pour maintenance, optimisation √©nerg√©tique automatique, adaptation aux conditions environnementales.

G√©rer la s√©curit√© IoT avec : chiffrement des communications capteurs, authentification des dispositifs, monitoring de s√©curit√© r√©seau, mise √† jour s√©curis√©e des firmwares, audit des acc√®s.

‚öôÔ∏è **Interactions** :
- **Collecte** : Donn√©es temps r√©el depuis capteurs IoT
- **Automatise** : Processus bas√©s sur donn√©es environnementales
- **Optimise** : Maintenance et consommation √©nerg√©tique
- **S√©curise** : Communications et donn√©es IoT

üí° **Tips Windsurf** :
- Utiliser Edge Functions pour traitement donn√©es IoT
- Impl√©menter protocoles s√©curis√©s pour communications
- Tester avec simulateurs avant d√©ploiement capteurs
- Cr√©er interfaces de configuration intuitives
- Monitorer performance et s√©curit√© r√©seau IoT

### Prompt 4.3 : R√©alit√© Augment√©e et Formation Immersive

üéØ **But** : Cr√©er une plateforme de r√©alit√© augment√©e pour la formation des √©quipes, l'assistance terrain, la validation qualit√© visuelle, et l'am√©lioration des processus de nettoyage

üß† **Contexte** : Plateforme AR utilisant technologies web modernes, int√©gration cam√©ra pour reconnaissance d'objets, formation immersive pour √©quipes, et assistance contextuelle pour am√©liorer la qualit√©.

üõ†Ô∏è **Fichiers** :
- `components/cleaning/ar/ARTrainingModule.tsx`
- `components/cleaning/ar/ARQualityChecker.tsx`
- `components/cleaning/ar/ARAssistant.tsx`
- `components/cleaning/ar/ARVisualization.tsx`
- `services/ar-integration-service.ts`
- `hooks/useARCapabilities.ts`

üîÑ **Comportement** :
Cr√©er le module de formation AR avec : simulations immersives des proc√©dures de nettoyage, reconnaissance d'objets pour identification des zones, instructions contextuelles superpos√©es, √©valuation en temps r√©el des gestes, certification des comp√©tences.

D√©velopper l'assistant AR terrain avec : reconnaissance automatique des espaces et √©quipements, affichage des instructions contextuelles, guidage visuel pour proc√©dures complexes, validation des √©tapes par reconnaissance visuelle.

Impl√©menter le contr√¥le qualit√© AR avec : reconnaissance automatique des d√©fauts de nettoyage, comparaison avant/apr√®s avec overlay visuel, scoring automatique de qualit√©, documentation visuelle des probl√®mes.

Cr√©er la visualisation AR avec : affichage des donn√©es de performance en overlay, visualisation des zones √† nettoyer, historique visuel des interventions, navigation augment√©e dans les espaces.

D√©velopper la formation immersive avec : sc√©narios de formation interactifs, simulation des situations d'urgence, apprentissage adaptatif bas√© sur performance, certification virtuelle des comp√©tences.

Impl√©menter l'assistance contextuelle avec : reconnaissance de contexte automatique, suggestions intelligentes bas√©es sur situation, acc√®s rapide aux proc√©dures, support expert √† distance.

Cr√©er l'analytics AR avec : suivi des interactions utilisateur, efficacit√© des formations AR, am√©lioration continue des contenus, personnalisation bas√©e sur usage.

G√©rer la compatibilit√© avec : support multi-plateformes (mobile, tablette, lunettes AR), adaptation aux capacit√©s mat√©rielles, fallback pour appareils non compatibles, optimisation performance.

‚öôÔ∏è **Interactions** :
- **Utilise** : Cam√©ra et capteurs pour reconnaissance
- **Forme** : √âquipes avec exp√©riences immersives
- **Assiste** : Op√©rations terrain avec contexte visuel
- **Am√©liore** : Qualit√© avec validation automatique

üí° **Tips Windsurf** :
- Utiliser WebXR pour compatibilit√© multi-plateformes
- Impl√©menter reconnaissance d'objets avec TensorFlow.js
- Tester sur diff√©rents appareils et conditions d'√©clairage
- Cr√©er contenus de formation progressifs et adaptatifs
- Optimiser performance pour appareils mobiles

---

## Validation et Coh√©rence Inter-Modules

### Analyse de Coh√©rence avec l'√âcosyst√®me ERP

Le module Planning M√©nage pr√©sente une int√©gration op√©rationnelle strat√©gique avec l'ensemble de l'√©cosyst√®me ERP Wedding Collection, n√©cessitant une validation approfondie pour garantir la coh√©rence architecturale, fonctionnelle, et l'efficacit√© op√©rationnelle.

L'**int√©gration avec le module Lieux** constitue une d√©pendance fondamentale, le module Planning M√©nage consommant les donn√©es de lieux et d'espaces pour la planification des t√¢ches de nettoyage tout en enrichissant les informations de lieux avec l'historique de maintenance. La coh√©rence des donn√©es spatiales doit √™tre maintenue entre les modules, avec synchronisation des informations de nettoyage, √©tats des espaces, et disponibilit√©s. Les permissions d'acc√®s aux donn√©es de nettoyage doivent respecter les r√¥les d√©finis dans le module Lieux.

L'**extension du module √âv√©nements** repr√©sente une relation architecturale critique, le module Planning M√©nage g√©n√©rant automatiquement les t√¢ches de nettoyage pr√© et post-√©v√©nement. Cette int√©gration n√©cessite une synchronisation des plannings de nettoyage avec les horaires d'√©v√©nements, une coh√©rence des exigences de nettoyage avec les types d'√©v√©nements, et une tra√ßabilit√© compl√®te entre obligations de nettoyage et √©v√©nements clients.

L'**int√©gration avec le module Comptabilit√© et Facturation** implique la transmission automatique des co√ªts de nettoyage bas√©e sur les ressources utilis√©es, la gestion des co√ªts de fournitures et main d'≈ìuvre, et la synchronisation des donn√©es financi√®res. Les donn√©es de co√ªts de nettoyage doivent √™tre coh√©rentes entre les modules.

L'**int√©gration avec le module Calendrier** n√©cessite l'affichage des t√¢ches de nettoyage dans le calendrier global avec codes couleur sp√©cifiques, gestion des conflits de planning, et synchronisation bidirectionnelle des modifications.

La **pr√©paration pour les modules futurs** (Prestataires externes de nettoyage) n√©cessite une architecture extensible qui permette l'int√©gration des √©quipes externes, la gestion des contrats de nettoyage, et l'√©volution vers une gestion globale des ressources.

### Recommandations d'Harmonisation

L'**impl√©mentation d'un syst√®me d'√©v√©nements op√©rationnels unifi√©** permettrait une communication asynchrone standardis√©e entre tous les modules. Les √©v√©nements `cleaning_task_completed`, `space_ready`, `maintenance_required` pourraient d√©clencher des actions automatis√©es dans les modules d√©pendants.

L'**adoption d'un cache op√©rationnel centralis√©** am√©liorerait les performances en √©vitant la duplication des validations de disponibilit√©, calculs de co√ªts, et v√©rifications de qualit√©. Un cache Redis sp√©cialis√© pourrait stocker les donn√©es op√©rationnelles fr√©quemment consult√©es.

L'**standardisation des APIs op√©rationnelles inter-modules** faciliterait l'int√©gration en d√©finissant des contrats d'interface clairs pour les op√©rations de nettoyage. Cette approche permettrait l'√©volution ind√©pendante des modules tout en maintenant la coh√©rence op√©rationnelle.

### √âl√©ments Manquants Identifi√©s

Un **syst√®me de gestion des prestataires externes** pourrait √™tre d√©velopp√© pour int√©grer les √©quipes de nettoyage externes, avec gestion des contrats, √©valuation des performances, et coordination avec les √©quipes internes.

Un **module de conformit√© sanitaire avanc√©e** pourrait √™tre int√©gr√© pour supporter les r√©glementations sanitaires, avec validation automatique des proc√©dures, certification des nettoyages, et adaptation aux normes locales.

Un **syst√®me de gamification** pourrait motiver les √©quipes avec challenges, r√©compenses bas√©es sur performance, classements d'√©quipes, et reconnaissance des meilleures pratiques.

Cette analyse de coh√©rence garantit une int√©gration harmonieuse du module Planning M√©nage dans l'√©cosyst√®me ERP Wedding Collection, assurant l'efficacit√© op√©rationnelle et l'optimisation des processus de nettoyage.

