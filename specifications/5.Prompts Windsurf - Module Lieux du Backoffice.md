# Prompts Windsurf - Module Lieux du Backoffice

## ğŸ“‹ Informations du Module

- **Module** : Gestion des Lieux (Backoffice)
- **Identifiant technique** : `backoffice_venue_management`
- **Version** : 0.1.0
- **Application** : Backoffice (`apps/backoffice`)
- **PrioritÃ©** : P1 (Haute - Module mÃ©tier fondamental)
- **DÃ©pendances** : Module Initialisation Monorepo, Console Admin, Dashboard
- **SchÃ©ma DB** : `shared` (tables venues et rÃ©fÃ©rentiels)

---

## ğŸ¯ Vue d'Ensemble du Module

Le module Lieux du Backoffice constitue l'un des piliers mÃ©tier de l'ERP Wedding Collection. Il centralise la gestion complÃ¨te des lieux de rÃ©ception partenaires avec leurs espaces, Ã©quipements, photos, plans et disponibilitÃ©s. Ce module fournit une interface d'administration complÃ¨te pour les gestionnaires de contenu et s'intÃ¨gre parfaitement avec les autres modules de l'Ã©cosystÃ¨me.

Le module s'intÃ¨gre dans l'application `apps/backoffice` via le bouton "Lieux" de la sidebar. Il utilise le schÃ©ma `shared` de Supabase pour assurer la cohÃ©rence des donnÃ©es avec les autres applications du monorepo (client-portal, vendor-portal, public-site).

---

## ğŸš€ Section 1 : Initialisation

### 01 - CrÃ©ation des tables principales et types Ã©numÃ©rÃ©s

ğŸ¯ **But clair**
CrÃ©er les tables principales du module Lieux dans le schÃ©ma `shared` avec les types Ã©numÃ©rÃ©s, en respectant les conventions Supabase du projet et en assurant l'intÃ©gritÃ© rÃ©fÃ©rentielle.

ğŸ§  **Contexte technique**
Ces tables constituent la fondation du module Lieux. Elles incluent la table principale `wedding_venues`, les tables liÃ©es pour espaces, photos, plans et disponibilitÃ©s, ainsi que les types Ã©numÃ©rÃ©s pour standardiser les valeurs. La structure doit supporter la complexitÃ© mÃ©tier tout en restant performante.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Migration Supabase

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- CrÃ©ation des types Ã©numÃ©rÃ©s : venue_status_enum, price_range_enum, period_type_enum, plan_type_enum, space_type_enum
- Table wedding_venues avec tous les champs mÃ©tier (adresse, capacitÃ©s, contact, etc.)
- Tables liÃ©es : venue_photos, venue_floor_plans, venue_spaces, venue_space_photos
- Contraintes d'intÃ©gritÃ© et validation (dates, capacitÃ©s positives)
- Champs standards : id, created_at, updated_at, created_by, updated_by

âš™ï¸ **Interactions avec d'autres modules**
- RÃ©fÃ©rence : auth.users (Console Admin)
- UtilisÃ© par : Module Ã‰vÃ©nements pour rÃ©servations
- IntÃ¨gre : avec systÃ¨me d'audit global
- Base pour : portails client et vendor

ğŸ’¡ **Tips Windsurf**
- Utiliser le MCP Supabase pour exÃ©cuter directement les migrations
- CrÃ©er les types Ã©numÃ©rÃ©s avant les tables pour Ã©viter les erreurs
- Valider les contraintes CHECK avec des exemples concrets
- PrÃ©voir l'extensibilitÃ© avec des champs JSONB pour mÃ©tadonnÃ©es

---

### 02 - CrÃ©ation des tables de rÃ©fÃ©rence et liaisons

ğŸ¯ **But clair**
CrÃ©er les tables de rÃ©fÃ©rence (activity_types, equipments, venue_types, regions, countries) et les tables de liaison (venue_space_equipments, venue_space_activity_links) avec leurs relations.

ğŸ§  **Contexte technique**
Ces tables de rÃ©fÃ©rence standardisent les donnÃ©es mÃ©tier et permettent une gestion cohÃ©rente des Ã©quipements, activitÃ©s et classifications. Les tables de liaison implÃ©mentent les relations many-to-many entre espaces et Ã©quipements/activitÃ©s avec des mÃ©tadonnÃ©es additionnelles.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Migration Supabase

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Tables de rÃ©fÃ©rence : activity_types, equipments, equipment_categories, venue_types, regions, countries
- Tables de liaison : venue_space_equipments, venue_space_activity_links
- Contraintes d'unicitÃ© sur les noms des rÃ©fÃ©rentiels
- Support des hiÃ©rarchies (catÃ©gories d'Ã©quipements)
- Champs is_active pour dÃ©sactivation logique
- Relations avec quantitÃ©s et notes pour les liaisons

âš™ï¸ **Interactions avec d'autres modules**
- PartagÃ© : avec tous les modules utilisant les lieux
- RÃ©fÃ©rencÃ© : par Module Ã‰vÃ©nements et portails
- Ã‰tendu : par Module Prestataires (vendors)
- SynchronisÃ© : avec donnÃ©es externes potentielles

ğŸ’¡ **Tips Windsurf**
- Utiliser des contraintes UNIQUE pour Ã©viter les doublons
- PrÃ©voir des index sur les colonnes de recherche frÃ©quente
- ImplÃ©menter des triggers pour l'audit automatique
- Structurer les JSONB pour faciliter les requÃªtes futures

---

### 03 - Configuration des index et optimisations de performance

ğŸ¯ **But clair**
CrÃ©er tous les index optimisÃ©s pour les requÃªtes frÃ©quentes du module Lieux, incluant la recherche textuelle, les filtres gÃ©ographiques et les jointures complexes.

ğŸ§  **Contexte technique**
Les index sont cruciaux pour les performances car le module sera intensivement utilisÃ© pour la recherche et la consultation de lieux. L'optimisation doit couvrir la recherche textuelle (GIN), les filtres multiples (composites) et les jointures frÃ©quentes.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Migration Supabase

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Index de recherche textuelle GIN sur nom et description
- Index composites pour filtres (rÃ©gion, capacitÃ©, prix, statut)
- Index sur clÃ©s Ã©trangÃ¨res pour jointures optimisÃ©es
- Index sur dates pour recherches de disponibilitÃ©
- Index partiels pour donnÃ©es actives uniquement
- Analyse des performances avec EXPLAIN

âš™ï¸ **Interactions avec d'autres modules**
- Optimise : requÃªtes depuis tous les modules consommateurs
- AmÃ©liore : performances du Dashboard (mÃ©triques lieux)
- Facilite : recherches depuis portails client/vendor
- Supporte : rapports et analytics

ğŸ’¡ **Tips Windsurf**
- Analyser les patterns de requÃªtes avant de crÃ©er les index
- Utiliser EXPLAIN ANALYZE pour valider les performances
- CrÃ©er des index partiels pour optimiser l'espace
- Monitorer l'utilisation des index en production

---

### 04 - Configuration des politiques RLS et sÃ©curitÃ©

ğŸ¯ **But clair**
Configurer les politiques Row Level Security (RLS) pour toutes les tables du module avec des rÃ¨gles granulaires selon les rÃ´les utilisateur, en assurant la sÃ©curitÃ© des donnÃ©es mÃ©tier.

ğŸ§  **Contexte technique**
Les politiques RLS sont essentielles car les donnÃ©es de lieux sont partagÃ©es entre plusieurs applications du monorepo. Elles doivent permettre la lecture publique des lieux actifs tout en restreignant les modifications aux utilisateurs autorisÃ©s.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Politiques RLS Supabase

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- RLS activÃ©e sur toutes les tables sensibles
- Lecture publique des lieux actifs et publiÃ©s
- Modification restreinte aux ADMIN et VENUE_CONTENT_MANAGER
- Gestion des brouillons (visibles uniquement par le crÃ©ateur)
- Politiques spÃ©cifiques pour les donnÃ©es de rÃ©fÃ©rence
- Audit automatique des modifications

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : systÃ¨me de permissions Console Admin
- IntÃ¨gre : avec auth.uid() pour identification
- Respecte : hiÃ©rarchie des rÃ´les dÃ©finie
- ProtÃ¨ge : donnÃ©es sensibles inter-applications

ğŸ’¡ **Tips Windsurf**
- Tester les politiques avec diffÃ©rents rÃ´les utilisateur
- Utiliser des fonctions helper pour Ã©viter la duplication
- PrÃ©voir des politiques d'urgence pour maintenance
- Documenter chaque politique avec des exemples

---

### 05 - Fonctions RPC pour la gestion des lieux

ğŸ¯ **But clair**
CrÃ©er les fonctions RPC Supabase pour la gestion complÃ¨te des lieux : CRUD optimisÃ©, recherche avancÃ©e, gestion des disponibilitÃ©s et validation mÃ©tier avec audit automatique.

ğŸ§  **Contexte technique**
Ces fonctions RPC centralisent la logique mÃ©tier complexe du module Lieux. Elles intÃ¨grent la validation des donnÃ©es, la gestion des relations, l'optimisation des requÃªtes et l'audit automatique. Elles constituent l'API backend du module.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Fonctions RPC Supabase

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- `rpc_create_venue()` : crÃ©ation lieu avec validation complÃ¨te
- `rpc_update_venue()` : modification avec gestion des changements
- `rpc_search_venues()` : recherche avancÃ©e avec filtres et tri
- `rpc_get_venue_details()` : rÃ©cupÃ©ration complÃ¨te avec relations
- `rpc_manage_venue_availability()` : gestion des pÃ©riodes
- Validation des donnÃ©es mÃ©tier (capacitÃ©s, dates, coordonnÃ©es)
- Audit automatique de toutes les actions

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : Console Admin pour vÃ©rification permissions
- IntÃ¨gre : systÃ¨me d'audit global
- Fournit : API pour Module Ã‰vÃ©nements
- Supporte : recherches depuis portails

ğŸ’¡ **Tips Windsurf**
- Utiliser SECURITY DEFINER avec validation stricte
- ImplÃ©menter la validation mÃ©tier cÃ´tÃ© serveur
- GÃ©rer les transactions pour maintenir la cohÃ©rence
- CrÃ©er des fonctions helper pour la rÃ©utilisabilitÃ©

---

### 06 - Configuration Supabase Storage pour mÃ©dias

ğŸ¯ **But clair**
Configurer les buckets Supabase Storage pour les photos de lieux et espaces, plans d'Ã©tage, avec politiques de sÃ©curitÃ©, optimisation des images et gestion des quotas.

ğŸ§  **Contexte technique**
Le stockage des mÃ©dias est critique pour l'expÃ©rience utilisateur. La configuration doit supporter l'upload massif, l'optimisation automatique, la sÃ©curitÃ© d'accÃ¨s et la performance de diffusion. Les buckets doivent Ãªtre organisÃ©s logiquement.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql`, `.js` - Configuration Storage et Edge Functions

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Buckets : wedding-venues-photos, venue-spaces-photos, venue-floor-plans
- Politiques d'upload restreintes aux utilisateurs autorisÃ©s
- Politiques de lecture publique pour photos publiÃ©es
- Optimisation automatique des images (resize, compression)
- Gestion des quotas et limitations de taille
- Nommage structurÃ© des fichiers

âš™ï¸ **Interactions avec d'autres modules**
- UtilisÃ© : par interfaces de gestion des mÃ©dias
- IntÃ¨gre : avec CDN pour performance globale
- PartagÃ© : avec portails pour affichage public
- OptimisÃ© : pour diffÃ©rents formats d'Ã©cran

ğŸ’¡ **Tips Windsurf**
- Utiliser des Edge Functions pour l'optimisation d'images
- ImplÃ©menter des politiques de nettoyage automatique
- Configurer des transformations d'images Ã  la volÃ©e
- PrÃ©voir la migration vers CDN externe si nÃ©cessaire

---

## ğŸ—ï¸ Section 2 : FonctionnalitÃ©s Principales

### 07 - Interface de liste et recherche des lieux

ğŸ¯ **But clair**
CrÃ©er l'interface principale de liste des lieux avec recherche avancÃ©e, filtres multiples, tri, pagination et actions en lot, en utilisant les composants ShadCN UI pour la cohÃ©rence.

ğŸ§  **Contexte technique**
Cette interface constitue le point d'entrÃ©e principal du module. Elle doit gÃ©rer efficacement de gros volumes de donnÃ©es avec une UX fluide. L'implÃ©mentation utilise React Hook Form pour les filtres, TanStack Query pour la gestion des donnÃ©es et des composants optimisÃ©s pour les performances.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Liste paginÃ©e avec 20 Ã©lÃ©ments par page par dÃ©faut
- Recherche textuelle en temps rÃ©el avec debouncing
- Filtres : rÃ©gion, type, capacitÃ©, prix, statut
- Tri : nom, date crÃ©ation, capacitÃ©, rÃ©gion
- Actions en lot : publication, archivage, export
- PrÃ©visualisation rapide au survol
- Navigation vers dÃ©tail et Ã©dition

âš™ï¸ **Interactions avec d'autres modules**
- Consomme : RPC de recherche et filtrage
- Utilise : composants shared-ui pour cohÃ©rence
- IntÃ¨gre : avec systÃ¨me de permissions
- Navigue : vers formulaires de crÃ©ation/Ã©dition

ğŸ’¡ **Tips Windsurf**
- Utiliser React Hook Form pour la gestion des filtres
- ImplÃ©menter la virtualisation pour les grandes listes
- CrÃ©er des composants rÃ©utilisables pour les cartes de lieu
- Optimiser les requÃªtes avec mise en cache intelligente

---

### 08 - Formulaire de crÃ©ation et Ã©dition de lieu

ğŸ¯ **But clair**
CrÃ©er le formulaire multi-Ã©tapes de crÃ©ation et Ã©dition de lieu avec validation Zod, sauvegarde automatique, gestion des erreurs et interface intuitive pour tous les champs mÃ©tier.

ğŸ§  **Contexte technique**
Ce formulaire complexe gÃ¨re de nombreux champs avec des validations mÃ©tier spÃ©cifiques. Il utilise un wizard multi-Ã©tapes pour amÃ©liorer l'UX, Zod pour la validation cÃ´tÃ© client, et une logique de sauvegarde progressive pour Ã©viter la perte de donnÃ©es.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et schÃ©mas de validation

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Wizard en 4 Ã©tapes : Informations gÃ©nÃ©rales, Adresse/Localisation, CapacitÃ©s/Ã‰quipements, Contact/Conditions
- Validation Zod en temps rÃ©el avec messages d'erreur contextuels
- Sauvegarde automatique en brouillon toutes les 30 secondes
- GÃ©olocalisation automatique depuis l'adresse
- SÃ©lection multiple pour Ã©quipements et activitÃ©s
- PrÃ©visualisation avant publication

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : RPC de crÃ©ation/modification de lieu
- IntÃ¨gre : avec systÃ¨me de gÃ©olocalisation
- Sauvegarde : brouillons avec permissions appropriÃ©es
- Valide : donnÃ©es avec rÃ¨gles mÃ©tier

ğŸ’¡ **Tips Windsurf**
- Utiliser React Hook Form avec Zod pour la validation
- ImplÃ©menter un systÃ¨me de sauvegarde automatique
- CrÃ©er des composants de champ rÃ©utilisables
- GÃ©rer les Ã©tats de chargement et d'erreur Ã©lÃ©gamment

---

### 09 - Page de dÃ©tail et vue d'ensemble du lieu

ğŸ¯ **But clair**
CrÃ©er la page de dÃ©tail complÃ¨te d'un lieu avec toutes ses informations, espaces, photos, plans, disponibilitÃ©s et Ã©quipements, avec navigation intuitive et actions contextuelles.

ğŸ§  **Contexte technique**
Cette page complexe agrÃ¨ge toutes les donnÃ©es liÃ©es Ã  un lieu. Elle utilise des onglets pour organiser l'information, un lazy loading pour les mÃ©dias, et des composants optimisÃ©s pour gÃ©rer les relations complexes entre entitÃ©s.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Vue d'ensemble avec informations principales et photo principale
- Onglets : DÃ©tails, Espaces, Photos, Plans, DisponibilitÃ©s, Historique
- Galerie photos avec lightbox et zoom
- Liste des espaces avec capacitÃ©s et Ã©quipements
- Calendrier de disponibilitÃ© interactif
- Actions : Ã‰diter, Dupliquer, Archiver, Exporter
- Historique des modifications avec dÃ©tails

âš™ï¸ **Interactions avec d'autres modules**
- Consomme : RPC de rÃ©cupÃ©ration dÃ©taillÃ©e
- Affiche : donnÃ©es depuis Module Ã‰vÃ©nements (rÃ©servations)
- IntÃ¨gre : avec systÃ¨me de permissions pour actions
- Navigue : vers Ã©dition et gestion des espaces

ğŸ’¡ **Tips Windsurf**
- Utiliser des onglets pour organiser l'information
- ImplÃ©menter le lazy loading pour les mÃ©dias volumineux
- CrÃ©er des composants modulaires pour chaque section
- Optimiser les requÃªtes avec des jointures efficaces

---

### 10 - Gestion des espaces et leurs caractÃ©ristiques

ğŸ¯ **But clair**
CrÃ©er l'interface de gestion des espaces d'un lieu avec CRUD complet, association d'Ã©quipements et activitÃ©s, gestion des photos et validation des capacitÃ©s.

ğŸ§  **Contexte technique**
Cette interface gÃ¨re la complexitÃ© des espaces avec leurs multiples relations. Elle utilise des modales pour l'Ã©dition, des drag & drop pour les photos, et des sÃ©lecteurs avancÃ©s pour les Ã©quipements et activitÃ©s.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Liste des espaces avec aperÃ§u des caractÃ©ristiques
- Formulaire d'espace avec validation des capacitÃ©s
- Gestion des Ã©quipements avec quantitÃ©s et notes
- Association des types d'activitÃ©s possibles
- Upload et gestion des photos d'espace
- Calcul automatique des capacitÃ©s totales du lieu
- RÃ©organisation par drag & drop

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : RPC de gestion des espaces
- IntÃ¨gre : avec gestion des Ã©quipements
- Calcule : mÃ©triques pour Dashboard
- Valide : cohÃ©rence avec capacitÃ©s du lieu

ğŸ’¡ **Tips Windsurf**
- Utiliser des modales pour l'Ã©dition d'espace
- ImplÃ©menter des sÃ©lecteurs multi-choix pour Ã©quipements
- CrÃ©er des validations de cohÃ©rence entre espace et lieu
- Optimiser les mises Ã  jour en temps rÃ©el

---

### 11 - Gestion des mÃ©dias (photos et plans)

ğŸ¯ **But clair**
CrÃ©er l'interface de gestion des mÃ©dias avec upload drag & drop, prÃ©visualisation, rÃ©organisation, optimisation automatique et gestion des mÃ©tadonnÃ©es.

ğŸ§  **Contexte technique**
Cette interface critique gÃ¨re l'upload et l'organisation des mÃ©dias. Elle utilise Supabase Storage, implÃ©mente l'optimisation d'images cÃ´tÃ© client, et fournit une UX fluide pour la gestion de galeries complexes.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Upload drag & drop avec prÃ©visualisation instantanÃ©e
- Compression et redimensionnement automatique
- RÃ©organisation par drag & drop avec sauvegarde d'ordre
- Ã‰dition des mÃ©tadonnÃ©es (titre, description, tags)
- DÃ©finition de photo principale
- Suppression avec confirmation et nettoyage Storage
- Support des formats multiples (JPEG, PNG, WebP)

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : Supabase Storage pour stockage
- IntÃ¨gre : avec optimisation d'images
- Partage : mÃ©dias avec portails publics
- Optimise : pour diffÃ©rentes rÃ©solutions

ğŸ’¡ **Tips Windsurf**
- Utiliser une bibliothÃ¨que de drag & drop robuste
- ImplÃ©menter la compression d'images cÃ´tÃ© client
- CrÃ©er des composants de galerie rÃ©utilisables
- GÃ©rer les Ã©tats de progression d'upload

---

### 12 - Calendrier de disponibilitÃ© et rÃ©servations

ğŸ¯ **But clair**
CrÃ©er l'interface calendrier pour visualiser et gÃ©rer les disponibilitÃ©s des lieux, avec intÃ©gration aux rÃ©servations du Module Ã‰vÃ©nements et gestion des pÃ©riodes de fermeture.

ğŸ§  **Contexte technique**
Cette interface complexe affiche les disponibilitÃ©s sur un calendrier interactif. Elle intÃ¨gre avec le Module Ã‰vÃ©nements pour les rÃ©servations, permet la gestion des fermetures, et fournit une vue d'ensemble claire des plannings.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Calendrier mensuel/hebdomadaire avec lÃ©gende des statuts
- Affichage des pÃ©riodes : ouvert, fermÃ©, rÃ©servÃ©, option
- CrÃ©ation de pÃ©riodes de fermeture par sÃ©lection
- Visualisation des rÃ©servations depuis Module Ã‰vÃ©nements
- Gestion des conflits et alertes
- Export des plannings en PDF
- Notifications de changements de disponibilitÃ©

âš™ï¸ **Interactions avec d'autres modules**
- IntÃ¨gre : avec Module Ã‰vÃ©nements pour rÃ©servations
- Utilise : RPC de gestion des disponibilitÃ©s
- Notifie : changements aux parties prenantes
- Synchronise : avec calendriers externes

ğŸ’¡ **Tips Windsurf**
- Utiliser une bibliothÃ¨que de calendrier performante
- ImplÃ©menter la gestion des conflits de dates
- CrÃ©er des vues multiples (mois, semaine, jour)
- Optimiser les requÃªtes de plages de dates

---

## ğŸ”§ Section 3 : FonctionnalitÃ©s Secondaires

### 13 - Gestion des donnÃ©es de rÃ©fÃ©rence

ğŸ¯ **But clair**
CrÃ©er les interfaces d'administration pour gÃ©rer les donnÃ©es de rÃ©fÃ©rence (types d'activitÃ©s, Ã©quipements, catÃ©gories, rÃ©gions) avec CRUD complet et validation de l'impact des modifications.

ğŸ§  **Contexte technique**
Ces interfaces permettent aux administrateurs de maintenir les rÃ©fÃ©rentiels mÃ©tier. Elles incluent la validation de l'impact des modifications (vÃ©rification des usages), la gestion des hiÃ©rarchies et l'import/export pour la maintenance en masse.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Interfaces CRUD pour chaque type de rÃ©fÃ©rentiel
- Validation de l'impact avant suppression
- Gestion des hiÃ©rarchies (catÃ©gories d'Ã©quipements)
- Import/export CSV pour maintenance en masse
- Recherche et filtrage dans les rÃ©fÃ©rentiels
- Historique des modifications
- Activation/dÃ©sactivation logique

âš™ï¸ **Interactions avec d'autres modules**
- Impacte : tous les modules utilisant les rÃ©fÃ©rentiels
- Valide : cohÃ©rence avec donnÃ©es existantes
- Synchronise : avec sources externes potentielles
- Notifie : changements aux utilisateurs concernÃ©s

ğŸ’¡ **Tips Windsurf**
- CrÃ©er des composants gÃ©nÃ©riques pour les rÃ©fÃ©rentiels
- ImplÃ©menter la validation d'impact avant modification
- Utiliser des modales pour l'Ã©dition rapide
- GÃ©rer les dÃ©pendances entre rÃ©fÃ©rentiels

---

### 14 - SystÃ¨me d'import/export et migration de donnÃ©es

ğŸ¯ **But clair**
ImplÃ©menter un systÃ¨me d'import/export pour les lieux avec validation des donnÃ©es, mapping des champs, gestion des erreurs et rapports dÃ©taillÃ©s.

ğŸ§  **Contexte technique**
Ce systÃ¨me facilite la migration de donnÃ©es existantes et la maintenance en masse. Il utilise des workers pour traiter de gros volumes, valide les donnÃ©es selon les schÃ©mas Zod, et fournit des rapports dÃ©taillÃ©s des opÃ©rations.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et services

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Import CSV/Excel avec mapping de colonnes
- Validation des donnÃ©es avec rapport d'erreurs
- PrÃ©visualisation avant import dÃ©finitif
- Export avec filtres et sÃ©lection de champs
- Gestion des doublons et conflits
- Traitement en arriÃ¨re-plan pour gros volumes
- Historique des imports/exports

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : schÃ©mas de validation Zod
- IntÃ¨gre : avec systÃ¨me d'audit pour traÃ§abilitÃ©
- Valide : cohÃ©rence avec donnÃ©es existantes
- Notifie : progression et rÃ©sultats

ğŸ’¡ **Tips Windsurf**
- Utiliser des Web Workers pour le traitement lourd
- ImplÃ©menter une validation robuste des donnÃ©es
- CrÃ©er des templates d'import standardisÃ©s
- GÃ©rer les opÃ©rations asynchrones avec feedback

---

### 15 - SystÃ¨me de duplication et templates de lieux

ğŸ¯ **But clair**
CrÃ©er un systÃ¨me de duplication de lieux et de crÃ©ation de templates pour accÃ©lÃ©rer la saisie de nouveaux lieux similaires, avec personnalisation et validation.

ğŸ§  **Contexte technique**
Ce systÃ¨me amÃ©liore l'efficacitÃ© de saisie en permettant la duplication de lieux existants et la crÃ©ation de templates rÃ©utilisables. Il gÃ¨re la copie des relations complexes et permet la personnalisation avant sauvegarde.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et services

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Duplication complÃ¨te avec espaces et Ã©quipements
- CrÃ©ation de templates depuis lieux existants
- BibliothÃ¨que de templates avec catÃ©gorisation
- Personnalisation avant crÃ©ation dÃ©finitive
- Gestion des rÃ©fÃ©rences et identifiants uniques
- Validation des donnÃ©es dupliquÃ©es
- Historique des duplications

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : RPC de duplication avec validation
- IntÃ¨gre : avec systÃ¨me de templates global
- Respecte : permissions et propriÃ©tÃ© des donnÃ©es
- Optimise : processus de crÃ©ation de lieux

ğŸ’¡ **Tips Windsurf**
- ImplÃ©menter une logique de copie profonde sÃ©curisÃ©e
- CrÃ©er des assistants de personnalisation
- GÃ©rer les rÃ©fÃ©rences et Ã©viter les conflits
- Optimiser les performances pour les duplications complexes

---

### 16 - Analytics et rapports sur les lieux

ğŸ¯ **But clair**
CrÃ©er un systÃ¨me d'analytics et de rapports pour analyser l'utilisation des lieux, les tendances de rÃ©servation, les performances et les mÃ©triques mÃ©tier.

ğŸ§  **Contexte technique**
Ce systÃ¨me fournit des insights mÃ©tier sur l'utilisation des lieux. Il utilise des requÃªtes optimisÃ©es pour calculer les mÃ©triques, des graphiques interactifs pour la visualisation, et des rapports automatisÃ©s pour le suivi.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et services d'analytics

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- MÃ©triques de performance : taux d'occupation, revenus, popularitÃ©
- Analyses gÃ©ographiques et par type de lieu
- Tendances saisonniÃ¨res et prÃ©visions
- Rapports de qualitÃ© des donnÃ©es
- Comparaisons entre lieux et pÃ©riodes
- Export des rapports en PDF/Excel
- Alertes sur mÃ©triques critiques

âš™ï¸ **Interactions avec d'autres modules**
- Consomme : donnÃ©es du Module Ã‰vÃ©nements
- IntÃ¨gre : avec Dashboard pour mÃ©triques globales
- Utilise : systÃ¨me de notifications pour alertes
- Fournit : donnÃ©es pour optimisation mÃ©tier

ğŸ’¡ **Tips Windsurf**
- Utiliser des requÃªtes optimisÃ©es pour les calculs
- ImplÃ©menter des graphiques interactifs performants
- CrÃ©er des rapports automatisÃ©s configurables
- Optimiser les performances avec mise en cache

---

## ğŸš€ Section 4 : Ã‰volutions Futures

### 17 - IntÃ©gration avec services de gÃ©olocalisation avancÃ©s

ğŸ¯ **But clair**
DÃ©velopper l'intÃ©gration avec des services de gÃ©olocalisation avancÃ©s pour l'enrichissement automatique des donnÃ©es, la validation d'adresses et la recherche gÃ©ographique.

ğŸ§  **Contexte technique**
Cette Ã©volution enrichit automatiquement les donnÃ©es de lieux avec des informations gÃ©ographiques prÃ©cises. Elle utilise des APIs externes (Google Maps, OpenStreetMap) pour la validation, l'enrichissement et la recherche gÃ©ospatiale avancÃ©e.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et services de gÃ©olocalisation

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Validation automatique des adresses saisies
- Enrichissement avec donnÃ©es POI (points d'intÃ©rÃªt)
- Calcul de distances et temps de trajet
- Recherche gÃ©ographique avec rayon
- IntÃ©gration de cartes interactives
- GÃ©ocodage inverse pour coordonnÃ©es
- Optimisation des itinÃ©raires pour visites

âš™ï¸ **Interactions avec d'autres modules**
- Enrichit : donnÃ©es de tous les modules gÃ©ographiques
- IntÃ¨gre : avec Module Ã‰vÃ©nements pour logistique
- Utilise : APIs externes de gÃ©olocalisation
- AmÃ©liore : recherche et recommandations

ğŸ’¡ **Tips Windsurf**
- Utiliser des APIs de gÃ©olocalisation fiables
- ImplÃ©menter la mise en cache pour optimiser les coÃ»ts
- CrÃ©er des composants de carte rÃ©utilisables
- GÃ©rer les limitations et quotas des APIs externes

---

### 18 - SystÃ¨me de recommandation intelligent

ğŸ¯ **But clair**
ImplÃ©menter un systÃ¨me de recommandation basÃ© sur l'IA pour suggÃ©rer des lieux adaptÃ©s selon les critÃ¨res des Ã©vÃ©nements, l'historique et les prÃ©fÃ©rences.

ğŸ§  **Contexte technique**
Ce systÃ¨me utilise des algorithmes de machine learning pour analyser les patterns de sÃ©lection et recommander des lieux optimaux. Il intÃ¨gre avec le module Console IA Automatisation pour les capacitÃ©s d'apprentissage.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et services IA

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Analyse des prÃ©fÃ©rences utilisateur et historique
- Recommandations basÃ©es sur critÃ¨res d'Ã©vÃ©nement
- Scoring de compatibilitÃ© lieu/Ã©vÃ©nement
- Apprentissage des patterns de sÃ©lection
- Suggestions alternatives et comparaisons
- Explications des recommandations
- AmÃ©lioration continue par feedback

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : Console IA Automatisation pour modÃ¨les
- Analyse : donnÃ©es du Module Ã‰vÃ©nements
- IntÃ¨gre : avec prÃ©fÃ©rences utilisateur
- AmÃ©liore : processus de sÃ©lection de lieux

ğŸ’¡ **Tips Windsurf**
- Utiliser des modÃ¨les de recommandation Ã©prouvÃ©s
- ImplÃ©menter l'apprentissage par renforcement
- CrÃ©er des interfaces de recommandation intuitives
- Mesurer et optimiser la pertinence des suggestions

---

### 19 - RÃ©alitÃ© virtuelle et visites immersives

ğŸ¯ **But clair**
DÃ©velopper des capacitÃ©s de rÃ©alitÃ© virtuelle pour proposer des visites immersives des lieux, avec intÃ©gration de photos 360Â°, modÃ¨les 3D et expÃ©riences interactives.

ğŸ§  **Contexte technique**
Cette fonctionnalitÃ© rÃ©volutionnaire permet aux clients de visiter virtuellement les lieux. Elle utilise des technologies WebXR, des photos 360Â°, et potentiellement des modÃ¨les 3D pour crÃ©er des expÃ©riences immersives.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants VR et services 3D

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Upload et gestion de photos 360Â°
- CrÃ©ation de parcours de visite virtuels
- IntÃ©gration de hotspots informatifs
- Support des casques VR et navigation web
- Mesure de l'engagement et analytics
- Personnalisation des visites par Ã©vÃ©nement
- Partage et intÃ©gration dans portails

âš™ï¸ **Interactions avec d'autres modules**
- Ã‰tend : systÃ¨me de gestion des mÃ©dias
- IntÃ¨gre : avec portails client pour expÃ©rience
- Utilise : donnÃ©es de lieux pour contextualisation
- AmÃ©liore : processus de sÃ©lection et validation

ğŸ’¡ **Tips Windsurf**
- Utiliser des frameworks WebXR standards
- Optimiser les performances pour diffÃ©rents appareils
- CrÃ©er des expÃ©riences progressives (2D â†’ 3D â†’ VR)
- GÃ©rer les fichiers volumineux efficacement

---

### 20 - Blockchain et certification des lieux

ğŸ¯ **But clair**
Explorer l'utilisation de la blockchain pour certifier l'authenticitÃ© des informations de lieux, crÃ©er des NFTs de lieux uniques et assurer la traÃ§abilitÃ© des modifications.

ğŸ§  **Contexte technique**
Cette fonctionnalitÃ© expÃ©rimentale utilise la blockchain pour crÃ©er une certification immuable des lieux et de leurs caractÃ©ristiques. Elle permet la crÃ©ation de NFTs pour des lieux exclusifs et assure la traÃ§abilitÃ© complÃ¨te.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants blockchain et smart contracts

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Certification blockchain des donnÃ©es de lieu
- CrÃ©ation de NFTs pour lieux exclusifs
- TraÃ§abilitÃ© immuable des modifications
- VÃ©rification cryptographique des informations
- Marketplace de lieux certifiÃ©s
- Smart contracts pour rÃ©servations
- Tokens de rÃ©putation et qualitÃ©

âš™ï¸ **Interactions avec d'autres modules**
- ComplÃ¨te : systÃ¨me d'audit traditionnel
- IntÃ¨gre : avec Console IA pour validation
- Ã‰tend : vers marketplace dÃ©centralisÃ©e
- Assure : confiance et transparence

ğŸ’¡ **Tips Windsurf**
- Commencer par des preuves de concept simples
- Utiliser des solutions blockchain Ã©prouvÃ©es
- Maintenir la compatibilitÃ© avec systÃ¨mes existants
- Ã‰valuer les coÃ»ts et bÃ©nÃ©fices rÃ©guliÃ¨rement

---

### 21 - IA gÃ©nÃ©rative pour descriptions et contenus

ğŸ¯ **But clair**
IntÃ©grer l'IA gÃ©nÃ©rative pour crÃ©er automatiquement des descriptions attractives, gÃ©nÃ©rer du contenu marketing et optimiser les textes selon les audiences cibles.

ğŸ§  **Contexte technique**
Cette fonctionnalitÃ© utilise des modÃ¨les de langage avancÃ©s pour gÃ©nÃ©rer automatiquement du contenu de qualitÃ©. Elle s'intÃ¨gre avec le module Console IA Automatisation pour accÃ©der aux capacitÃ©s gÃ©nÃ©ratives.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants IA gÃ©nÃ©rative

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- GÃ©nÃ©ration automatique de descriptions attractives
- Adaptation du contenu selon l'audience cible
- Optimisation SEO des textes gÃ©nÃ©rÃ©s
- Traduction automatique multilingue
- GÃ©nÃ©ration de contenus marketing personnalisÃ©s
- Suggestions d'amÃ©lioration de contenu existant
- A/B testing des descriptions gÃ©nÃ©rÃ©es

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : Console IA Automatisation pour modÃ¨les
- AmÃ©liore : contenu pour portails publics
- IntÃ¨gre : avec Module Marketing
- Optimise : visibilitÃ© et attractivitÃ© des lieux

ğŸ’¡ **Tips Windsurf**
- Utiliser des prompts optimisÃ©s pour le secteur mariage
- ImplÃ©menter la validation humaine des contenus
- CrÃ©er des templates de gÃ©nÃ©ration personnalisables
- Mesurer l'impact sur l'engagement et conversions

---

### 22 - IntÃ©gration IoT et capteurs intelligents

ğŸ¯ **But clair**
DÃ©velopper l'intÃ©gration avec des capteurs IoT pour monitorer en temps rÃ©el les conditions des lieux (tempÃ©rature, humiditÃ©, occupation) et automatiser la gestion.

ğŸ§  **Contexte technique**
Cette Ã©volution connecte les lieux physiques au systÃ¨me numÃ©rique via des capteurs IoT. Elle permet le monitoring en temps rÃ©el, l'automatisation des Ã©quipements et l'optimisation des conditions pour les Ã©vÃ©nements.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants IoT et services de monitoring

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- IntÃ©gration de capteurs de tempÃ©rature, humiditÃ©, CO2
- Monitoring de l'occupation et flux de personnes
- Automatisation de l'Ã©clairage et climatisation
- Alertes en temps rÃ©el sur conditions anormales
- Historique et analytics des donnÃ©es environnementales
- Optimisation Ã©nergÃ©tique automatique
- IntÃ©gration avec systÃ¨mes de sÃ©curitÃ©

âš™ï¸ **Interactions avec d'autres modules**
- IntÃ¨gre : avec Module Ã‰vÃ©nements pour optimisation
- Utilise : Console IA pour analyse prÃ©dictive
- Alerte : via systÃ¨me de notifications
- Optimise : conditions pour satisfaction client

ğŸ’¡ **Tips Windsurf**
- Utiliser des protocoles IoT standards (MQTT, LoRaWAN)
- ImplÃ©menter la sÃ©curitÃ© des communications IoT
- CrÃ©er des dashboards de monitoring temps rÃ©el
- GÃ©rer la scalabilitÃ© pour de nombreux capteurs

---

## ğŸ“Š Matrice de PrioritÃ©s et DÃ©pendances

| Prompt | PrioritÃ© | DÃ©pendances | DurÃ©e EstimÃ©e | ComplexitÃ© |
|--------|----------|-------------|---------------|------------|
| 01-06  | P0       | Console Admin, Monorepo | 4-5 jours     | Ã‰levÃ©e     |
| 07-12  | P1       | 01-06       | 6-8 jours     | Ã‰levÃ©e     |
| 13-16  | P1       | 07-12       | 4-5 jours     | Moyenne    |
| 17-22  | P2-P3    | 13-16       | 3-5 semaines  | TrÃ¨s Ã©levÃ©e |

---

## ğŸ”„ Ordre d'ExÃ©cution RecommandÃ©

### **Phase 1 - Infrastructure Lieux (Semaines 1-2)**
Prompts 01-06 : Tables, RLS, RPC, Storage

### **Phase 2 - Interfaces Principales (Semaines 3-4)**
Prompts 07-12 : Liste, formulaires, dÃ©tails, espaces, mÃ©dias, calendrier

### **Phase 3 - FonctionnalitÃ©s AvancÃ©es (Semaine 5)**
Prompts 13-16 : RÃ©fÃ©rentiels, import/export, templates, analytics

### **Phase 4 - Ã‰volutions Futures (Versions ultÃ©rieures)**
Prompts 17-22 : GÃ©olocalisation, IA, VR, Blockchain, IoT

---

## âš ï¸ Points d'Attention Critiques

### **ComplexitÃ© des Relations**
- Gestion des relations complexes entre lieux, espaces, Ã©quipements et activitÃ©s
- Maintien de la cohÃ©rence des donnÃ©es lors des modifications
- Performance des requÃªtes avec jointures multiples
- Validation de l'intÃ©gritÃ© rÃ©fÃ©rentielle

### **Gestion des MÃ©dias**
- Optimisation du stockage et de la diffusion des images
- Gestion des quotas et limitations de Supabase Storage
- Performance de l'upload et du traitement d'images
- SÃ©curitÃ© et contrÃ´le d'accÃ¨s aux mÃ©dias

### **Performance et ScalabilitÃ©**
- Optimisation des requÃªtes de recherche et filtrage
- Gestion de la pagination pour de gros volumes
- Cache intelligent pour les donnÃ©es frÃ©quemment consultÃ©es
- Index optimisÃ©s pour les patterns de requÃªte

### **IntÃ©gration Inter-Modules**
- Coordination avec Module Ã‰vÃ©nements pour les rÃ©servations
- Partage des donnÃ©es avec les portails client et vendor
- Synchronisation des disponibilitÃ©s en temps rÃ©el
- Maintien de la cohÃ©rence des rÃ©fÃ©rentiels partagÃ©s

---

*Document gÃ©nÃ©rÃ© par Manus AI - Expert en transformation de cahiers des charges pour Windsurf*

