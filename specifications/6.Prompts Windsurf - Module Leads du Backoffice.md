# Prompts Windsurf - Module Leads du Backoffice

## ğŸ“‹ Informations du Module

- **Module** : Gestion des Leads (Backoffice)
- **Identifiant technique** : `backoffice_leads`
- **Version** : 1.0.0
- **Application** : Backoffice (`apps/backoffice`)
- **PrioritÃ©** : P1 (Haute - Module commercial fondamental)
- **DÃ©pendances** : Module Initialisation Monorepo, Console Admin, Dashboard, Module Lieux
- **SchÃ©ma DB** : `bo` (tables leads et commercial)

---

## ğŸ¯ Vue d'Ensemble du Module

Le module Leads du Backoffice constitue le moteur commercial de l'ERP Wedding Collection. Il centralise la gestion complÃ¨te du processus commercial depuis la capture des prospects jusqu'Ã  leur conversion en clients, avec scoring automatique, suivi des interactions, workflows de qualification et intÃ©grations avec l'Ã©cosystÃ¨me complet.

Ce module s'intÃ¨gre dans l'application `apps/backoffice` via le bouton "Leads" de la sidebar. Il utilise le schÃ©ma `bo` de Supabase pour les donnÃ©es commerciales spÃ©cifiques et s'interface avec le schÃ©ma `shared` pour les intÃ©grations inter-modules.

---

## ğŸš€ Section 1 : Initialisation

### 01 - CrÃ©ation des tables principales et types Ã©numÃ©rÃ©s

ğŸ¯ **But clair**
CrÃ©er les tables principales du module Leads dans le schÃ©ma `bo` avec les types Ã©numÃ©rÃ©s commerciaux, en respectant les conventions Supabase du projet et en assurant l'intÃ©gritÃ© rÃ©fÃ©rentielle avec les autres modules.

ğŸ§  **Contexte technique**
Ces tables constituent le cÅ“ur du processus commercial. Elles incluent la table principale `leads` avec toutes les informations de qualification, les tables d'interactions et de tÃ¢ches pour le suivi, ainsi que les types Ã©numÃ©rÃ©s pour standardiser les valeurs commerciales. La structure doit supporter la complexitÃ© du cycle de vente tout en restant performante.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Migration Supabase

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- CrÃ©ation des types Ã©numÃ©rÃ©s : interaction_type_enum, status_category_enum, task_status_enum, task_priority_enum
- Table leads avec informations complÃ¨tes (contact, qualification, Ã©vÃ©nement, suivi)
- Tables liÃ©es : lead_interactions, tasks avec relations appropriÃ©es
- Contraintes d'intÃ©gritÃ© et validation (budgets positifs, dates cohÃ©rentes)
- Champs standards : id, created_at, updated_at, created_by, updated_by, deleted_at
- Support RGPD avec champs de consentement

âš™ï¸ **Interactions avec d'autres modules**
- RÃ©fÃ©rence : shared.user_profiles (Console Admin)
- IntÃ¨gre : avec shared.clients et shared.evenements pour conversion
- Base pour : Dashboard (mÃ©triques commerciales)
- Utilise : systÃ¨me d'audit global

ğŸ’¡ **Tips Windsurf**
- Utiliser le MCP Supabase pour exÃ©cuter directement les migrations
- CrÃ©er les types Ã©numÃ©rÃ©s avant les tables pour Ã©viter les erreurs
- Valider les contraintes CHECK avec des exemples mÃ©tier concrets
- PrÃ©voir l'extensibilitÃ© avec des champs JSONB pour mÃ©tadonnÃ©es commerciales

---

### 02 - CrÃ©ation des tables de rÃ©fÃ©rence et liaisons

ğŸ¯ **But clair**
CrÃ©er les tables de rÃ©fÃ©rence commerciales (lead_statuses, lead_sources, lead_tags, lead_services) et les tables de liaison (lead_tag_links, lead_service_links) avec leurs relations et mÃ©tadonnÃ©es.

ğŸ§  **Contexte technique**
Ces tables de rÃ©fÃ©rence standardisent les donnÃ©es commerciales et permettent une gestion cohÃ©rente des statuts, sources, tags et services d'intÃ©rÃªt. Les tables de liaison implÃ©mentent les relations many-to-many pour la segmentation et la qualification avancÃ©e des leads.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Migration Supabase

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Tables de rÃ©fÃ©rence : lead_statuses (avec catÃ©gories et couleurs), lead_sources, lead_tags, lead_services
- Tables de liaison : lead_tag_links, lead_service_links avec contraintes d'unicitÃ©
- Gestion des ordres d'affichage et des couleurs pour l'interface
- Support des statuts finaux et des catÃ©gories (open, won, lost)
- Champs is_active pour dÃ©sactivation logique
- MÃ©tadonnÃ©es extensibles pour personnalisation

âš™ï¸ **Interactions avec d'autres modules**
- PartagÃ© : avec Module Dashboard pour mÃ©triques par statut/source
- RÃ©fÃ©rencÃ© : par Module Ã‰vÃ©nements pour services demandÃ©s
- Ã‰tendu : par Console IA pour scoring automatique
- SynchronisÃ© : avec donnÃ©es de campagnes marketing

ğŸ’¡ **Tips Windsurf**
- Utiliser des contraintes UNIQUE pour Ã©viter les doublons dans les rÃ©fÃ©rentiels
- PrÃ©voir des index sur les colonnes de recherche et filtrage frÃ©quents
- ImplÃ©menter des triggers pour l'audit automatique des changements
- Structurer les couleurs en format hexadÃ©cimal pour l'interface

---

### 03 - Configuration des index et optimisations de performance

ğŸ¯ **But clair**
CrÃ©er tous les index optimisÃ©s pour les requÃªtes frÃ©quentes du module Leads, incluant la recherche de contacts, les filtres commerciaux et les jointures avec les tables de rÃ©fÃ©rence.

ğŸ§  **Contexte technique**
Les index sont cruciaux pour les performances car le module sera intensivement utilisÃ© pour la recherche, le filtrage et le suivi des leads. L'optimisation doit couvrir les recherches par contact (email, tÃ©lÃ©phone), les filtres commerciaux (statut, assignation, date) et les jointures frÃ©quentes.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Migration Supabase

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Index sur colonnes de recherche : email_1, phone_1, noms
- Index composites pour filtres : status_id, assigned_user_id, source_id
- Index sur dates : event_date_planned, last_activity_date, created_at
- Index sur clÃ©s Ã©trangÃ¨res pour jointures optimisÃ©es
- Index partiels pour donnÃ©es actives (WHERE deleted_at IS NULL)
- Analyse des performances avec EXPLAIN pour validation

âš™ï¸ **Interactions avec d'autres modules**
- Optimise : requÃªtes depuis Dashboard pour mÃ©triques
- AmÃ©liore : recherches de doublons lors de la crÃ©ation
- Facilite : intÃ©grations avec Module Clients/Ã‰vÃ©nements
- Supporte : rapports et analytics commerciaux

ğŸ’¡ **Tips Windsurf**
- Analyser les patterns de requÃªtes commerciales avant crÃ©ation des index
- Utiliser EXPLAIN ANALYZE pour valider les gains de performance
- CrÃ©er des index partiels pour optimiser l'espace disque
- Monitorer l'utilisation des index en production avec pg_stat_user_indexes

---

### 04 - Configuration des politiques RLS et sÃ©curitÃ© commerciale

ğŸ¯ **But clair**
Configurer les politiques Row Level Security (RLS) pour toutes les tables du module avec des rÃ¨gles granulaires selon les rÃ´les commerciaux, en assurant la confidentialitÃ© des donnÃ©es prospects.

ğŸ§  **Contexte technique**
Les politiques RLS sont critiques car les donnÃ©es de leads sont sensibles commercialement. Elles doivent permettre l'accÃ¨s selon les rÃ´les (admin, manager, commercial) tout en respectant les assignations et la hiÃ©rarchie commerciale. La sÃ©curitÃ© doit aussi intÃ©grer les aspects RGPD.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Politiques RLS Supabase

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- RLS activÃ©e sur toutes les tables sensibles du schÃ©ma bo
- AccÃ¨s complet pour admin_erp et manager_commercial
- AccÃ¨s restreint pour commercial (leads assignÃ©s ou crÃ©Ã©s par eux)
- AccÃ¨s limitÃ© pour wedding_planner (leads convertis liÃ©s Ã  leurs Ã©vÃ©nements)
- Politiques spÃ©cifiques pour interactions et tÃ¢ches
- Respect des contraintes RGPD dans les politiques
- Audit automatique des accÃ¨s sensibles

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : systÃ¨me de permissions Console Admin
- IntÃ¨gre : avec auth.uid() et rÃ´les utilisateur
- Respecte : hiÃ©rarchie commerciale dÃ©finie
- ProtÃ¨ge : donnÃ©es sensibles inter-applications

ğŸ’¡ **Tips Windsurf**
- Tester les politiques avec diffÃ©rents rÃ´les commerciaux
- Utiliser des fonctions helper pour la hiÃ©rarchie commerciale
- PrÃ©voir des politiques d'urgence pour maintenance
- Documenter chaque politique avec des exemples de cas d'usage

---

### 05 - Fonctions RPC pour la gestion commerciale des leads

ğŸ¯ **But clair**
CrÃ©er les fonctions RPC Supabase pour la gestion complÃ¨te des leads : CRUD optimisÃ©, dÃ©tection de doublons, scoring, conversion et validation mÃ©tier avec audit automatique.

ğŸ§  **Contexte technique**
Ces fonctions RPC centralisent la logique mÃ©tier complexe du processus commercial. Elles intÃ¨grent la validation des donnÃ©es, la dÃ©tection de doublons, le calcul de scores, la gestion des conversions et l'audit automatique. Elles constituent l'API backend du module commercial.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Fonctions RPC Supabase

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- `rpc_create_lead()` : crÃ©ation avec dÃ©tection de doublons et validation
- `rpc_update_lead()` : modification avec historique des changements
- `rpc_get_leads_list()` : recherche avancÃ©e avec filtres et pagination
- `rpc_get_lead_details()` : rÃ©cupÃ©ration complÃ¨te avec relations
- `rpc_convert_lead()` : conversion transactionnelle vers client/Ã©vÃ©nement
- `rpc_calculate_lead_score()` : scoring basÃ© sur critÃ¨res mÃ©tier
- Validation des donnÃ©es commerciales (budgets, dates, contacts)
- Audit automatique de toutes les actions commerciales critiques

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : Console Admin pour vÃ©rification permissions
- IntÃ¨gre : avec Module Clients pour conversion
- Fournit : API pour Module Ã‰vÃ©nements
- Consomme : Module Lieux pour qualification

ğŸ’¡ **Tips Windsurf**
- Utiliser SECURITY DEFINER avec validation stricte des permissions
- ImplÃ©menter la logique de dÃ©tection de doublons cÃ´tÃ© serveur
- GÃ©rer les transactions pour maintenir la cohÃ©rence lors des conversions
- CrÃ©er des fonctions helper pour le calcul de scores personnalisables

---

### 06 - Configuration des triggers et automatisations

ğŸ¯ **But clair**
Configurer les triggers PostgreSQL pour l'automatisation des processus commerciaux : mise Ã  jour des dates d'activitÃ©, notifications, scoring automatique et synchronisation inter-modules.

ğŸ§  **Contexte technique**
Les triggers automatisent les processus critiques du cycle commercial. Ils maintiennent la cohÃ©rence des donnÃ©es (dates d'activitÃ©), dÃ©clenchent les notifications, calculent les scores et synchronisent avec les autres modules. Ils sont essentiels pour l'efficacitÃ© opÃ©rationnelle.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.sql` - Triggers PostgreSQL

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Trigger de mise Ã  jour automatique de last_activity_date
- Trigger de notification lors de changement de statut critique
- Trigger de calcul de score automatique lors de modification
- Trigger de synchronisation avec shared.notifications
- Trigger d'audit pour traÃ§abilitÃ© des actions commerciales
- Trigger de validation des donnÃ©es avant insertion/modification
- Gestion des erreurs et rollback en cas de problÃ¨me

âš™ï¸ **Interactions avec d'autres modules**
- Notifie : via shared.notifications pour Dashboard
- Synchronise : avec Module Clients lors des conversions
- IntÃ¨gre : avec systÃ¨me d'audit global
- DÃ©clenche : workflows Console IA si configurÃ©s

ğŸ’¡ **Tips Windsurf**
- Utiliser des triggers AFTER pour Ã©viter les conflits
- ImplÃ©menter une gestion d'erreur robuste dans les triggers
- PrÃ©voir des mÃ©canismes de dÃ©sactivation pour maintenance
- Tester les triggers avec des volumes de donnÃ©es rÃ©alistes

---

## ğŸ—ï¸ Section 2 : FonctionnalitÃ©s Principales

### 07 - Interface de liste et recherche des leads

ğŸ¯ **But clair**
CrÃ©er l'interface principale de liste des leads avec recherche avancÃ©e, filtres multiples, tri, pagination et actions en lot, en utilisant les composants ShadCN UI pour la cohÃ©rence et l'efficacitÃ© commerciale.

ğŸ§  **Contexte technique**
Cette interface constitue le cockpit commercial principal du module. Elle doit gÃ©rer efficacement de gros volumes de leads avec une UX optimisÃ©e pour les commerciaux. L'implÃ©mentation utilise React Hook Form pour les filtres, TanStack Query pour la gestion des donnÃ©es et des composants optimisÃ©s pour les performances.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Liste paginÃ©e avec 25 Ã©lÃ©ments par page par dÃ©faut
- Recherche textuelle en temps rÃ©el avec debouncing (nom, email, tÃ©lÃ©phone)
- Filtres commerciaux : statut, source, assignation, date de crÃ©ation, budget
- Tri : nom, date crÃ©ation, derniÃ¨re activitÃ©, score, budget
- Actions en lot : assignation, changement de statut, export
- Indicateurs visuels : score, urgence, derniÃ¨re activitÃ©
- Navigation rapide vers dÃ©tail et Ã©dition

âš™ï¸ **Interactions avec d'autres modules**
- Consomme : RPC de recherche et filtrage des leads
- Utilise : composants shared-ui pour cohÃ©rence
- IntÃ¨gre : avec systÃ¨me de permissions pour actions
- Navigue : vers formulaires de crÃ©ation/Ã©dition

ğŸ’¡ **Tips Windsurf**
- Utiliser React Hook Form pour la gestion des filtres complexes
- ImplÃ©menter la virtualisation pour les grandes listes de leads
- CrÃ©er des composants rÃ©utilisables pour les cartes de lead
- Optimiser les requÃªtes avec mise en cache intelligente et invalidation

---

### 08 - Vue Kanban pour le pipeline commercial

ğŸ¯ **But clair**
CrÃ©er la vue Kanban des leads organisÃ©e par statut avec drag & drop pour le changement de statut, mÃ©triques par colonne et actions contextuelles pour optimiser le suivi du pipeline commercial.

ğŸ§  **Contexte technique**
Cette vue Kanban est essentielle pour la gestion visuelle du pipeline commercial. Elle utilise une bibliothÃ¨que de drag & drop performante, gÃ¨re les Ã©tats de transition et fournit une vue d'ensemble claire de la rÃ©partition des leads par statut avec des mÃ©triques en temps rÃ©el.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Colonnes dynamiques basÃ©es sur les statuts actifs
- Drag & drop fluide avec validation des transitions autorisÃ©es
- MÃ©triques par colonne : nombre de leads, valeur totale estimÃ©e
- Actions contextuelles : Ã©dition rapide, assignation, ajout d'interaction
- Filtres applicables Ã  la vue Kanban (assignation, source, pÃ©riode)
- Indicateurs visuels : prioritÃ©, score, dÃ©lai depuis derniÃ¨re activitÃ©
- Actualisation en temps rÃ©el des changements

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : RPC de mise Ã  jour de statut des leads
- IntÃ¨gre : avec systÃ¨me de permissions pour drag & drop
- Synchronise : avec vue liste pour cohÃ©rence des donnÃ©es
- Notifie : changements via systÃ¨me de notifications

ğŸ’¡ **Tips Windsurf**
- Utiliser @dnd-kit/core pour un drag & drop performant et accessible
- ImplÃ©menter des animations fluides pour les transitions
- GÃ©rer les Ã©tats de chargement pendant les mises Ã  jour
- CrÃ©er des composants de carte de lead optimisÃ©s pour le Kanban

---

### 09 - Formulaire de crÃ©ation et Ã©dition de lead

ğŸ¯ **But clair**
CrÃ©er le formulaire complet de crÃ©ation et Ã©dition de lead avec validation Zod, dÃ©tection de doublons en temps rÃ©el, sauvegarde automatique et interface intuitive pour toutes les informations commerciales.

ğŸ§  **Contexte technique**
Ce formulaire complexe gÃ¨re de nombreux champs commerciaux avec des validations mÃ©tier spÃ©cifiques. Il utilise une approche multi-sections pour amÃ©liorer l'UX, Zod pour la validation cÃ´tÃ© client, et une logique de dÃ©tection de doublons en temps rÃ©el pour Ã©viter les duplicatas.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et schÃ©mas de validation

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Sections organisÃ©es : Contact, Qualification, Ã‰vÃ©nement, Notes
- Validation Zod en temps rÃ©el avec messages d'erreur contextuels
- DÃ©tection de doublons automatique sur email et tÃ©lÃ©phone+nom
- Sauvegarde automatique en brouillon toutes les 30 secondes
- SÃ©lection multiple pour tags et services d'intÃ©rÃªt
- Calcul automatique du score basÃ© sur la complÃ©tude
- Gestion du consentement RGPD obligatoire

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : RPC de crÃ©ation/modification avec dÃ©tection doublons
- IntÃ¨gre : avec rÃ©fÃ©rentiels (statuts, sources, tags, services)
- Valide : donnÃ©es avec rÃ¨gles mÃ©tier commerciales
- Sauvegarde : avec permissions appropriÃ©es selon le rÃ´le

ğŸ’¡ **Tips Windsurf**
- Utiliser React Hook Form avec Zod pour validation robuste
- ImplÃ©menter un systÃ¨me de sauvegarde automatique avec feedback visuel
- CrÃ©er des composants de champ rÃ©utilisables pour les donnÃ©es commerciales
- GÃ©rer les Ã©tats de chargement et d'erreur avec UX optimisÃ©e

---

### 10 - Page de dÃ©tail et fiche complÃ¨te du lead

ğŸ¯ **But clair**
CrÃ©er la page de dÃ©tail complÃ¨te d'un lead avec toutes ses informations, historique des interactions, tÃ¢ches associÃ©es, et actions contextuelles, organisÃ©e en onglets pour une navigation intuitive.

ğŸ§  **Contexte technique**
Cette page complexe agrÃ¨ge toutes les donnÃ©es liÃ©es Ã  un lead commercial. Elle utilise des onglets pour organiser l'information, un lazy loading pour les donnÃ©es volumineuses, et des composants optimisÃ©s pour gÃ©rer les relations complexes entre entitÃ©s commerciales.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Vue d'ensemble avec informations principales et score
- Onglets : DÃ©tails, Interactions, TÃ¢ches, Devis, Historique
- Timeline des interactions avec filtres par type
- Liste des tÃ¢ches avec statuts et Ã©chÃ©ances
- Actions contextuelles : Ã‰diter, Convertir, Assigner, Dupliquer
- Indicateurs visuels : score, urgence, derniÃ¨re activitÃ©
- Historique complet des modifications avec dÃ©tails

âš™ï¸ **Interactions avec d'autres modules**
- Consomme : RPC de rÃ©cupÃ©ration dÃ©taillÃ©e du lead
- Affiche : donnÃ©es depuis Module Devis (devis associÃ©s)
- IntÃ¨gre : avec systÃ¨me de permissions pour actions
- Navigue : vers Module Clients/Ã‰vÃ©nements pour conversion

ğŸ’¡ **Tips Windsurf**
- Utiliser des onglets avec lazy loading pour optimiser les performances
- ImplÃ©menter une timeline interactive pour les interactions
- CrÃ©er des composants modulaires pour chaque section d'information
- Optimiser les requÃªtes avec des jointures efficaces et mise en cache

---

### 11 - Gestion des interactions et suivi commercial

ğŸ¯ **But clair**
CrÃ©er l'interface de gestion des interactions commerciales avec crÃ©ation rapide, historique dÃ©taillÃ©, filtres par type et intÃ©gration avec les tÃ¢ches pour un suivi commercial optimal.

ğŸ§  **Contexte technique**
Cette interface gÃ¨re la complexitÃ© du suivi commercial avec ses multiples types d'interactions. Elle utilise des formulaires modaux pour la saisie rapide, une timeline pour l'affichage chronologique, et des intÃ©grations avec le systÃ¨me de tÃ¢ches pour le suivi des actions.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Formulaire rapide d'ajout d'interaction avec types prÃ©dÃ©finis
- Timeline chronologique avec filtres par type et pÃ©riode
- Ã‰dition en ligne des interactions existantes
- Liaison automatique avec tÃ¢ches crÃ©Ã©es depuis les interactions
- Calcul automatique de la durÃ©e pour les appels et rÃ©unions
- Notifications automatiques des interactions importantes
- Export des interactions pour reporting

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : RPC de gestion des interactions
- IntÃ¨gre : avec systÃ¨me de tÃ¢ches pour suivi
- DÃ©clenche : notifications via systÃ¨me global
- Met Ã  jour : automatiquement last_activity_date du lead

ğŸ’¡ **Tips Windsurf**
- Utiliser des modales pour la saisie rapide d'interactions
- ImplÃ©menter une timeline avec scroll virtuel pour les performances
- CrÃ©er des templates d'interaction pour accÃ©lÃ©rer la saisie
- IntÃ©grer des raccourcis clavier pour l'efficacitÃ© commerciale

---

### 12 - SystÃ¨me de tÃ¢ches et suivi des actions

ğŸ¯ **But clair**
CrÃ©er l'interface de gestion des tÃ¢ches commerciales avec crÃ©ation, assignation, suivi des Ã©chÃ©ances, notifications et intÃ©gration avec le calendrier pour optimiser l'organisation commerciale.

ğŸ§  **Contexte technique**
Cette interface gÃ¨re les tÃ¢ches commerciales avec leurs prioritÃ©s, Ã©chÃ©ances et assignations. Elle intÃ¨gre avec le systÃ¨me de notifications pour les rappels, fournit des vues par Ã©chÃ©ance et par assignÃ©, et permet la crÃ©ation de tÃ¢ches depuis les interactions.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx` - Composants React

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Liste des tÃ¢ches avec filtres par statut, prioritÃ©, Ã©chÃ©ance, assignÃ©
- CrÃ©ation rapide de tÃ¢ches avec assignation et Ã©chÃ©ance
- Vue calendrier des tÃ¢ches avec drag & drop pour reprogrammation
- Notifications automatiques des Ã©chÃ©ances approchantes
- Marquage rapide comme terminÃ© avec commentaires
- Statistiques des tÃ¢ches par utilisateur et par pÃ©riode
- CrÃ©ation de tÃ¢ches rÃ©currentes pour le suivi rÃ©gulier

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : RPC de gestion des tÃ¢ches commerciales
- IntÃ¨gre : avec systÃ¨me de notifications pour rappels
- Synchronise : avec calendrier personnel des utilisateurs
- Lie : aux interactions pour traÃ§abilitÃ© complÃ¨te

ğŸ’¡ **Tips Windsurf**
- Utiliser une bibliothÃ¨que de calendrier pour la vue temporelle
- ImplÃ©menter des notifications push pour les Ã©chÃ©ances critiques
- CrÃ©er des templates de tÃ¢ches pour les processus rÃ©currents
- Optimiser les requÃªtes de tÃ¢ches avec index sur les dates

---

## ğŸ”§ Section 3 : FonctionnalitÃ©s Secondaires

### 13 - SystÃ¨me de scoring et qualification automatique

ğŸ¯ **But clair**
ImplÃ©menter un systÃ¨me de scoring des leads basÃ© sur des critÃ¨res configurables (complÃ©tude, budget, interactions, timing) avec calcul automatique et interface de configuration pour optimiser la qualification commerciale.

ğŸ§  **Contexte technique**
Ce systÃ¨me Ã©value automatiquement la qualitÃ© des leads selon des critÃ¨res mÃ©tier. Il utilise des algorithmes de scoring configurables, se met Ã  jour en temps rÃ©el lors des modifications, et fournit des insights pour prioriser les actions commerciales.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et services de scoring

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Configuration flexible des critÃ¨res de scoring et pondÃ©rations
- Calcul automatique du score lors des modifications de lead
- Visualisation du score avec dÃ©tail des composants
- Seuils configurables pour qualification automatique
- Historique de l'Ã©volution du score dans le temps
- Rapports de distribution des scores pour analyse
- Suggestions d'actions pour amÃ©liorer le score

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : donnÃ©es de toutes les interactions et modifications
- IntÃ¨gre : avec Console IA pour scoring avancÃ©
- Alimente : Dashboard avec mÃ©triques de qualitÃ©
- Influence : prioritÃ©s d'affichage dans les listes

ğŸ’¡ **Tips Windsurf**
- CrÃ©er des algorithmes de scoring modulaires et configurables
- ImplÃ©menter la mise Ã  jour en temps rÃ©el avec optimisation
- Utiliser des graphiques pour visualiser l'Ã©volution des scores
- Permettre l'ajustement des algorithmes selon les retours terrain

---

### 14 - Gestion des doublons et fusion de leads

ğŸ¯ **But clair**
CrÃ©er un systÃ¨me de dÃ©tection et de gestion des doublons avec interface de comparaison, fusion assistÃ©e et rÃ¨gles de dÃ©duplication pour maintenir la qualitÃ© de la base de donnÃ©es commerciale.

ğŸ§  **Contexte technique**
Ce systÃ¨me identifie les doublons potentiels selon plusieurs critÃ¨res (email, tÃ©lÃ©phone+nom, adresse). Il fournit une interface de comparaison visuelle, assiste la fusion des donnÃ©es et maintient l'historique pour traÃ§abilitÃ©.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et services de dÃ©duplication

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- DÃ©tection automatique de doublons avec scoring de similaritÃ©
- Interface de comparaison cÃ´te-Ã -cÃ´te des leads similaires
- Assistant de fusion avec sÃ©lection des meilleures donnÃ©es
- RÃ¨gles configurables de dÃ©duplication automatique
- Historique des fusions pour traÃ§abilitÃ© et audit
- Notifications des doublons dÃ©tectÃ©s aux responsables
- Rapports de qualitÃ© des donnÃ©es avec mÃ©triques de doublons

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : algorithmes de dÃ©tection lors de la crÃ©ation/modification
- IntÃ¨gre : avec systÃ¨me d'audit pour traÃ§abilitÃ© des fusions
- Notifie : via systÃ¨me de notifications les doublons critiques
- Maintient : cohÃ©rence avec interactions et tÃ¢ches liÃ©es

ğŸ’¡ **Tips Windsurf**
- Utiliser des algorithmes de similaritÃ© robustes (Levenshtein, etc.)
- ImplÃ©menter une interface de comparaison intuitive et visuelle
- CrÃ©er des rÃ¨gles de fusion intelligentes avec validation
- Maintenir l'intÃ©gritÃ© rÃ©fÃ©rentielle lors des fusions

---

### 15 - SystÃ¨me d'import/export et migration de donnÃ©es

ğŸ¯ **But clair**
ImplÃ©menter un systÃ¨me d'import/export pour les leads avec validation des donnÃ©es, mapping des champs, gestion des erreurs et rapports dÃ©taillÃ©s pour faciliter les migrations et la maintenance.

ğŸ§  **Contexte technique**
Ce systÃ¨me facilite l'intÃ©gration avec des sources externes et la maintenance en masse. Il utilise des workers pour traiter de gros volumes, valide les donnÃ©es selon les schÃ©mas commerciaux, et fournit des rapports dÃ©taillÃ©s des opÃ©rations.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et services d'import/export

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Import CSV/Excel avec mapping automatique et manuel des colonnes
- Validation des donnÃ©es avec rapport d'erreurs dÃ©taillÃ©
- PrÃ©visualisation avant import dÃ©finitif avec statistiques
- Export avec filtres avancÃ©s et sÃ©lection de champs
- Gestion des doublons lors de l'import avec options de traitement
- Traitement en arriÃ¨re-plan pour gros volumes avec progression
- Templates d'import/export pour sources rÃ©currentes

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : schÃ©mas de validation Zod pour cohÃ©rence
- IntÃ¨gre : avec systÃ¨me de dÃ©tection de doublons
- Valide : cohÃ©rence avec rÃ©fÃ©rentiels existants
- Notifie : progression et rÃ©sultats via notifications

ğŸ’¡ **Tips Windsurf**
- Utiliser des Web Workers pour le traitement des gros fichiers
- ImplÃ©menter une validation robuste avec messages d'erreur clairs
- CrÃ©er des templates d'import standardisÃ©s pour sources communes
- GÃ©rer les opÃ©rations asynchrones avec feedback temps rÃ©el

---

### 16 - Analytics et rapports commerciaux

ğŸ¯ **But clair**
CrÃ©er un systÃ¨me d'analytics et de rapports pour analyser les performances commerciales, les tendances de conversion, l'efficacitÃ© des sources et les mÃ©triques d'Ã©quipe avec visualisations interactives.

ğŸ§  **Contexte technique**
Ce systÃ¨me fournit des insights commerciaux sur les performances des leads. Il utilise des requÃªtes optimisÃ©es pour calculer les mÃ©triques, des graphiques interactifs pour la visualisation, et des rapports automatisÃ©s pour le suivi rÃ©gulier.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants et services d'analytics

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- MÃ©triques de performance : taux de conversion, cycle de vente, valeur moyenne
- Analyses par source, assignÃ©, pÃ©riode avec comparaisons
- Tendances et prÃ©visions basÃ©es sur l'historique
- Rapports de qualitÃ© des donnÃ©es et de l'activitÃ© commerciale
- Tableaux de bord personnalisables par rÃ´le et Ã©quipe
- Export des rapports en PDF/Excel avec planification
- Alertes sur mÃ©triques critiques et objectifs

âš™ï¸ **Interactions avec d'autres modules**
- Consomme : donnÃ©es de tous les modules pour analyses croisÃ©es
- IntÃ¨gre : avec Dashboard pour mÃ©triques globales
- Utilise : systÃ¨me de notifications pour alertes
- Fournit : donnÃ©es pour optimisation des processus

ğŸ’¡ **Tips Windsurf**
- Utiliser des requÃªtes optimisÃ©es avec agrÃ©gations pour les calculs
- ImplÃ©menter des graphiques interactifs avec drill-down
- CrÃ©er des rapports automatisÃ©s configurables par Ã©quipe
- Optimiser les performances avec mise en cache des mÃ©triques

---

## ğŸš€ Section 4 : Ã‰volutions Futures

### 17 - Intelligence artificielle pour scoring et recommandations

ğŸ¯ **But clair**
DÃ©velopper l'intÃ©gration avec l'IA pour le scoring automatique avancÃ©, les recommandations d'actions commerciales et la prÃ©diction de conversion basÃ©e sur l'analyse des patterns historiques.

ğŸ§  **Contexte technique**
Cette Ã©volution utilise des modÃ¨les de machine learning pour analyser les patterns de conversion et recommander des actions optimales. Elle s'intÃ¨gre avec le module Console IA Automatisation pour accÃ©der aux capacitÃ©s d'apprentissage automatique.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants IA et services de recommandation

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Scoring IA basÃ© sur l'analyse de patterns de conversion historiques
- Recommandations d'actions personnalisÃ©es par lead et contexte
- PrÃ©diction de probabilitÃ© de conversion avec intervalles de confiance
- Identification automatique des leads Ã  fort potentiel
- Suggestions de timing optimal pour les interactions
- Analyse prÃ©dictive des tendances de marchÃ©
- Apprentissage continu basÃ© sur les rÃ©sultats rÃ©els

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : Console IA Automatisation pour modÃ¨les ML
- Analyse : donnÃ©es historiques de tous les modules
- IntÃ¨gre : avec systÃ¨me de notifications pour alertes IA
- AmÃ©liore : processus de qualification et de suivi

ğŸ’¡ **Tips Windsurf**
- Utiliser des modÃ¨les de ML Ã©prouvÃ©s pour la prÃ©diction commerciale
- ImplÃ©menter l'apprentissage par renforcement avec feedback
- CrÃ©er des interfaces de recommandation intuitives et actionnables
- Mesurer et optimiser la prÃ©cision des prÃ©dictions

---

### 18 - IntÃ©gration CRM et outils commerciaux externes

ğŸ¯ **But clair**
DÃ©velopper les intÃ©grations avec les CRM externes (Salesforce, HubSpot, Pipedrive) et outils commerciaux pour la synchronisation bidirectionnelle des donnÃ©es et l'unification des processus.

ğŸ§  **Contexte technique**
Cette fonctionnalitÃ© permet l'intÃ©gration avec l'Ã©cosystÃ¨me commercial existant des clients. Elle utilise des APIs REST et webhooks pour la synchronisation, gÃ¨re les conflits de donnÃ©es et maintient la cohÃ©rence entre systÃ¨mes.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants d'intÃ©gration et services API

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Connecteurs pour CRM majeurs avec authentification OAuth
- Synchronisation bidirectionnelle des leads et interactions
- Mapping flexible des champs entre systÃ¨mes
- Gestion des conflits avec rÃ¨gles de prioritÃ© configurables
- Historique des synchronisations avec logs dÃ©taillÃ©s
- Webhooks pour synchronisation temps rÃ©el
- Interface de configuration des intÃ©grations par utilisateur

âš™ï¸ **Interactions avec d'autres modules**
- Ã‰tend : systÃ¨me d'import/export pour sources externes
- Utilise : systÃ¨me d'audit pour traÃ§abilitÃ© des syncs
- IntÃ¨gre : avec Console IA pour enrichissement automatique
- Maintient : cohÃ©rence avec tous les modules internes

ğŸ’¡ **Tips Windsurf**
- Utiliser des patterns d'intÃ©gration robustes avec retry et circuit breaker
- ImplÃ©menter une gestion d'erreur complÃ¨te pour les APIs externes
- CrÃ©er des interfaces de mapping intuitives pour les utilisateurs
- PrÃ©voir la scalabilitÃ© pour de gros volumes de synchronisation

---

### 19 - Automatisation avancÃ©e des workflows commerciaux

ğŸ¯ **But clair**
ImplÃ©menter des workflows commerciaux automatisÃ©s avec dÃ©clencheurs intelligents, actions conditionnelles et intÃ©gration avec le module Console IA Automatisation pour optimiser l'efficacitÃ© commerciale.

ğŸ§  **Contexte technique**
Cette fonctionnalitÃ© crÃ©e des workflows automatisÃ©s pour les processus commerciaux rÃ©pÃ©titifs. Elle utilise le moteur d'automatisation de la Console IA, dÃ©finit des rÃ¨gles mÃ©tier complexes et exÃ©cute des actions automatiques selon les contextes.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants de workflow et services d'automatisation

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Ã‰diteur visuel de workflows avec conditions et actions
- DÃ©clencheurs basÃ©s sur Ã©vÃ©nements (nouveau lead, changement statut, Ã©chÃ©ance)
- Actions automatiques : assignation, crÃ©ation tÃ¢ches, envoi emails, notifications
- Conditions complexes basÃ©es sur score, source, timing, comportement
- Templates de workflows pour processus commerciaux standards
- Monitoring et analytics des workflows avec optimisation
- IntÃ©gration avec outils externes pour actions Ã©tendues

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : Console IA Automatisation pour moteur de workflow
- DÃ©clenche : actions dans tous les modules de l'ERP
- IntÃ¨gre : avec systÃ¨me de notifications pour alertes
- Optimise : processus commerciaux avec apprentissage

ğŸ’¡ **Tips Windsurf**
- Utiliser un Ã©diteur de workflow visuel et intuitif
- ImplÃ©menter des conditions complexes avec validation
- CrÃ©er des templates de workflow pour cas d'usage courants
- Monitorer les performances et l'efficacitÃ© des automatisations

---

### 20 - IntÃ©gration marketing et campagnes multi-canal

ğŸ¯ **But clair**
DÃ©velopper l'intÃ©gration avec les outils marketing pour le suivi des campagnes, l'attribution des sources, le nurturing automatisÃ© et l'analyse ROI des actions marketing sur les leads.

ğŸ§  **Contexte technique**
Cette fonctionnalitÃ© connecte le commercial avec le marketing pour une vision unifiÃ©e. Elle trace l'origine des leads, mesure l'efficacitÃ© des campagnes, automatise le nurturing et optimise l'allocation des budgets marketing.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants marketing et services d'attribution

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Tracking des sources marketing avec attribution multi-touch
- IntÃ©gration avec plateformes publicitaires (Google Ads, Facebook, LinkedIn)
- Campagnes de nurturing automatisÃ©es basÃ©es sur le comportement
- Scoring d'engagement marketing et commercial combinÃ©
- Analytics ROI par canal et campagne avec attribution
- Segmentation avancÃ©e pour campagnes personnalisÃ©es
- A/B testing des messages et approches commerciales

âš™ï¸ **Interactions avec d'autres modules**
- IntÃ¨gre : avec Module Marketing (si existant)
- Utilise : Console IA pour personnalisation des messages
- Alimente : Dashboard avec mÃ©triques marketing-commercial
- Optimise : allocation budgÃ©taire basÃ©e sur performance

ğŸ’¡ **Tips Windsurf**
- Utiliser des pixels de tracking et UTM pour attribution prÃ©cise
- ImplÃ©menter des modÃ¨les d'attribution multi-touch
- CrÃ©er des campagnes de nurturing basÃ©es sur les scores et comportements
- Mesurer et optimiser le ROI avec analytics avancÃ©s

---

### 21 - RÃ©alitÃ© augmentÃ©e pour prÃ©sentations commerciales

ğŸ¯ **But clair**
Explorer l'utilisation de la rÃ©alitÃ© augmentÃ©e pour crÃ©er des prÃ©sentations commerciales immersives, visualiser les Ã©vÃ©nements dans les lieux et amÃ©liorer l'expÃ©rience de vente avec des dÃ©monstrations innovantes.

ğŸ§  **Contexte technique**
Cette fonctionnalitÃ© rÃ©volutionnaire utilise la AR pour crÃ©er des expÃ©riences de vente immersives. Elle intÃ¨gre avec les donnÃ©es de lieux, permet la visualisation d'Ã©vÃ©nements et crÃ©e des prÃ©sentations interactives pour impressionner les prospects.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants AR et services de visualisation

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Visualisation AR des lieux avec superposition d'informations
- Simulation d'Ã©vÃ©nements dans les espaces avec dÃ©coration virtuelle
- PrÃ©sentations commerciales interactives avec Ã©lÃ©ments 3D
- Catalogue de services en rÃ©alitÃ© augmentÃ©e
- Partage d'expÃ©riences AR avec prospects Ã  distance
- Mesure de l'engagement et impact sur conversion
- Personnalisation des expÃ©riences selon les prÃ©fÃ©rences clients

âš™ï¸ **Interactions avec d'autres modules**
- Utilise : donnÃ©es Module Lieux pour visualisations
- IntÃ¨gre : avec Module Ã‰vÃ©nements pour simulations
- Ã‰tend : prÃ©sentations commerciales traditionnelles
- Mesure : impact sur taux de conversion

ğŸ’¡ **Tips Windsurf**
- Utiliser des frameworks AR web standards (WebXR)
- CrÃ©er des expÃ©riences progressives (2D â†’ 3D â†’ AR)
- Optimiser pour diffÃ©rents appareils et capacitÃ©s
- Mesurer l'impact sur l'engagement et les conversions

---

### 22 - Blockchain pour traÃ§abilitÃ© et contrats intelligents

ğŸ¯ **But clair**
Explorer l'utilisation de la blockchain pour assurer la traÃ§abilitÃ© immuable des interactions commerciales, crÃ©er des contrats intelligents pour les accords et garantir la transparence des processus de vente.

ğŸ§  **Contexte technique**
Cette fonctionnalitÃ© expÃ©rimentale utilise la blockchain pour crÃ©er une traÃ§abilitÃ© immuable des processus commerciaux. Elle permet la crÃ©ation de contrats intelligents, assure la transparence et crÃ©e de nouveaux modÃ¨les de confiance avec les clients.

ğŸ› ï¸ **Type de fichier concernÃ©**
`.tsx`, `.ts` - Composants blockchain et smart contracts

ğŸ”„ **Comportement attendu / Logique mÃ©tier**
- Enregistrement immuable des interactions commerciales critiques
- Contrats intelligents pour accords commerciaux automatisÃ©s
- TraÃ§abilitÃ© complÃ¨te du cycle de vente avec horodatage cryptographique
- Tokens de rÃ©putation basÃ©s sur les performances commerciales
- Escrow automatisÃ© pour les acomptes et paiements
- Audit trail inviolable pour conformitÃ© rÃ©glementaire
- Marketplace dÃ©centralisÃ©e pour services wedding

âš™ï¸ **Interactions avec d'autres modules**
- ComplÃ¨te : systÃ¨me d'audit traditionnel avec immutabilitÃ©
- IntÃ¨gre : avec Module Contrats pour automatisation
- Ã‰tend : vers Ã©cosystÃ¨me dÃ©centralisÃ© de confiance
- Assure : transparence et conformitÃ© rÃ©glementaire

ğŸ’¡ **Tips Windsurf**
- Commencer par des preuves de concept simples et mesurables
- Utiliser des solutions blockchain Ã©prouvÃ©es et scalables
- Maintenir la compatibilitÃ© avec systÃ¨mes existants
- Ã‰valuer rÃ©guliÃ¨rement les coÃ»ts et bÃ©nÃ©fices rÃ©els

---

## ğŸ“Š Matrice de PrioritÃ©s et DÃ©pendances

| Prompt | PrioritÃ© | DÃ©pendances | DurÃ©e EstimÃ©e | ComplexitÃ© |
|--------|----------|-------------|---------------|------------|
| 01-06  | P0       | Console Admin, Monorepo | 5-6 jours     | Ã‰levÃ©e     |
| 07-12  | P1       | 01-06       | 7-9 jours     | Ã‰levÃ©e     |
| 13-16  | P1       | 07-12       | 5-6 jours     | Moyenne    |
| 17-22  | P2-P3    | 13-16, Console IA | 4-6 semaines  | TrÃ¨s Ã©levÃ©e |

---

## ğŸ”„ Ordre d'ExÃ©cution RecommandÃ©

### **Phase 1 - Infrastructure Commerciale (Semaines 1-2)**
Prompts 01-06 : Tables, RLS, RPC, Triggers

### **Phase 2 - Interfaces Principales (Semaines 3-4)**
Prompts 07-12 : Liste, Kanban, formulaires, dÃ©tails, interactions, tÃ¢ches

### **Phase 3 - FonctionnalitÃ©s AvancÃ©es (Semaines 5-6)**
Prompts 13-16 : Scoring, doublons, import/export, analytics

### **Phase 4 - Ã‰volutions Futures (Versions ultÃ©rieures)**
Prompts 17-22 : IA, CRM, workflows, marketing, AR, blockchain

---

## âš ï¸ Points d'Attention Critiques

### **ComplexitÃ© Commerciale**
- Gestion des cycles de vente complexes avec multiples intervenants
- DÃ©tection et fusion de doublons avec prÃ©servation de l'historique
- Scoring automatique avec critÃ¨res mÃ©tier Ã©volutifs
- Conversion transactionnelle vers clients/Ã©vÃ©nements

### **Performance et VolumÃ©trie**
- Optimisation des requÃªtes de recherche et filtrage sur gros volumes
- Gestion efficace des interactions et tÃ¢ches nombreuses
- Cache intelligent pour les mÃ©triques et analytics
- Index optimisÃ©s pour les patterns de requÃªte commerciaux

### **SÃ©curitÃ© et ConfidentialitÃ©**
- Protection des donnÃ©es prospects sensibles avec RLS granulaire
- Respect du RGPD avec consentement et droit Ã  l'oubli
- Audit complet des accÃ¨s et modifications
- SÃ©curisation des intÃ©grations avec systÃ¨mes externes

### **IntÃ©gration Inter-Modules**
- Synchronisation avec Module Clients pour conversions
- Coordination avec Module Ã‰vÃ©nements pour qualification
- IntÃ©gration avec Console IA pour automatisation
- CohÃ©rence avec Dashboard pour mÃ©triques globales

---

*Document gÃ©nÃ©rÃ© par Manus AI - Expert en transformation de cahiers des charges pour Windsurf*

