# Prompts Windsurf - Module Clients du Backoffice

**Version :** 1.0  
**Date :** 3 Juin 2025  
**Auteur :** Manus AI - Expert Windsurf  
**Module :** 1.4 Back Office Clients  
**Application :** apps/backoffice  

---

## üìã Vue d'Ensemble du Module

Le module **Clients du Backoffice** constitue le c≈ìur de la gestion client de l'ERP Wedding Collection. Il g√®re l'ensemble du cycle de vie client depuis la conversion des leads qualifi√©s jusqu'√† la gestion compl√®te des relations client avec profils d√©taill√©s, historique des √©v√©nements, documents, interactions et int√©grations avec tous les modules de l'√©cosyst√®me.

### üéØ Objectifs Principaux
- **Gestion compl√®te des fiches clients** (particuliers et entreprises)
- **Conversion automatis√©e** des leads qualifi√©s en clients actifs
- **Syst√®me de documents** avec stockage s√©curis√© et cat√©gorisation
- **Historique des interactions** avec suivi complet des communications
- **Champs personnalis√©s** pour adaptation aux besoins sp√©cifiques
- **Int√©gration Client-Portal** avec synchronisation bidirectionnelle
- **Conformit√© RGPD** avec gestion des consentements

### üèóÔ∏è Architecture Technique
- **Sch√©ma shared** : 8 tables principales avec relations complexes
- **Types √©num√©r√©s** : Standardisation des valeurs m√©tier
- **RLS granulaire** : S√©curit√© fine selon r√¥les et organisations
- **Fonctions RPC** : API backend optimis√©e pour performance
- **Storage Supabase** : Gestion s√©curis√©e des documents clients
- **Int√©gration Realtime** : Synchronisation temps r√©el avec Client-Portal

### üîó Int√©grations Critiques
- **Module Leads** : Conversion automatis√©e des prospects qualifi√©s
- **Module √âv√©nements** : Liaison avec les √©v√©nements clients
- **Console Admin** : Permissions et audit des actions sensibles
- **Client-Portal** : Synchronisation bidirectionnelle des donn√©es
- **Dashboard** : M√©triques et KPIs clients en temps r√©el

---

## üèóÔ∏è Section 1 : Initialisation

### 01 - Cr√©ation du sch√©ma de base de donn√©es clients

üéØ **But :** Cr√©er l'architecture compl√®te de base de donn√©es pour la gestion des clients avec toutes les tables, relations et contraintes n√©cessaires.

üß† **Contexte technique :** Le module Clients utilise le sch√©ma `shared` pour permettre l'acc√®s transversal par tous les modules. L'architecture supporte les clients particuliers et entreprises, avec gestion des conjoints, adresses multiples, documents et champs personnalis√©s.

üõ†Ô∏è **Type de fichier :** `.sql` (migration Supabase)

üîÑ **Comportement attendu :**
Cr√©er dans l'ordre les tables suivantes avec leurs contraintes et index :
- `shared.clients` : Table principale avec informations client principal et conjoint
- `shared.client_addresses` : Adresses multiples (facturation, livraison, autre)
- `shared.client_documents` : M√©tadonn√©es des documents avec liens Storage
- `shared.client_interactions` : Historique complet des interactions
- `shared.custom_field_definitions` : D√©finitions des champs personnalis√©s
- `shared.client_custom_fields` : Valeurs des champs personnalis√©s par client
- `shared.client_history` : Audit d√©taill√© des modifications sensibles
- `shared.client_pending_changes` : Modifications en attente depuis Client-Portal

Impl√©menter les contraintes d'int√©grit√© r√©f√©rentielle, les index de performance et les contraintes m√©tier (unicit√© email par organisation, validation formats, etc.).

‚öôÔ∏è **Interactions :** 
- R√©f√©rence `bo.leads(id)` pour la conversion
- R√©f√©rence `shared.organizations(id)` pour l'isolation multi-tenant
- R√©f√©rence `auth.users(id)` pour l'acc√®s Client-Portal
- R√©f√©rence `shared.user_profiles(id)` pour l'audit des actions

üí° **Tips Windsurf :** Utilise le MCP Supabase pour cr√©er directement les migrations. Assure-toi de respecter l'ordre de cr√©ation des tables selon les d√©pendances. Teste les contraintes avec des donn√©es d'exemple.

---

### 02 - Cr√©ation des types √©num√©r√©s et listes de valeurs

üéØ **But :** D√©finir tous les types √©num√©r√©s et listes de valeurs standardis√©es utilis√©es par le module Clients pour assurer la coh√©rence des donn√©es.

üß† **Contexte technique :** Le syst√®me utilise la table `shared.list_options` pour centraliser toutes les listes de valeurs. Cette approche permet la modification dynamique des options sans migration de base de donn√©es.

üõ†Ô∏è **Type de fichier :** `.sql` (migration Supabase)

üîÑ **Comportement attendu :**
Ins√©rer dans `shared.list_options` toutes les valeurs pour :
- `civility` : M., Mme, Dr., etc.
- `client_type` : Particulier, Entreprise, Association, etc.
- `client_source` : Site web, Recommandation, Salon, R√©seaux sociaux, etc.
- `language` : Fran√ßais, Anglais, Espagnol, etc.
- `country` : Liste compl√®te des pays avec codes ISO
- `client_document_type` : Contrat, Pi√®ce d'identit√©, Brief, Facture, etc.

Cr√©er la fonction `shared.check_list_option(option_id UUID, list_name TEXT)` pour valider les r√©f√©rences aux listes de valeurs.

‚öôÔ∏è **Interactions :** 
- Utilis√© par toutes les tables avec des champs de type liste
- Partag√© avec d'autres modules pour coh√©rence globale
- Accessible depuis le Client-Portal pour les formulaires

üí° **Tips Windsurf :** Groupe les insertions par `list_name` pour une meilleure lisibilit√©. Utilise des `display_order` logiques pour l'affichage frontend. Pr√©vois l'extensibilit√© avec `is_active` pour d√©sactiver sans supprimer.

---

### 03 - Cr√©ation des index de performance

üéØ **But :** Optimiser les performances des requ√™tes fr√©quentes sur les donn√©es clients avec des index strat√©giquement plac√©s.

üß† **Contexte technique :** Les recherches clients sont intensives (nom, email, entreprise) et les jointures avec les tables li√©es sont fr√©quentes. Les index doivent couvrir les cas d'usage principaux sans impacter les performances d'√©criture.

üõ†Ô∏è **Type de fichier :** `.sql` (migration Supabase)

üîÑ **Comportement attendu :**
Cr√©er les index suivants :
- `idx_clients_email_org` : Recherche par email dans une organisation
- `idx_clients_name_org` : Recherche par nom dans une organisation
- `idx_clients_active_deleted` : Filtrage clients actifs/supprim√©s
- `idx_clients_created_at` : Tri chronologique
- `idx_clients_company_name` : Recherche entreprises (avec condition WHERE)
- `idx_client_addresses_client_id` : Jointures adresses
- `idx_client_documents_client_id` : Jointures documents
- `idx_client_interactions_client_id` : Jointures interactions
- `idx_client_interactions_date` : Tri chronologique interactions
- `idx_client_custom_fields_client` : Jointures champs personnalis√©s

‚öôÔ∏è **Interactions :** 
- Optimise les requ√™tes des fonctions RPC
- Am√©liore les performances de recherche frontend
- Acc√©l√®re les jointures avec modules li√©s (√âv√©nements, Facturation)

üí° **Tips Windsurf :** Utilise `EXPLAIN ANALYZE` pour valider l'efficacit√© des index. Privil√©gie les index composites pour les requ√™tes multi-crit√®res. Surveille la taille des index vs b√©n√©fice performance.

---

### 04 - Impl√©mentation des politiques RLS (Row Level Security)

üéØ **But :** S√©curiser l'acc√®s aux donn√©es clients avec des politiques RLS granulaires selon les r√¥les et l'isolation multi-tenant.

üß† **Contexte technique :** Chaque organisation doit acc√©der uniquement √† ses clients. Les r√¥les d√©terminent les permissions (lecture, √©criture, suppression). Le Client-Portal a des acc√®s restreints √† ses propres donn√©es.

üõ†Ô∏è **Type de fichier :** `.sql` (migration Supabase)

üîÑ **Comportement attendu :**
Activer RLS sur toutes les tables et cr√©er les politiques :

**Pour `shared.clients` :**
- `clients_select_policy` : Lecture selon organisation et r√¥le
- `clients_insert_policy` : Cr√©ation par r√¥les autoris√©s
- `clients_update_policy` : Modification selon r√¥le et propri√©t√©
- `clients_delete_policy` : Suppression logique par administrateurs

**Pour tables li√©es :**
- Politiques similaires avec v√©rification de l'`organization_id`
- Acc√®s Client-Portal limit√© aux donn√©es du client connect√©
- Audit trail prot√©g√© en lecture seule pour non-administrateurs

Utiliser les fonctions d'aide comme `shared.get_user_organization_id()` et `shared.user_has_permission()`.

‚öôÔ∏è **Interactions :** 
- Int√©gration avec Console Admin pour v√©rification des permissions
- Coordination avec auth.users pour l'authentification Client-Portal
- Respect de l'isolation multi-tenant

üí° **Tips Windsurf :** Teste chaque politique avec diff√©rents r√¥les. Utilise des fonctions helper pour √©viter la duplication de logique. Documente clairement les permissions pour chaque r√¥le.

---

### 05 - Cr√©ation des fonctions RPC backend

üéØ **But :** Impl√©menter l'API backend compl√®te avec toutes les fonctions RPC n√©cessaires pour les op√©rations CRUD et la logique m√©tier complexe.

üß† **Contexte technique :** Les fonctions RPC encapsulent la logique m√©tier complexe c√¥t√© base de donn√©es pour optimiser les performances et centraliser les r√®gles business. Elles g√®rent les transactions, validations et calculs.

üõ†Ô∏è **Type de fichier :** `.sql` (fonctions PostgreSQL)

üîÑ **Comportement attendu :**
Cr√©er les fonctions RPC suivantes :

**Gestion CRUD :**
- `shared.rpc_get_clients_list(params JSONB)` : Liste pagin√©e avec filtres et recherche
- `shared.rpc_get_client_details(client_id UUID)` : D√©tails complets avec donn√©es li√©es
- `shared.rpc_create_client(client_data JSONB)` : Cr√©ation avec validation et audit
- `shared.rpc_update_client(client_id UUID, client_data JSONB)` : Mise √† jour avec historique
- `shared.rpc_soft_delete_client(client_id UUID)` : Suppression logique s√©curis√©e

**Fonctions sp√©cialis√©es :**
- `shared.rpc_convert_lead_to_client(lead_id UUID)` : Conversion automatis√©e
- `shared.rpc_get_client_documents(client_id UUID)` : Documents avec m√©tadonn√©es
- `shared.rpc_add_client_interaction(interaction_data JSONB)` : Ajout interaction
- `shared.rpc_get_client_similarity(search_params JSONB)` : D√©tection doublons
- `shared.rpc_manage_custom_fields(operation TEXT, field_data JSONB)` : Gestion champs personnalis√©s

Chaque fonction doit inclure validation des param√®tres, gestion d'erreurs et audit des actions sensibles.

‚öôÔ∏è **Interactions :** 
- Appel√©es par le frontend via packages/api-client
- Utilisent les politiques RLS pour la s√©curit√©
- Int√®grent avec Module Leads pour la conversion
- Loggent dans Console Admin pour l'audit

üí° **Tips Windsurf :** Structure les fonctions avec gestion d'erreurs robuste. Utilise des transactions pour les op√©rations complexes. Retourne des JSONB structur√©s pour faciliter le parsing frontend.

---

### 06 - Impl√©mentation des triggers et automatisations

üéØ **But :** Automatiser les t√¢ches r√©p√©titives et maintenir la coh√©rence des donn√©es avec des triggers PostgreSQL intelligents.

üß† **Contexte technique :** Les triggers assurent la mise √† jour automatique des timestamps, l'audit des modifications sensibles et la synchronisation avec les modules li√©s. Ils maintiennent l'int√©grit√© des donn√©es sans intervention manuelle.

üõ†Ô∏è **Type de fichier :** `.sql` (triggers PostgreSQL)

üîÑ **Comportement attendu :**
Cr√©er les triggers suivants :

**Triggers de maintenance :**
- `set_updated_at_clients` : Mise √† jour automatique de `updated_at`
- `audit_client_changes` : Enregistrement dans `client_history` des modifications sensibles
- `validate_client_data` : Validation des donn√©es avant insertion/mise √† jour

**Triggers de synchronisation :**
- `sync_client_portal_changes` : Notification des changements vers Client-Portal
- `update_related_modules` : Mise √† jour des r√©f√©rences dans modules li√©s
- `manage_user_profile_sync` : Synchronisation avec auth.users pour acc√®s portal

**Triggers de nettoyage :**
- `cleanup_orphaned_documents` : Suppression des documents orphelins
- `archive_old_interactions` : Archivage automatique des anciennes interactions

‚öôÔ∏è **Interactions :** 
- Synchronisation avec Client-Portal via Realtime
- Notification vers Dashboard pour mise √† jour des m√©triques
- Int√©gration avec Console Admin pour l'audit

üí° **Tips Windsurf :** Utilise des triggers AFTER pour √©viter les conflits. Impl√©mente une logique de retry pour les synchronisations externes. Loggue les erreurs de triggers pour le debugging.

---

## üöÄ Section 2 : Fonctionnalit√©s Principales


### 07 - Cr√©ation de la page liste des clients

üéØ **But :** D√©velopper l'interface principale de gestion des clients avec liste pagin√©e, recherche avanc√©e, filtres et actions en lot.

üß† **Contexte technique :** Cette page est le point d'entr√©e principal du module. Elle doit g√©rer de gros volumes de donn√©es avec pagination c√¥t√© serveur, recherche en temps r√©el et filtres multiples. L'interface utilise TanStack Query pour la gestion du cache et des √©tats de chargement.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/pages/ClientListPage.tsx` avec :
- **Table responsive** avec colonnes : Nom complet, Email, T√©l√©phone, Type, Source, Date cr√©ation, Statut, Actions
- **Recherche globale** en temps r√©el avec debounce (nom, email, t√©l√©phone, entreprise)
- **Filtres avanc√©s** : Type client, Source, P√©riode de cr√©ation, Statut actif/inactif
- **Pagination c√¥t√© serveur** avec s√©lection du nombre d'√©l√©ments par page
- **Tri multi-colonnes** avec indicateurs visuels
- **Actions en lot** : Export, Suppression logique, Modification du statut
- **Actions individuelles** : Voir d√©tails, Modifier, Supprimer, Cr√©er √©v√©nement
- **Indicateurs visuels** : Badges pour type client, ic√¥nes pour statut portal

Utiliser les composants ShadCN UI (Table, Input, Select, Button, Badge) et int√©grer avec TanStack Query pour la gestion des donn√©es.

‚öôÔ∏è **Interactions :** 
- Appelle `shared.rpc_get_clients_list()` via packages/api-client
- Navigation vers ClientDetailPage et ClientForm
- Int√©gration avec Module √âv√©nements pour cr√©ation rapide
- Respect des permissions utilisateur depuis Console Admin

üí° **Tips Windsurf :** Utilise useDebounce pour la recherche. Impl√©mente la virtualisation pour les grandes listes. Sauvegarde les filtres dans l'URL pour la navigation.

---

### 08 - Cr√©ation du formulaire client (cr√©ation/√©dition)

üéØ **But :** D√©velopper le formulaire complet de cr√©ation et d'√©dition des clients avec validation, gestion des erreurs et exp√©rience utilisateur optimis√©e.

üß† **Contexte technique :** Le formulaire g√®re les clients particuliers et entreprises avec des champs conditionnels. Il inclut la validation c√¥t√© client avec Zod, la d√©tection de doublons en temps r√©el et la gestion des champs personnalis√©s dynamiques.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/components/ClientForm.tsx` avec :

**Structure du formulaire :**
- **Onglet "Informations principales"** : Civilit√©, Nom, Pr√©nom, Email, T√©l√©phones
- **Onglet "Conjoint"** : Informations du client secondaire (conditionnel)
- **Onglet "Entreprise"** : Nom soci√©t√©, SIRET, TVA (si client B2B)
- **Onglet "Adresses"** : Adresse principale + adresses additionnelles
- **Onglet "Informations compl√©mentaires"** : Type, Source, Langue, Notes
- **Onglet "Champs personnalis√©s"** : Rendu dynamique selon d√©finitions

**Fonctionnalit√©s avanc√©es :**
- **Validation Zod** avec messages d'erreur contextuels
- **D√©tection de doublons** en temps r√©el sur email/nom
- **Auto-compl√©tion** des adresses avec API g√©olocalisation
- **Upload de documents** avec drag & drop
- **Gestion des consentements RGPD** avec horodatage
- **Mode cr√©ation depuis Lead** avec pr√©-remplissage

Utiliser React Hook Form avec Zod pour la validation et ShadCN UI pour les composants.

‚öôÔ∏è **Interactions :** 
- Appelle `shared.rpc_create_client()` ou `shared.rpc_update_client()`
- Utilise `shared.rpc_get_client_similarity()` pour d√©tection doublons
- Int√©gration avec Supabase Storage pour les documents
- Conversion depuis Module Leads via `shared.rpc_convert_lead_to_client()`

üí° **Tips Windsurf :** Utilise des sch√©mas Zod conditionnels selon le type client. Impl√©mente l'auto-save pour √©viter la perte de donn√©es. G√®re les √©tats de chargement pour chaque section.

---

### 09 - Cr√©ation de la page d√©tails client

üéØ **But :** D√©velopper la vue d√©taill√©e compl√®te d'un client avec toutes les informations, documents, historique et donn√©es li√©es des autres modules.

üß† **Contexte technique :** Cette page centralise toutes les informations client avec des onglets organis√©s. Elle affiche les donn√©es en lecture seule avec possibilit√© d'√©dition rapide. L'interface charge les donn√©es de mani√®re optimis√©e avec des requ√™tes parall√®les.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/pages/ClientDetailPage.tsx` avec :

**Onglets principaux :**
- **"Vue d'ensemble"** : Informations principales, statut, m√©triques cl√©s
- **"Coordonn√©es"** : Toutes les informations de contact et adresses
- **"Documents"** : Liste des documents avec pr√©visualisation et t√©l√©chargement
- **"Interactions"** : Historique chronologique des communications
- **"√âv√©nements"** : Liste des √©v√©nements li√©s avec statuts et dates
- **"Facturation"** : Devis, factures et paiements (lecture seule)
- **"Champs personnalis√©s"** : Affichage des valeurs avec possibilit√© d'√©dition
- **"Historique"** : Audit trail des modifications avec d√©tails

**Fonctionnalit√©s :**
- **Actions rapides** : Modifier, Cr√©er √©v√©nement, Ajouter interaction, Envoyer email
- **Widgets de synth√®se** : CA total, Nombre d'√©v√©nements, Derni√®re interaction
- **Timeline interactive** : Chronologie des √©v√©nements et interactions
- **Acc√®s Client-Portal** : Activation/d√©sactivation avec g√©n√©ration de credentials

‚öôÔ∏è **Interactions :** 
- Appelle `shared.rpc_get_client_details()` pour les donn√©es principales
- Int√©gration avec Module √âv√©nements pour affichage des √©v√©nements
- Int√©gration avec Module Facturation pour les donn√©es financi√®res
- Synchronisation avec Client-Portal pour l'acc√®s client

üí° **Tips Windsurf :** Utilise Suspense pour le chargement progressif des onglets. Impl√©mente le lazy loading pour les documents volumineux. Cache les donn√©es fr√©quemment consult√©es.

---

### 10 - Gestion des documents clients

üéØ **But :** Impl√©menter le syst√®me complet de gestion des documents clients avec upload, cat√©gorisation, pr√©visualisation et partage s√©curis√©.

üß† **Contexte technique :** Le syst√®me utilise Supabase Storage avec des buckets organis√©s par type de document. Les m√©tadonn√©es sont stock√©es en base pour la recherche et la cat√©gorisation. La s√©curit√© est assur√©e par des politiques RLS sur le storage.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/components/ClientDocuments.tsx` avec :

**Interface de gestion :**
- **Zone de drop** pour upload multiple avec progress bars
- **Liste des documents** avec miniatures, m√©tadonn√©es et actions
- **Filtres par type** : Contrats, Pi√®ces d'identit√©, Briefs, Factures, Autres
- **Recherche textuelle** dans les noms et descriptions
- **Actions par document** : T√©l√©charger, Pr√©visualiser, Modifier, Supprimer, Partager

**Fonctionnalit√©s avanc√©es :**
- **Pr√©visualisation int√©gr√©e** pour PDF, images et documents Office
- **Versioning automatique** avec historique des modifications
- **Partage s√©curis√©** avec liens temporaires et mots de passe
- **Visibilit√© Client-Portal** configurable par document
- **Validation des formats** et taille maximale
- **Compression automatique** des images

Utiliser react-dropzone pour l'upload et react-pdf pour la pr√©visualisation.

‚öôÔ∏è **Interactions :** 
- Utilise Supabase Storage avec buckets `client-documents`
- Appelle `shared.rpc_get_client_documents()` pour les m√©tadonn√©es
- Int√©gration avec Client-Portal pour la visibilit√© des documents
- Audit des acc√®s via Console Admin

üí° **Tips Windsurf :** Impl√©mente l'upload en chunks pour les gros fichiers. Utilise des workers pour la compression d'images. G√®re les erreurs d'upload avec retry automatique.

---

### 11 - Syst√®me d'interactions et historique

üéØ **But :** D√©velopper le syst√®me complet de suivi des interactions client avec saisie rapide, cat√©gorisation et timeline chronologique.

üß† **Contexte technique :** Le syst√®me enregistre tous les types d'interactions (appels, emails, r√©unions, notes) avec m√©tadonn√©es structur√©es. L'interface permet la saisie rapide et l'affichage chronologique avec filtres avanc√©s.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/components/ClientInteractions.tsx` avec :

**Interface de saisie :**
- **Formulaire rapide** : Type, Titre, Description, Date/Heure
- **Types d'interaction** : Appel entrant/sortant, Email, R√©union, Note, Changement statut
- **M√©tadonn√©es sp√©cifiques** : Dur√©e appel, Participants r√©union, Pi√®ces jointes email
- **Templates pr√©d√©finis** pour les interactions courantes
- **Saisie vocale** avec transcription automatique (optionnel)

**Affichage timeline :**
- **Vue chronologique** avec groupement par jour/semaine/mois
- **Filtres par type** et p√©riode avec recherche textuelle
- **Ic√¥nes distinctives** par type d'interaction
- **Expansion/collapse** des d√©tails avec m√©tadonn√©es
- **Actions rapides** : R√©pondre, Planifier suivi, Marquer important

**Fonctionnalit√©s avanc√©es :**
- **Rappels automatiques** pour les suivis programm√©s
- **Int√©gration email** avec synchronisation des √©changes
- **Statistiques d'interaction** par client et par p√©riode
- **Export des historiques** en PDF ou Excel

‚öôÔ∏è **Interactions :** 
- Appelle `shared.rpc_add_client_interaction()` pour l'ajout
- Int√©gration avec syst√®me de notifications pour les rappels
- Synchronisation avec Client-Portal pour les interactions client
- Liaison avec Module √âv√©nements pour les interactions li√©es

üí° **Tips Windsurf :** Utilise des formulaires modaux pour la saisie rapide. Impl√©mente la pagination virtuelle pour les longues timelines. Sauvegarde automatiquement les brouillons.

---

### 12 - Conversion Lead vers Client

üéØ **But :** Impl√©menter le processus automatis√© de conversion des leads qualifi√©s en clients avec transfert des donn√©es et workflow de validation.

üß† **Contexte technique :** La conversion transf√®re toutes les donn√©es du lead vers le client en pr√©servant l'historique. Le processus inclut la validation des donn√©es, la d√©tection de doublons et la mise √† jour des statuts dans les deux modules.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/components/LeadConversion.tsx` avec :

**Interface de conversion :**
- **S√©lection du lead** avec recherche et filtres (statut qualifi√© uniquement)
- **Pr√©visualisation des donn√©es** √† transf√©rer avec possibilit√© de modification
- **D√©tection de doublons** avec suggestions de fusion ou cr√©ation
- **Mapping des champs** lead vers client avec validation
- **Choix des √©l√©ments** √† transf√©rer (interactions, documents, t√¢ches)

**Processus de validation :**
- **V√©rification des donn√©es** obligatoires manquantes
- **Validation des formats** (email, t√©l√©phone, adresses)
- **Contr√¥le de coh√©rence** avec les donn√©es existantes
- **Confirmation utilisateur** avec r√©capitulatif des actions

**Post-conversion :**
- **Mise √† jour automatique** du statut lead vers "Converti"
- **Cr√©ation du lien** `converted_from_lead_id` dans la table clients
- **Transfert de l'historique** avec pr√©servation des timestamps
- **Notification automatique** aux √©quipes concern√©es

‚öôÔ∏è **Interactions :** 
- Appelle `shared.rpc_convert_lead_to_client()` pour la conversion
- Int√©gration avec Module Leads pour mise √† jour des statuts
- Utilise `shared.rpc_get_client_similarity()` pour d√©tection doublons
- Notification via Dashboard des conversions r√©ussies

üí° **Tips Windsurf :** Utilise des transactions pour garantir la coh√©rence. Impl√©mente un syst√®me de rollback en cas d'erreur. Loggue toutes les √©tapes pour l'audit.

---

## üîß Section 3 : Fonctionnalit√©s Secondaires


### 13 - Gestion des champs personnalis√©s

üéØ **But :** Impl√©menter le syst√®me complet de champs personnalis√©s permettant aux organisations d'adapter les fiches clients √† leurs besoins sp√©cifiques.

üß† **Contexte technique :** Le syst√®me utilise une approche EAV (Entity-Attribute-Value) avec des tables d√©di√©es pour les d√©finitions et valeurs. Les champs sont typ√©s (texte, nombre, date, bool√©en, liste) avec validation dynamique c√¥t√© client et serveur.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/components/CustomFields.tsx` avec :

**Gestion des d√©finitions :**
- **Interface d'administration** pour cr√©er/modifier les d√©finitions de champs
- **Types support√©s** : Texte, Nombre, Date, Bool√©en, Liste d√©roulante, Multi-s√©lection
- **Configuration avanc√©e** : Obligatoire, Valeur par d√©faut, Validation personnalis√©e
- **Visibilit√© Client-Portal** : Configurable par champ (visible/√©ditable)
- **Ordre d'affichage** avec drag & drop pour r√©organisation

**Rendu dynamique :**
- **Composants adaptatifs** selon le type de champ d√©fini
- **Validation en temps r√©el** avec messages d'erreur contextuels
- **Auto-compl√©tion** pour les champs texte avec historique
- **Formatage automatique** pour les nombres et dates
- **Gestion des d√©pendances** entre champs (affichage conditionnel)

**Interface utilisateur :**
- **Groupement logique** des champs par cat√©gories
- **Recherche et filtres** sur les champs personnalis√©s
- **Import/export** des d√©finitions entre organisations
- **Historique des modifications** avec audit trail complet

‚öôÔ∏è **Interactions :** 
- Utilise `shared.custom_field_definitions` et `shared.client_custom_fields`
- Appelle `shared.rpc_manage_custom_fields()` pour les op√©rations CRUD
- Synchronisation avec Client-Portal pour les champs √©ditables
- Int√©gration avec Console Admin pour les permissions de gestion

üí° **Tips Windsurf :** Utilise des composants g√©n√©riques pour le rendu des champs. Impl√©mente la validation c√¥t√© serveur pour la s√©curit√©. Cache les d√©finitions pour optimiser les performances.

---

### 14 - D√©tection et gestion des doublons

üéØ **But :** D√©velopper un syst√®me intelligent de d√©tection et de gestion des doublons clients avec algorithmes de similarit√© et interface de fusion.

üß† **Contexte technique :** Le syst√®me utilise des algorithmes de similarit√© (Levenshtein, Soundex) pour d√©tecter les doublons potentiels sur nom, email, t√©l√©phone et adresse. L'interface permet la comparaison visuelle et la fusion s√©lective des donn√©es.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/components/DuplicateDetection.tsx` avec :

**D√©tection automatique :**
- **Scan p√©riodique** de la base clients avec scoring de similarit√©
- **Algorithmes multiples** : Similarit√© textuelle, phon√©tique, g√©ographique
- **Seuils configurables** pour les diff√©rents niveaux de correspondance
- **D√©tection en temps r√©el** lors de la cr√©ation/modification
- **Exclusions manuelles** pour √©viter les faux positifs r√©currents

**Interface de gestion :**
- **Liste des doublons** d√©tect√©s avec scores de confiance
- **Comparaison c√¥te √† c√¥te** des fiches suspectes
- **Fusion s√©lective** : Choix des champs √† conserver de chaque fiche
- **Pr√©servation de l'historique** : Fusion des interactions et documents
- **Validation manuelle** avant fusion d√©finitive

**Fonctionnalit√©s avanc√©es :**
- **R√®gles personnalis√©es** de d√©tection par organisation
- **Machine learning** pour am√©liorer la pr√©cision au fil du temps
- **Rapports de qualit√©** des donn√©es avec m√©triques de doublons
- **API de v√©rification** pour les int√©grations externes

‚öôÔ∏è **Interactions :** 
- Appelle `shared.rpc_get_client_similarity()` pour la d√©tection
- Utilise des fonctions de fusion pour pr√©server l'int√©grit√©
- Int√©gration avec Console Admin pour l'audit des fusions
- Notification des √©quipes lors de d√©tections importantes

üí° **Tips Windsurf :** Utilise des workers pour les calculs intensifs. Impl√©mente des sauvegardes avant fusion. Optimise les algorithmes pour les gros volumes.

---

### 15 - Import/Export de donn√©es clients

üéØ **But :** D√©velopper un syst√®me robuste d'import/export pour la migration de donn√©es et l'int√©gration avec des syst√®mes externes.

üß† **Contexte technique :** Le syst√®me supporte multiple formats (CSV, Excel, JSON) avec mapping flexible des colonnes. L'import inclut la validation, la d√©tection de doublons et la gestion d'erreurs avec rapports d√©taill√©s.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/components/ImportExport.tsx` avec :

**Import de donn√©es :**
- **Support multi-formats** : CSV, Excel (.xlsx), JSON
- **Mapping interactif** des colonnes source vers champs destination
- **Pr√©visualisation** des donn√©es avec d√©tection automatique des types
- **Validation en lot** avec rapport d'erreurs d√©taill√©
- **Mode simulation** pour tester l'import sans modification
- **Import incr√©mental** avec gestion des mises √† jour

**Export de donn√©es :**
- **S√©lection flexible** : Tous clients, filtres personnalis√©s, s√©lection manuelle
- **Formats de sortie** : CSV, Excel, JSON, PDF (fiches compl√®tes)
- **Personnalisation** des colonnes et de l'ordre d'export
- **Chiffrement** des exports sensibles avec mot de passe
- **Planification** d'exports automatiques r√©currents

**Gestion des erreurs :**
- **Validation ligne par ligne** avec messages contextuels
- **Correction assist√©e** des erreurs communes
- **Import partiel** : Traitement des lignes valides, rapport des erreurs
- **Rollback complet** en cas d'erreur critique
- **Logs d√©taill√©s** pour tra√ßabilit√© et debugging

‚öôÔ∏è **Interactions :** 
- Utilise les fonctions RPC pour validation et insertion en lot
- Int√©gration avec Supabase Storage pour fichiers temporaires
- Appelle la d√©tection de doublons pendant l'import
- Audit complet via Console Admin

üí° **Tips Windsurf :** Utilise des streams pour les gros fichiers. Impl√©mente la validation c√¥t√© serveur pour la s√©curit√©. Optimise les insertions en lot avec transactions.

---

### 16 - Analytics et rapports clients

üéØ **But :** Cr√©er un syst√®me complet d'analytics et de rapports pour analyser les donn√©es clients et optimiser les processus commerciaux.

üß† **Contexte technique :** Le syst√®me g√©n√®re des m√©triques en temps r√©el avec des requ√™tes optimis√©es. Les rapports sont interactifs avec filtres dynamiques et export en multiple formats. L'interface utilise des graphiques responsives.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/components/ClientAnalytics.tsx` avec :

**M√©triques principales :**
- **KPIs globaux** : Nombre total clients, Croissance mensuelle, Taux de conversion leads
- **R√©partition par type** : Particuliers vs Entreprises, Sources d'acquisition
- **Analyse g√©ographique** : R√©partition par r√©gion, ville, pays
- **Analyse temporelle** : √âvolution des inscriptions, Saisonnalit√©
- **Qualit√© des donn√©es** : Compl√©tude des fiches, Doublons d√©tect√©s

**Rapports interactifs :**
- **Tableaux de bord** personnalisables avec widgets drag & drop
- **Filtres dynamiques** : P√©riode, Type, Source, Statut, R√©gion
- **Drill-down** : Navigation des vues globales vers le d√©tail
- **Comparaisons** : P√©riodes, Segments, √âquipes commerciales
- **Alertes automatiques** : Seuils personnalisables avec notifications

**Visualisations :**
- **Graphiques temporels** : √âvolution des inscriptions, Activit√©
- **Graphiques sectoriels** : R√©partition par type, source, r√©gion
- **Cartes g√©ographiques** : Densit√© clients par zone
- **Heatmaps** : Activit√© par jour/heure, Saisonnalit√©
- **Funnels** : Conversion leads vers clients

Utiliser Recharts ou Chart.js pour les visualisations.

‚öôÔ∏è **Interactions :** 
- Requ√™tes optimis√©es sur les tables clients avec agr√©gations
- Int√©gration avec Module Leads pour m√©triques de conversion
- Donn√©es temps r√©el via Supabase Realtime
- Export vers Dashboard principal pour supervision globale

üí° **Tips Windsurf :** Utilise des vues mat√©rialis√©es pour les calculs complexes. Impl√©mente le cache pour les m√©triques fr√©quentes. Optimise les requ√™tes avec des index appropri√©s.

---

### 17 - Int√©gration Client-Portal

üéØ **But :** D√©velopper l'int√©gration compl√®te avec le Client-Portal pour la synchronisation bidirectionnelle des donn√©es et la gestion des acc√®s clients.

üß† **Contexte technique :** L'int√©gration utilise Supabase Realtime pour la synchronisation temps r√©el et des API d√©di√©es pour les modifications. Le syst√®me g√®re les conflits de donn√©es et les permissions granulaires.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/components/PortalIntegration.tsx` avec :

**Gestion des acc√®s :**
- **Activation/d√©sactivation** de l'acc√®s Client-Portal par client
- **G√©n√©ration automatique** des credentials avec envoi s√©curis√©
- **Gestion des permissions** : Lecture seule, √âdition limit√©e, Acc√®s complet
- **R√©initialisation** des mots de passe avec liens temporaires
- **Audit des connexions** avec logs d√©taill√©s

**Synchronisation des donn√©es :**
- **Modifications temps r√©el** : Notification des changements c√¥t√© client
- **Gestion des conflits** : Interface de r√©solution avec historique
- **Validation des modifications** : Workflow d'approbation pour changements sensibles
- **Rollback automatique** en cas d'erreur de synchronisation
- **Queue de synchronisation** pour les modifications hors ligne

**Interface de supervision :**
- **Statut de synchronisation** par client avec indicateurs visuels
- **Modifications en attente** avec interface d'approbation/rejet
- **Historique des synchronisations** avec d√©tails des erreurs
- **M√©triques d'utilisation** du portal par client
- **Configuration des notifications** pour les √©quipes

‚öôÔ∏è **Interactions :** 
- Utilise Supabase Realtime pour synchronisation temps r√©el
- Int√©gration avec auth.users pour gestion des comptes
- Appelle les fonctions RPC pour validation des modifications
- Coordination avec Console Admin pour permissions et audit

üí° **Tips Windsurf :** Impl√©mente des queues pour la synchronisation asynchrone. Utilise des websockets pour les notifications temps r√©el. G√®re les timeouts et reconnexions automatiques.

---

### 18 - Gestion des consentements RGPD

üéØ **But :** Impl√©menter un syst√®me complet de gestion des consentements RGPD avec tra√ßabilit√©, r√©vocation et conformit√© r√©glementaire.

üß† **Contexte technique :** Le syst√®me enregistre tous les consentements avec horodatage pr√©cis et source. Il g√®re les diff√©rents types de consentements (traitement, marketing, partage) avec possibilit√© de r√©vocation granulaire.

üõ†Ô∏è **Type de fichier :** `.tsx` (React component)

üîÑ **Comportement attendu :**
Cr√©er `apps/backoffice/src/features/clients/components/GDPRConsents.tsx` avec :

**Types de consentements :**
- **Traitement des donn√©es** : Obligatoire pour la cr√©ation du compte
- **Communications marketing** : Optionnel avec granularit√© (email, SMS, courrier)
- **Partage avec partenaires** : Optionnel avec liste des partenaires
- **Cookies et tracking** : Granulaire par cat√©gorie de cookies
- **Conservation des donn√©es** : Dur√©e et conditions de conservation

**Interface de gestion :**
- **Statut visuel** des consentements avec codes couleur
- **Historique complet** : Dates, sources, modifications, r√©vocations
- **Formulaires de consentement** int√©gr√©s avec validation l√©gale
- **R√©vocation facilit√©e** avec confirmation et effet imm√©diat
- **Export des preuves** pour audits et contr√¥les r√©glementaires

**Conformit√© r√©glementaire :**
- **Textes l√©gaux** configurables par organisation et juridiction
- **Preuves horodat√©es** avec signature num√©rique
- **Alertes d'expiration** pour les consentements temporaires
- **Rapports de conformit√©** avec m√©triques d√©taill√©es
- **Int√©gration DPO** : Notifications pour les demandes de suppression

‚öôÔ∏è **Interactions :** 
- Stockage s√©curis√© dans `consent_details` JSONB avec audit
- Int√©gration avec Client-Portal pour gestion autonome
- Synchronisation avec outils marketing pour respect des pr√©f√©rences
- Reporting vers Console Admin pour supervision l√©gale

üí° **Tips Windsurf :** Utilise des signatures cryptographiques pour l'int√©grit√©. Impl√©mente l'immutabilit√© des enregistrements de consentement. Automatise les rappels de renouvellement.

---

## üöÄ Section 4 : √âvolutions Futures


### 19 - Intelligence artificielle pour recommandations clients

üéØ **But :** Int√©grer des capacit√©s d'IA pour fournir des recommandations intelligentes sur la gestion client et l'optimisation des processus.

üß† **Contexte technique :** Le syst√®me utilise l'apprentissage automatique pour analyser les patterns de comportement client et sugg√©rer des actions optimales. L'IA s'appuie sur l'historique des interactions et les donn√©es des autres modules.

üõ†Ô∏è **Type de fichier :** `.tsx` + `.py` (Edge Functions)

üîÑ **Comportement attendu :**
D√©velopper un syst√®me d'IA avec :

**Recommandations personnalis√©es :**
- **Pr√©diction de churn** : Identification des clients √† risque de d√©part
- **Opportunit√©s d'upselling** : Suggestions de services additionnels
- **Timing optimal** : Meilleurs moments pour contacter chaque client
- **Personnalisation** : Adaptation des communications selon le profil
- **Scoring de satisfaction** : Pr√©diction du niveau de satisfaction

**Automatisation intelligente :**
- **Cat√©gorisation automatique** des nouveaux clients
- **D√©tection d'anomalies** dans les comportements clients
- **Suggestions de champs personnalis√©s** bas√©es sur les patterns
- **Optimisation des workflows** selon l'efficacit√© mesur√©e
- **Pr√©diction de conversion** pour les leads entrants

**Interface utilisateur :**
- **Dashboard IA** avec insights et recommandations
- **Alertes proactives** pour actions recommand√©es
- **Explications** des recommandations avec facteurs d'influence
- **Feedback loop** pour am√©liorer les pr√©dictions
- **Configuration** des seuils et param√®tres IA

‚öôÔ∏è **Interactions :** 
- Int√©gration avec Console IA pour les mod√®les d'apprentissage
- Utilise les donn√©es de tous les modules pour l'entra√Ænement
- API externes pour enrichissement des donn√©es
- Supabase Edge Functions pour les calculs IA

üí° **Tips Windsurf :** Utilise des mod√®les pr√©-entra√Æn√©s pour d√©marrer rapidement. Impl√©mente l'apprentissage incr√©mental. Assure la transparence des d√©cisions IA.

---

### 20 - Int√©gration CRM externe

üéØ **But :** D√©velopper des connecteurs pour synchroniser les donn√©es clients avec les CRM externes populaires (Salesforce, HubSpot, Pipedrive).

üß† **Contexte technique :** Le syst√®me utilise des APIs REST et webhooks pour la synchronisation bidirectionnelle. Les mappings de champs sont configurables et les conflits sont g√©r√©s automatiquement.

üõ†Ô∏è **Type de fichier :** `.ts` (Services d'int√©gration)

üîÑ **Comportement attendu :**
Cr√©er des connecteurs pour :

**CRM support√©s :**
- **Salesforce** : Synchronisation compl√®te avec objets personnalis√©s
- **HubSpot** : Int√©gration contacts et deals avec propri√©t√©s custom
- **Pipedrive** : Sync personnes et organisations avec champs additionnels
- **Zoho CRM** : Mapping flexible avec modules personnalis√©s
- **API g√©n√©rique** : Connecteur configurable pour autres CRM

**Fonctionnalit√©s de synchronisation :**
- **Mapping intelligent** des champs avec suggestions automatiques
- **Synchronisation bidirectionnelle** avec r√©solution de conflits
- **Sync incr√©mentale** pour optimiser les performances
- **Webhooks** pour synchronisation temps r√©el
- **Queue de retry** pour g√©rer les erreurs temporaires

**Interface de configuration :**
- **Assistant de configuration** step-by-step pour chaque CRM
- **Test de connexion** avec validation des credentials
- **Mapping visuel** des champs avec pr√©visualisation
- **Planification** des synchronisations avec monitoring
- **Logs d√©taill√©s** des synchronisations avec gestion d'erreurs

‚öôÔ∏è **Interactions :** 
- Utilise les fonctions RPC pour validation et insertion
- Int√©gration avec Console Admin pour configuration et monitoring
- Coordination avec Module Leads pour synchronisation compl√®te
- Audit complet des synchronisations

üí° **Tips Windsurf :** Impl√©mente des rate limits pour respecter les quotas API. Utilise des queues pour les synchronisations en lot. G√®re les diff√©rences de timezone entre syst√®mes.

---

### 21 - Application mobile d√©di√©e

üéØ **But :** D√©velopper une application mobile native pour la gestion clients en mobilit√© avec fonctionnalit√©s offline et synchronisation.

üß† **Contexte technique :** L'application utilise React Native avec Expo pour le d√©veloppement cross-platform. Elle inclut la synchronisation offline avec SQLite local et sync automatique lors de la reconnexion.

üõ†Ô∏è **Type de fichier :** `.tsx` (React Native)

üîÑ **Comportement attendu :**
D√©velopper une app mobile avec :

**Fonctionnalit√©s core :**
- **Liste clients** optimis√©e pour mobile avec recherche rapide
- **Fiches clients** compl√®tes avec navigation intuitive
- **Ajout d'interactions** rapide avec templates pr√©d√©finis
- **Prise de photos** pour documents avec upload automatique
- **G√©olocalisation** pour visites clients avec tracking

**Fonctionnalit√©s offline :**
- **Cache intelligent** des clients fr√©quemment consult√©s
- **Synchronisation diff√©r√©e** des modifications offline
- **R√©solution de conflits** automatique avec interface de choix
- **Indicateurs visuels** du statut de synchronisation
- **Mode d√©grad√©** avec fonctionnalit√©s essentielles

**Optimisations mobiles :**
- **Interface tactile** optimis√©e avec gestes intuitifs
- **Performance** : Lazy loading et virtualisation
- **Notifications push** pour rappels et alertes importantes
- **Int√©gration native** : Contacts, Calendrier, T√©l√©phone
- **S√©curit√© renforc√©e** : Biom√©trie, chiffrement local

‚öôÔ∏è **Interactions :** 
- API d√©di√©e avec endpoints optimis√©s pour mobile
- Synchronisation avec Supabase via API REST
- Push notifications via services natifs
- Int√©gration avec calendriers et contacts du device

üí° **Tips Windsurf :** Utilise Expo pour simplifier le d√©veloppement. Impl√©mente la synchronisation en arri√®re-plan. Optimise la consommation de batterie.

---

### 22 - Blockchain pour tra√ßabilit√©

üéØ **But :** Impl√©menter une solution blockchain pour assurer la tra√ßabilit√© immuable des donn√©es clients et des consentements RGPD.

üß† **Contexte technique :** Le syst√®me utilise une blockchain priv√©e ou consortium pour enregistrer les hash des modifications importantes. Cela garantit l'int√©grit√© des donn√©es sans exposer les informations sensibles.

üõ†Ô∏è **Type de fichier :** `.ts` (Smart contracts et services)

üîÑ **Comportement attendu :**
D√©velopper une solution blockchain avec :

**Architecture blockchain :**
- **Blockchain priv√©e** ou consortium pour contr√¥le des acc√®s
- **Smart contracts** pour validation automatique des transactions
- **Hash des donn√©es** sensibles sans exposition du contenu
- **Consensus** entre n≈ìuds pour validation des modifications
- **Immutabilit√©** garantie pour l'audit et la conformit√©

**Cas d'usage prioritaires :**
- **Consentements RGPD** : Preuve immuable des consentements
- **Modifications sensibles** : Audit trail inalt√©rable
- **Transferts de donn√©es** : Tra√ßabilit√© des partages
- **Certifications** : Validation de l'authenticit√© des documents
- **Compliance** : Preuves pour audits r√©glementaires

**Interface utilisateur :**
- **Visualisation** de la cha√Æne de tra√ßabilit√©
- **V√©rification** de l'int√©grit√© des donn√©es
- **Certificats** de conformit√© g√©n√©r√©s automatiquement
- **Alertes** en cas de tentative de modification non autoris√©e
- **Rapports** de conformit√© avec preuves blockchain

‚öôÔ∏è **Interactions :** 
- Int√©gration avec les triggers de base de donn√©es
- API pour v√©rification d'int√©grit√©
- Services de hachage cryptographique
- Interface avec autorit√©s de certification

üí° **Tips Windsurf :** Commence par une blockchain de test. Utilise des hash pour pr√©server la confidentialit√©. Impl√©mente des m√©canismes de backup pour la r√©silience.

---

### 23 - Int√©gration IoT pour √©v√©nements

üéØ **But :** D√©velopper l'int√©gration avec des dispositifs IoT pour enrichir automatiquement les donn√©es clients lors des √©v√©nements.

üß† **Contexte technique :** Le syst√®me collecte des donn√©es depuis des capteurs IoT (pr√©sence, temp√©rature, son) lors des √©v√©nements pour analyser la satisfaction client et optimiser les services.

üõ†Ô∏è **Type de fichier :** `.ts` (Services IoT)

üîÑ **Comportement attendu :**
Cr√©er un syst√®me IoT avec :

**Capteurs support√©s :**
- **Capteurs de pr√©sence** : Comptage et flux des invit√©s
- **Capteurs environnementaux** : Temp√©rature, humidit√©, qualit√© air
- **Capteurs audio** : Niveau sonore et ambiance musicale
- **Capteurs visuels** : Analyse des expressions et engagement
- **Beacons Bluetooth** : Tracking des d√©placements et interactions

**Collecte et analyse :**
- **Agr√©gation temps r√©el** des donn√©es multi-capteurs
- **Corr√©lation** avec les √©v√©nements clients en cours
- **D√©tection d'anomalies** et alertes automatiques
- **Analytics pr√©dictifs** pour optimisation des futurs √©v√©nements
- **Rapports automatis√©s** de satisfaction bas√©s sur les m√©triques

**Interface de monitoring :**
- **Dashboard temps r√©el** des m√©triques IoT par √©v√©nement
- **Alertes proactives** pour intervention rapide
- **Historique** des m√©triques avec corr√©lation satisfaction
- **Configuration** des seuils et param√®tres par type d'√©v√©nement
- **Int√©gration** avec les fiches clients pour enrichissement

‚öôÔ∏è **Interactions :** 
- Int√©gration avec Module √âv√©nements pour corr√©lation
- Enrichissement automatique des fiches clients
- API pour dispositifs IoT tiers
- Analytics pour optimisation des services

üí° **Tips Windsurf :** Utilise des protocoles IoT standards (MQTT, CoAP). Impl√©mente la gestion des pannes de capteurs. Assure la s√©curit√© des communications IoT.

---

### 24 - R√©alit√© augment√©e pour visualisation

üéØ **But :** D√©velopper des fonctionnalit√©s de r√©alit√© augment√©e pour enrichir l'exp√©rience client et am√©liorer la pr√©sentation des services.

üß† **Contexte technique :** Le syst√®me utilise WebXR et des frameworks AR pour cr√©er des exp√©riences immersives accessibles depuis navigateur et applications mobiles.

üõ†Ô∏è **Type de fichier :** `.tsx` + `.js` (WebXR)

üîÑ **Comportement attendu :**
Cr√©er des exp√©riences AR avec :

**Cas d'usage clients :**
- **Visualisation 3D** des lieux de r√©ception avec personnalisation
- **Essayage virtuel** de d√©corations et am√©nagements
- **Pr√©sentation immersive** des services avec mod√®les 3D
- **Visite virtuelle** des lieux avec annotations interactives
- **Simulation** des √©v√©nements avec diff√©rentes configurations

**Fonctionnalit√©s techniques :**
- **Reconnaissance d'objets** pour ancrage AR pr√©cis
- **Tracking spatial** pour stabilit√© des √©l√©ments virtuels
- **Interaction gestuelle** pour manipulation des objets 3D
- **Partage d'exp√©rience** multi-utilisateurs en temps r√©el
- **Capture et sauvegarde** des configurations personnalis√©es

**Interface utilisateur :**
- **Launcher AR** int√©gr√© aux fiches clients
- **Biblioth√®que d'assets** 3D organis√©e par cat√©gories
- **√âditeur visuel** pour cr√©ation de sc√®nes personnalis√©es
- **Galerie** des exp√©riences sauvegard√©es par client
- **Analytics** d'engagement et pr√©f√©rences AR

‚öôÔ∏è **Interactions :** 
- Int√©gration avec Module Lieux pour mod√®les 3D
- Enrichissement des fiches clients avec pr√©f√©rences AR
- Stockage des assets 3D dans Supabase Storage
- Analytics d'utilisation pour optimisation

üí° **Tips Windsurf :** Commence par WebXR pour compatibilit√© cross-platform. Optimise les mod√®les 3D pour performance mobile. Impl√©mente des fallbacks pour devices non-AR.

---

## üìä Matrice de Priorit√©s et Recommandations d'Ex√©cution

### **Phase 1 - Infrastructure Critique (Semaines 1-2)**
**Prompts 01-06** : Fondations base de donn√©es et API
- Priorit√© P0 : Cr√©ation sch√©ma, types, index, RLS, RPC, triggers
- D√©pendances : Console Admin, Module Leads
- Validation : Tests unitaires des fonctions RPC

### **Phase 2 - Interfaces Principales (Semaines 3-5)**
**Prompts 07-12** : Interfaces utilisateur core
- Priorit√© P1 : Liste clients, formulaire, d√©tails, documents, interactions, conversion
- D√©pendances : Packages shared-ui, api-client
- Validation : Tests d'int√©gration et UX

### **Phase 3 - Fonctionnalit√©s Avanc√©es (Semaines 6-8)**
**Prompts 13-18** : Fonctionnalit√©s secondaires
- Priorit√© P2 : Champs personnalis√©s, doublons, import/export, analytics, portal, RGPD
- D√©pendances : Client-Portal, Console IA
- Validation : Tests de performance et s√©curit√©

### **Phase 4 - √âvolutions Futures (Versions ult√©rieures)**
**Prompts 19-24** : Innovations technologiques
- Priorit√© P3 : IA, CRM, mobile, blockchain, IoT, AR
- D√©pendances : Technologies √©mergentes, budget R&D
- Validation : POC et validation march√©

---

## üéØ Recommandations Finales

### **Criticit√© du Module**
Le module Clients est **P0 CRITIQUE** - il constitue le c≈ìur de la gestion client et alimente tous les autres modules m√©tier. Sa r√©ussite conditionne l'efficacit√© globale de l'ERP.

### **Int√©grations Prioritaires**
1. **Module Leads** : Conversion automatis√©e essentielle
2. **Console Admin** : S√©curit√© et permissions critiques  
3. **Client-Portal** : Synchronisation bidirectionnelle strat√©gique
4. **Module √âv√©nements** : Liaison m√©tier fondamentale

### **Points de Vigilance**
- **Complexit√© des donn√©es** : 8 tables interconnect√©es n√©cessitent une coordination pr√©cise
- **Performance** : Optimisation requise pour recherches et jointures complexes
- **S√©curit√© RGPD** : Conformit√© r√©glementaire stricte obligatoire
- **Synchronisation** : Gestion des conflits Client-Portal critique

### **Facteurs de Succ√®s**
- **Formation utilisateur** : Interface complexe n√©cessitant accompagnement
- **Migration donn√©es** : Planification soigneuse depuis syst√®mes existants
- **Tests de charge** : Validation avec volumes r√©alistes
- **Monitoring continu** : Surveillance performance et adoption

---

*Ce module Clients constitue le c≈ìur m√©tier de l'ERP Wedding Collection. Son impl√©mentation r√©ussie garantira une gestion client optimale et une base solide pour tous les modules connexes.*

